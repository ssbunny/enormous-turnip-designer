/*!
 * Brick SpreadSheet
 * A JavaScript spreedsheet designer based on Handsontable.
 * 
 * @version v0.3.0
 * @author zhangqiang
 * @license MIT
 * 
 * Build on: "2017-02-22T01:29:17.398Z"
 * -  handsontable version: 0.28.3
 * -     formulajs version: 1.0.8
 * -        moment version: 2.13.0
 * -        numbro version: 1.8.0
 * -       pikaday version: 1.4.0
 * - zeroclipboard version: 2.2.0
 */
!function e(r,t,n){function i(o,u){if(!t[o]){if(!r[o]){var s="function"==typeof require&&require;if(!u&&s)return s(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=t[o]={exports:{}};r[o][0].call(c.exports,function(e){var t=r[o][1][e];return i(t?t:e)},c,c.exports,e,r,t,n)}return t[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(require,module,exports){!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("numeric"),require("numeral"),require("jStat")):"function"==typeof define&&define.amd?define(["numeric","numeral","jStat"],r):"object"==typeof exports?exports.formulajs=r(require("numeric"),require("numeral"),require("jStat")):e.formulajs=r(e.numeric,e.numeral,e.jStat)}(this,function(__WEBPACK_EXTERNAL_MODULE_3__,__WEBPACK_EXTERNAL_MODULE_8__,__WEBPACK_EXTERNAL_MODULE_9__){return function(e){function r(n){if(t[n])return t[n].exports;var module=t[n]={exports:{},id:n,loaded:!1};return e[n].call(module.exports,module,module.exports,r),module.loaded=!0,module.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(module,exports,e){var r=[e(1),e(15),e(12),e(16),e(2),e(7),e(14),e(17),e(11),e(18),e(6),e(10)];for(var t in r){var n=r[t];for(var i in n)exports[i]=exports[i]||n[i]}},function(module,exports,e){function r(e,r){if(r)for(var t in r)e[t]=r[t];return e}var t=e(2),n=e(6),i=e(12),a=e(14);exports.BETADIST=n.BETA.DIST,exports.BETAINV=n.BETA.INV,exports.BINOMDIST=n.BINOM.DIST,exports.CEILING=exports.ISOCEILING=r(t.CEILING.MATH,t.CEILING),exports.CEILINGMATH=t.CEILING.MATH,exports.CEILINGPRECISE=t.CEILING.PRECISE,exports.CHIDIST=n.CHISQ.DIST,exports.CHIDISTRT=n.CHISQ.DIST.RT,exports.CHIINV=n.CHISQ.INV,exports.CHIINVRT=n.CHISQ.INV.RT,exports.CHITEST=n.CHISQ.TEST,exports.CONFIDENCE=r(n.CONFIDENCE.NORM,n.CONFIDENCE),exports.COVAR=n.COVARIANCE.P,exports.COVARIANCEP=n.COVARIANCE.P,exports.COVARIANCES=n.COVARIANCE.S,exports.CRITBINOM=n.BINOM.INV,exports.EXPONDIST=n.EXPON.DIST,exports.ERFCPRECISE=i.ERFC.PRECISE,exports.ERFPRECISE=i.ERF.PRECISE,exports.FDIST=n.F.DIST,exports.FDISTRT=n.F.DIST.RT,exports.FINVRT=n.F.INV.RT,exports.FINV=n.F.INV,exports.FLOOR=r(t.FLOOR.MATH,t.FLOOR),exports.FLOORMATH=t.FLOOR.MATH,exports.FLOORPRECISE=t.FLOOR.PRECISE,exports.FTEST=n.F.TEST,exports.GAMMADIST=n.GAMMA.DIST,exports.GAMMAINV=n.GAMMA.INV,exports.GAMMALNPRECISE=n.GAMMALN.PRECISE,exports.HYPGEOMDIST=n.HYPGEOM.DIST,exports.LOGINV=n.LOGNORM.INV,exports.LOGNORMINV=n.LOGNORM.INV,exports.LOGNORMDIST=n.LOGNORM.DIST,exports.MODE=r(n.MODE.SNGL,n.MODE),exports.MODEMULT=n.MODE.MULT,exports.MODESNGL=n.MODE.SNGL,exports.NEGBINOMDIST=n.NEGBINOM.DIST,exports.NETWORKDAYSINTL=a.NETWORKDAYS.INTL,exports.NORMDIST=n.NORM.DIST,exports.NORMINV=n.NORM.INV,exports.NORMSDIST=n.NORM.S.DIST,exports.NORMSINV=n.NORM.S.INV,exports.PERCENTILE=r(n.PERCENTILE.EXC,n.PERCENTILE),exports.PERCENTILEEXC=n.PERCENTILE.EXC,exports.PERCENTILEINC=n.PERCENTILE.INC,exports.PERCENTRANK=r(n.PERCENTRANK.INC,n.PERCENTRANK),exports.PERCENTRANKEXC=n.PERCENTRANK.EXC,exports.PERCENTRANKINC=n.PERCENTRANK.INC,exports.POISSON=r(n.POISSON.DIST,n.POISSON),exports.POISSONDIST=n.POISSON.DIST,exports.QUARTILE=r(n.QUARTILE.INC,n.QUARTILE),exports.QUARTILEEXC=n.QUARTILE.EXC,exports.QUARTILEINC=n.QUARTILE.INC,exports.RANK=r(n.RANK.EQ,n.RANK),exports.RANKAVG=n.RANK.AVG,exports.RANKEQ=n.RANK.EQ,exports.SKEWP=n.SKEW.P,exports.STDEV=r(n.STDEV.S,n.STDEV),exports.STDEVP=n.STDEV.P,exports.STDEVS=n.STDEV.S,exports.TDIST=n.T.DIST,exports.TDISTRT=n.T.DIST.RT,exports.TINV=n.T.INV,exports.TTEST=n.T.TEST,exports.VAR=r(n.VAR.S,n.VAR),exports.VARP=n.VAR.P,exports.VARS=n.VAR.S,exports.WEIBULL=r(n.WEIBULL.DIST,n.WEIBULL),exports.WEIBULLDIST=n.WEIBULL.DIST,exports.WORKDAYINTL=a.WORKDAY.INTL,exports.ZTEST=n.Z.TEST},function(module,exports,__webpack_require__){var numeric=__webpack_require__(3),utils=__webpack_require__(4),error=__webpack_require__(5),statistical=__webpack_require__(6),information=__webpack_require__(11);exports.ABS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.abs(utils.parseNumber(e))},exports.ACOS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.acos(e)},exports.ACOSH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e+Math.sqrt(e*e-1))},exports.ACOT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.atan(1/e)},exports.ACOTH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:.5*Math.log((e+1)/(e-1))},exports.AGGREGATE=function(e,r,t,n){if(e=utils.parseNumber(e),r=utils.parseNumber(e),utils.anyIsError(e,r))return error.value;switch(e){case 1:return statistical.AVERAGE(t);case 2:return statistical.COUNT(t);case 3:return statistical.COUNTA(t);case 4:return statistical.MAX(t);case 5:return statistical.MIN(t);case 6:return exports.PRODUCT(t);case 7:return statistical.STDEV.S(t);case 8:return statistical.STDEV.P(t);case 9:return exports.SUM(t);case 10:return statistical.VAR.S(t);case 11:return statistical.VAR.P(t);case 12:return statistical.MEDIAN(t);case 13:return statistical.MODE.SNGL(t);case 14:return statistical.LARGE(t,n);case 15:return statistical.SMALL(t,n);case 16:return statistical.PERCENTILE.INC(t,n);case 17:return statistical.QUARTILE.INC(t,n);case 18:return statistical.PERCENTILE.EXC(t,n);case 19:return statistical.QUARTILE.EXC(t,n)}},exports.ARABIC=function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return error.value;var r=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(e){r+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]}),r},exports.ASIN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.asin(e)},exports.ASINH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},exports.ATAN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.atan(e)},exports.ATAN2=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:Math.atan2(e,r)},exports.ATANH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log((1+e)/(1-e))/2},exports.BASE=function(e,r,t){if(t=t||0,e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t))return error.value;t=void 0===t?0:t;var n=e.toString(r);return new Array(Math.max(t+1-n.length,0)).join("0")+n},exports.CEILING=function(e,r,t){if(r=void 0===r?1:Math.abs(r),t=t||0,e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t))return error.value;if(0===r)return 0;var n=-Math.floor(Math.log(r)/Math.log(10));return e>=0?exports.ROUND(Math.ceil(e/r)*r,n):0===t?-exports.ROUND(Math.floor(Math.abs(e)/r)*r,n):-exports.ROUND(Math.ceil(Math.abs(e)/r)*r,n)},exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:exports.FACT(e)/(exports.FACT(r)*exports.FACT(e-r))},exports.COMBINA=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:0===e&&0===r?1:exports.COMBIN(e+r-1,e-1)},exports.COS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.cos(e)},exports.COSH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},exports.COT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.tan(e)},exports.COTH=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var r=Math.exp(2*e);return(r+1)/(r-1)},exports.CSC=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.sin(e)},exports.CSCH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},exports.DECIMAL=function(e,r){return arguments.length<1?error.value:parseInt(e,r)},exports.DEGREES=function(e){return e=utils.parseNumber(e),e instanceof Error?e:180*e/Math.PI},exports.EVEN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:exports.CEILING(e,-2,-1)},exports.EXP=Math.exp;var MEMOIZED_FACT=[];exports.FACT=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var r=Math.floor(e);return 0===r||1===r?1:MEMOIZED_FACT[r]>0?MEMOIZED_FACT[r]:(MEMOIZED_FACT[r]=exports.FACT(r-1)*r,MEMOIZED_FACT[r])},exports.FACTDOUBLE=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var r=Math.floor(e);return r<=0?1:r*exports.FACTDOUBLE(r-2)},exports.FLOOR=function(e,r){if(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r))return error.value;if(0===r)return 0;if(!(e>0&&r>0||e<0&&r<0))return error.num;r=Math.abs(r);var t=-Math.floor(Math.log(r)/Math.log(10));return e>=0?exports.ROUND(Math.floor(e/r)*r,t):-exports.ROUND(Math.ceil(Math.abs(e)/r),t)},exports.FLOOR.MATH=function(e,r,t){if(r=void 0===r?1:r,t=void 0===t?0:t,e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t))return error.value;if(0===r)return 0;r=r?Math.abs(r):1;var n=-Math.floor(Math.log(r)/Math.log(10));return e>=0?exports.ROUND(Math.floor(e/r)*r,n):0===t||void 0===t?-exports.ROUND(Math.ceil(Math.abs(e)/r)*r,n):-exports.ROUND(Math.floor(Math.abs(e)/r)*r,n)},exports.FLOOR.PRECISE=exports.FLOOR.MATH,exports.GCD=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var r=e.length,t=e[0],n=t<0?-t:t,i=1;i<r;i++){for(var a=e[i],o=a<0?-a:a;n&&o;)n>o?n%=o:o%=n;n+=o}return n},exports.INT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.floor(e)},exports.ISO={CEILING:exports.CEILING},exports.LCM=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var r,t,n,i,a=1;void 0!==(n=e.pop());)for(;n>1;){if(n%2){for(r=3,t=Math.floor(Math.sqrt(n));r<=t&&n%r;r+=2);i=r<=t?r:n}else i=2;for(n/=i,a*=i,r=e.length;r;e[--r]%i===0&&1===(e[r]/=i)&&e.splice(r,1));}return a},exports.LN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e)},exports.LOG=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:(r=void 0===r?10:r,Math.log(e)/Math.log(r))},exports.LOG10=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e)/Math.log(10)},exports.MDETERM=function(e){return e=utils.parseMatrix(e),e instanceof Error?e:numeric.det(e)},exports.MINVERSE=function(e){return e=utils.parseMatrix(e),e instanceof Error?e:numeric.inv(e)},exports.MMULT=function(e,r){return e=utils.parseMatrix(e),r=utils.parseMatrix(r),utils.anyIsError(e,r)?error.value:numeric.dot(e,r)},exports.MOD=function(e,r){if(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r))return error.value;if(0===r)return error.div0;var t=Math.abs(e%r);return r>0?t:-t},exports.MROUND=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:e*r<0?error.num:Math.round(e/r)*r},exports.MULTINOMIAL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var r=0,t=1,n=0;n<e.length;n++)r+=e[n],t*=exports.FACT(e[n]);return exports.FACT(r)/t},exports.MUNIT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:numeric.identity(e)},exports.ODD=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var r=Math.ceil(Math.abs(e));return r=1&r?r:r+1,e>0?r:-r},exports.PI=function(){return Math.PI},exports.POWER=function(e,r){if(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r))return error.value;var t=Math.pow(e,r);return isNaN(t)?error.num:t},exports.PRODUCT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var r=1,t=0;t<e.length;t++)r*=e[t];return r},exports.QUOTIENT=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:parseInt(e/r,10)},exports.RADIANS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:e+Math.ceil((r-e+1)*Math.random())-1},exports.ROMAN=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;for(var r=String(e).split(""),t=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],n="",i=3;i--;)n=(t[+r.pop()+10*i]||"")+n;return new Array(+r.join("")+1).join("M")+n},exports.ROUND=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:Math.round(e*Math.pow(10,r))/Math.pow(10,r)},exports.ROUNDDOWN=function(e,r){if(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r))return error.value;var t=e>0?1:-1;return t*Math.floor(Math.abs(e)*Math.pow(10,r))/Math.pow(10,r)},exports.ROUNDUP=function(e,r){if(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r))return error.value;var t=e>0?1:-1;return t*Math.ceil(Math.abs(e)*Math.pow(10,r))/Math.pow(10,r)},exports.SEC=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.cos(e)},exports.SECH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},exports.SERIESSUM=function(e,r,t,n){if(e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),n=utils.parseNumberArray(n),utils.anyIsError(e,r,t,n))return error.value;for(var i=n[0]*Math.pow(e,r),a=1;a<n.length;a++)i+=n[a]*Math.pow(e,r+a*t);return i},exports.SIGN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e<0?-1:0===e?0:1},exports.SIN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.sin(e)},exports.SINH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},exports.SQRT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e<0?error.num:Math.sqrt(e)},exports.SQRTPI=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.sqrt(e*Math.PI)},exports.SUBTOTAL=function(e,r){if(e=utils.parseNumber(e),e instanceof Error)return e;switch(e){case 1:return statistical.AVERAGE(r);case 2:return statistical.COUNT(r);case 3:return statistical.COUNTA(r);case 4:return statistical.MAX(r);case 5:return statistical.MIN(r);case 6:return exports.PRODUCT(r);case 7:return statistical.STDEV.S(r);case 8:return statistical.STDEV.P(r);case 9:return exports.SUM(r);case 10:return statistical.VAR.S(r);case 11:return statistical.VAR.P(r);case 101:return statistical.AVERAGE(r);case 102:return statistical.COUNT(r);case 103:return statistical.COUNTA(r);case 104:return statistical.MAX(r);case 105:return statistical.MIN(r);case 106:return exports.PRODUCT(r);case 107:return statistical.STDEV.S(r);case 108:return statistical.STDEV.P(r);case 109:return exports.SUM(r);case 110:return statistical.VAR.S(r);case 111:return statistical.VAR.P(r)}},exports.ADD=function(e,r){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:e+r)},exports.MINUS=function(e,r){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:e-r)},exports.DIVIDE=function(e,r){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:0===r?error.div0:e/r)},exports.MULTIPLY=function(e,r){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:e*r)},exports.GTE=function(e,r){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.error:e>=r)},exports.LT=function(e,r){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.error:e<r)},exports.LTE=function(e,r){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.error:e<=r)},exports.EQ=function(e,r){return 2!==arguments.length?error.na:e===r},exports.NE=function(e,r){return 2!==arguments.length?error.na:e!==r},exports.POW=function(e,r){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.error:exports.POWER(e,r))},exports.SUM=function(){for(var e=0,r=Object.keys(arguments),t=0;t<r.length;++t){var n=arguments[r[t]];if("number"==typeof n)e+=n;else if("string"==typeof n){var i=parseFloat(n);!isNaN(i)&&(e+=i)}else Array.isArray(n)&&(e+=exports.SUM.apply(null,n))}return e},exports.SUMIF=function(range,criteria){if(range=utils.parseNumberArray(utils.flatten(range)),range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;i<n_range_elements;i++){for(var el=range[i],condition="",c=0;c<n_criterias;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return error.value;for(var e,r,t,n,i=arguments.length+1,a=0,o=0;o<arguments[0].length;o++)if(arguments[0][o]instanceof Array)for(var u=0;u<arguments[0][o].length;u++){for(e=1,r=1;r<i;r++){if(n=utils.parseNumber(arguments[r-1][o][u]),n instanceof Error)return n;e*=n}a+=e}else{for(e=1,r=1;r<i;r++){if(t=utils.parseNumber(arguments[r-1][o]),t instanceof Error)return t;e*=t}a+=e}return a},exports.SUMSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var r=0,t=e.length,n=0;n<t;n++)r+=information.ISNUMBER(e[n])?e[n]*e[n]:0;return r},exports.SUMX2MY2=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;for(var t=0,n=0;n<e.length;n++)t+=e[n]*e[n]-r[n]*r[n];return t},exports.SUMX2PY2=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;var t=0;e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r));for(var n=0;n<e.length;n++)t+=e[n]*e[n]+r[n]*r[n];return t},exports.SUMXMY2=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;var t=0;e=utils.flatten(e),r=utils.flatten(r);for(var n=0;n<e.length;n++)t+=Math.pow(e[n]-r[n],2);return t},exports.TAN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.tan(e)},exports.TANH=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var r=Math.exp(2*e);return(r-1)/(r+1)},exports.TRUNC=function(e,r){if(r=void 0===r?0:r,e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r))return error.value;var t=e>0?1:-1;return t*Math.floor(Math.abs(e)*Math.pow(10,r))/Math.pow(10,r)}},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_3__},function(module,exports,e){function r(e){return e&&e.reduce?e.reduce(function(e,r){var t=Array.isArray(e),n=Array.isArray(r);return t&&n?e.concat(r):t?(e.push(r),e):n?[e].concat(r):[e,r]}):e}function t(e){if(!e)return!1;for(var r=0;r<e.length;++r)if(Array.isArray(e[r]))return!1;return!0}var n=e(5);exports.flatten=function(){for(var e=exports.argsToArray.apply(null,arguments);!t(e);)e=r(e);return e},exports.argsToArray=function(e){return Array.prototype.slice.call(e,0)},exports.numbers=function(){var e=this.flatten.apply(null,arguments);return e.filter(function(e){return"number"==typeof e})},exports.cleanFloat=function(e){var r=1e14;return Math.round(e*r)/r},exports.parseBool=function(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){var r=e.toUpperCase();if("TRUE"===r)return!0;if("FALSE"===r)return!1}return e instanceof Date&&!isNaN(e)||n.value},exports.parseNumber=function(e){return void 0===e||""===e?n.value:isNaN(e)?n.value:parseFloat(e)},exports.parseNumberArray=function(e){var r;if(!e||0===(r=e.length))return n.value;for(var t;r--;){if(t=exports.parseNumber(e[r]),t===n.value)return t;e[r]=t}return e},exports.parseMatrix=function(e){var r;if(!e||0===(r=e.length))return n.value;for(var t,i=0;i<e.length;i++)if(t=exports.parseNumberArray(e[i]),e[i]=t,t instanceof Error)return t;return e};var i=new Date(1900,0,1);exports.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);var r=parseInt(e,10);return r<0?n.num:r<=60?new Date(i.getTime()+864e5*(r-1)):new Date(i.getTime()+864e5*(r-2))}return"string"!=typeof e||(e=new Date(e),isNaN(e))?n.value:e},exports.parseDateArray=function(e){for(var r,t=e.length;t--;){if(r=this.parseDate(e[t]),r===n.value)return r;e[t]=r}return e},exports.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1},exports.arrayValuesToNumbers=function(e){for(var r,t=e.length;t--;)if(r=e[t],"number"!=typeof r)if(r!==!0)if(r!==!1){if("string"==typeof r){var n=this.parseNumber(r);n instanceof Error?e[t]=0:e[t]=n}}else e[t]=0;else e[t]=1;return e},exports.rest=function(e,r){return r=r||1,e&&"function"==typeof e.slice?e.slice(r):e},exports.initial=function(e,r){return r=r||1,e&&"function"==typeof e.slice?e.slice(0,e.length-r):e}},function(module,exports){exports.nil=new Error("#NULL!"),exports.div0=new Error("#DIV/0!"),exports.value=new Error("#VALUE?"),exports.ref=new Error("#REF!"),exports.name=new Error("#NAME?"),exports.num=new Error("#NUM!"),exports.na=new Error("#N/A"),exports.error=new Error("#ERROR!"),exports.data=new Error("#GETTING_DATA")},function(module,exports,__webpack_require__){var mathTrig=__webpack_require__(2),text=__webpack_require__(7),jStat=__webpack_require__(9).jStat,utils=__webpack_require__(4),error=__webpack_require__(5),misc=__webpack_require__(10),SQRT2PI=2.5066282746310002;exports.AVEDEV=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:jStat.sum(jStat(e).subtract(jStat.mean(e)).abs()[0])/e.length},exports.AVERAGE=function(){for(var e=utils.numbers(utils.flatten(arguments)),r=e.length,t=0,n=0,i=0;i<r;i++)t+=e[i],n+=1;return t/n},exports.AVERAGEA=function(){for(var e=utils.flatten(arguments),r=e.length,t=0,n=0,i=0;i<r;i++){var a=e[i];"number"==typeof a&&(t+=a),a===!0&&t++,null!==a&&n++}return t/n},exports.AVERAGEIF=function(range,criteria,average_range){if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=function(){for(var args=utils.argsToArray(arguments),criteria=(args.length-1)/2,range=utils.flatten(args[0]),count=0,result=0,i=0;i<range.length;i++){for(var condition="",j=0;j<criteria;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}var average=result/count;return isNaN(average)?0:average},exports.BETA={},exports.BETA.DIST=function(e,r,t,n,i,a){return arguments.length<4?error.value:(i=void 0===i?0:i,a=void 0===a?1:a,e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),i=utils.parseNumber(i),a=utils.parseNumber(a),utils.anyIsError(e,r,t,i,a)?error.value:(e=(e-i)/(a-i),n?jStat.beta.cdf(e,r,t):jStat.beta.pdf(e,r,t)))},exports.BETA.INV=function(e,r,t,n,i){return n=void 0===n?0:n,i=void 0===i?1:i,e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),n=utils.parseNumber(n),i=utils.parseNumber(i),utils.anyIsError(e,r,t,n,i)?error.value:jStat.beta.inv(e,r,t)*(i-n)+n},exports.BINOM={},exports.BINOM.DIST=function(e,r,t,n){return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,r,t,n)?error.value:n?jStat.binomial.cdf(e,r,t):jStat.binomial.pdf(e,r,t)},exports.BINOM.DIST.RANGE=function(e,r,t,n){if(n=void 0===n?t:n,e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,r,t,n))return error.value;for(var i=0,a=t;a<=n;a++)i+=mathTrig.COMBIN(e,a)*Math.pow(r,a)*Math.pow(1-r,e-a);return i},exports.BINOM.INV=function(e,r,t){if(e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t))return error.value;for(var n=0;n<=e;){if(jStat.binomial.cdf(n,e,r)>=t)return n;n++}},exports.CHISQ={},exports.CHISQ.DIST=function(e,r,t){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:t?jStat.chisquare.cdf(e,r):jStat.chisquare.pdf(e,r)},exports.CHISQ.DIST.RT=function(e,r){return!e|!r?error.na:e<1||r>Math.pow(10,10)?error.num:"number"!=typeof e||"number"!=typeof r?error.value:1-jStat.chisquare.cdf(e,r)},exports.CHISQ.INV=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:jStat.chisquare.inv(e,r)},exports.CHISQ.INV.RT=function(e,r){return!e|!r?error.na:e<0||e>1||r<1||r>Math.pow(10,10)?error.num:"number"!=typeof e||"number"!=typeof r?error.value:jStat.chisquare.inv(1-e,r)},exports.CHISQ.TEST=function(e,r){function t(e,r){var t=Math.exp(-.5*e);r%2===1&&(t*=Math.sqrt(2*e/c));for(var n=r;n>=2;)t=t*e/n,n-=2;for(var i=t,a=r;i>1e-10*t;)a+=2,i=i*e/a,t+=i;return 1-t}if(2!==arguments.length)return error.na;if(!(e instanceof Array&&r instanceof Array))return error.value;if(e.length!==r.length)return error.value;if(e[0]&&r[0]&&e[0].length!==r[0].length)return error.value;var n,i,a,o=e.length;for(i=0;i<o;i++)e[i]instanceof Array||(n=e[i],e[i]=[],e[i].push(n)),r[i]instanceof Array||(n=r[i],r[i]=[],r[i].push(n));var u=e[0].length,s=1===u?o-1:(o-1)*(u-1),l=0,c=Math.PI;for(i=0;i<o;i++)for(a=0;a<u;a++)l+=Math.pow(e[i][a]-r[i][a],2)/r[i][a];return Math.round(1e6*t(l,s))/1e6},exports.COLUMN=function(e,r){if(2!==arguments.length)return error.na;if(r<0)return error.num;if(!(e instanceof Array)||"number"!=typeof r)return error.value;if(0!==e.length)return jStat.col(e,r)},exports.COLUMNS=function(e){return 1!==arguments.length?error.na:e instanceof Array?0===e.length?0:jStat.cols(e):error.value},exports.CONFIDENCE={},exports.CONFIDENCE.NORM=function(e,r,t){return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t)?error.value:jStat.normalci(1,e,r,t)[1]-1},exports.CONFIDENCE.T=function(e,r,t){return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t)?error.value:jStat.tci(1,e,r,t)[1]-1},exports.CORREL=function(e,r){return e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r)?error.value:jStat.corrcoeff(e,r)},exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var e=utils.flatten(arguments);return e.length-exports.COUNTBLANK(e)},exports.COUNTIN=function(e,r){for(var t=0,n=0;n<e.length;n++)e[n]===r&&t++;return t},exports.COUNTBLANK=function(){for(var e,r=utils.flatten(arguments),t=0,n=0;n<r.length;n++)e=r[n],null!==e&&""!==e||t++;return t},exports.COUNTIF=function(range,criteria){range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)"string"!=typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)"string"!=typeof range[j]?results[j]=results[j]&&eval(range[j]+criteria):results[j]=results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return misc.UNIQUE.apply(null,utils.flatten(arguments)).length},exports.COVARIANCE={},exports.COVARIANCE.P=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;for(var t=jStat.mean(e),n=jStat.mean(r),i=0,a=e.length,o=0;o<a;o++)i+=(e[o]-t)*(r[o]-n);return i/a},exports.COVARIANCE.S=function(e,r){return e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r)?error.value:jStat.covariance(e,r)},exports.DEVSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var r=jStat.mean(e),t=0,n=0;n<e.length;n++)t+=Math.pow(e[n]-r,2);return t},exports.EXPON={},exports.EXPON.DIST=function(e,r,t){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:t?jStat.exponential.cdf(e,r):jStat.exponential.pdf(e,r)},exports.F={},exports.F.DIST=function(e,r,t,n){return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t)?error.value:n?jStat.centralF.cdf(e,r,t):jStat.centralF.pdf(e,r,t)},exports.F.DIST.RT=function(e,r,t){return 3!==arguments.length?error.na:e<0||r<1||t<1?error.num:"number"!=typeof e||"number"!=typeof r||"number"!=typeof t?error.value:1-jStat.centralF.cdf(e,r,t)},exports.F.INV=function(e,r,t){return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t)?error.value:e<=0||e>1?error.num:jStat.centralF.inv(e,r,t)},exports.F.INV.RT=function(e,r,t){return 3!==arguments.length?error.na:e<0||e>1||r<1||r>Math.pow(10,10)||t<1||t>Math.pow(10,10)?error.num:"number"!=typeof e||"number"!=typeof r||"number"!=typeof t?error.value:jStat.centralF.inv(1-e,r,t)},exports.F.TEST=function(e,r){if(!e||!r)return error.na;if(!(e instanceof Array&&r instanceof Array))return error.na;if(e.length<2||r.length<2)return error.div0;var t=function(e,r){for(var t=0,n=0;n<e.length;n++)t+=Math.pow(e[n]-r,2);return t},n=mathTrig.SUM(e)/e.length,i=mathTrig.SUM(r)/r.length,a=t(e,n)/(e.length-1),o=t(r,i)/(r.length-1);return a/o},exports.FISHER=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log((1+e)/(1-e))/2},exports.FISHERINV=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var r=Math.exp(2*e);return(r-1)/(r+1)},exports.FORECAST=function(e,r,t){if(e=utils.parseNumber(e),r=utils.parseNumberArray(utils.flatten(r)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,r,t))return error.value;for(var n=jStat.mean(t),i=jStat.mean(r),a=t.length,o=0,u=0,s=0;s<a;s++)o+=(t[s]-n)*(r[s]-i),u+=Math.pow(t[s]-n,2);var l=o/u,c=i-l*n;return c+l*e},exports.FREQUENCY=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;for(var t=e.length,n=r.length,i=[],a=0;a<=n;a++){i[a]=0;for(var o=0;o<t;o++)0===a?e[o]<=r[0]&&(i[0]+=1):a<n?e[o]>r[a-1]&&e[o]<=r[a]&&(i[a]+=1):a===n&&e[o]>r[n-1]&&(i[n]+=1)}return i},exports.GAMMA=function(e){return e=utils.parseNumber(e),e instanceof Error?e:0===e?error.num:parseInt(e,10)===e&&e<0?error.num:jStat.gammafn(e)},exports.GAMMA.DIST=function(e,r,t,n){return 4!==arguments.length?error.na:e<0||r<=0||t<=0?error.value:"number"!=typeof e||"number"!=typeof r||"number"!=typeof t?error.value:n?jStat.gamma.cdf(e,r,t,!0):jStat.gamma.pdf(e,r,t,!1)},exports.GAMMA.INV=function(e,r,t){return 3!==arguments.length?error.na:e<0||e>1||r<=0||t<=0?error.num:"number"!=typeof e||"number"!=typeof r||"number"!=typeof t?error.value:jStat.gamma.inv(e,r,t)},exports.GAMMALN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:jStat.gammaln(e)},exports.GAMMALN.PRECISE=function(e){return 1!==arguments.length?error.na:e<=0?error.num:"number"!=typeof e?error.value:jStat.gammaln(e);
},exports.GAUSS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:jStat.normal.cdf(e,0,1)-.5},exports.GEOMEAN=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:jStat.geomean(e)},exports.GROWTH=function(e,r,t,n){if(e=utils.parseNumberArray(e),e instanceof Error)return e;var i;if(void 0===r)for(r=[],i=1;i<=e.length;i++)r.push(i);if(void 0===t)for(t=[],i=1;i<=e.length;i++)t.push(i);if(r=utils.parseNumberArray(r),t=utils.parseNumberArray(t),utils.anyIsError(r,t))return error.value;void 0===n&&(n=!0);var a=e.length,o=0,u=0,s=0,l=0;for(i=0;i<a;i++){var c=r[i],f=Math.log(e[i]);o+=c,u+=f,s+=c*f,l+=c*c}o/=a,u/=a,s/=a,l/=a;var h,p;n?(h=(s-o*u)/(l-o*o),p=u-h*o):(h=s/l,p=0);var m=[];for(i=0;i<t.length;i++)m.push(Math.exp(p+h*t[i]));return m},exports.HARMEAN=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var r=e.length,t=0,n=0;n<r;n++)t+=1/e[n];return r/t},exports.HYPGEOM={},exports.HYPGEOM.DIST=function(e,r,t,n,i){function a(e,r,t,n){return mathTrig.COMBIN(t,e)*mathTrig.COMBIN(n-t,r-e)/mathTrig.COMBIN(n,r)}function o(e,r,t,n){for(var i=0,o=0;o<=e;o++)i+=a(o,r,t,n);return i}return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,r,t,n)?error.value:i?o(e,r,t,n):a(e,r,t,n)},exports.INTERCEPT=function(e,r){return e=utils.parseNumberArray(e),r=utils.parseNumberArray(r),utils.anyIsError(e,r)?error.value:e.length!==r.length?error.na:exports.FORECAST(0,e,r)},exports.KURT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var r=jStat.mean(e),t=e.length,n=0,i=0;i<t;i++)n+=Math.pow(e[i]-r,4);return n/=Math.pow(jStat.stdev(e,!0),4),t*(t+1)/((t-1)*(t-2)*(t-3))*n-3*(t-1)*(t-1)/((t-2)*(t-3))},exports.LARGE=function(e,r){return e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumber(r),utils.anyIsError(e,r)?e:e.sort(function(e,r){return r-e})[r-1]},exports.LINEST=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;for(var t=jStat.mean(e),n=jStat.mean(r),i=r.length,a=0,o=0,u=0;u<i;u++)a+=(r[u]-n)*(e[u]-t),o+=Math.pow(r[u]-n,2);var s=a/o,l=t-s*n;return[s,l]},exports.LOGEST=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;for(var t=0;t<e.length;t++)e[t]=Math.log(e[t]);var n=exports.LINEST(e,r);return n[0]=Math.round(1e6*Math.exp(n[0]))/1e6,n[1]=Math.round(1e6*Math.exp(n[1]))/1e6,n},exports.LOGNORM={},exports.LOGNORM.DIST=function(e,r,t,n){return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t)?error.value:n?jStat.lognormal.cdf(e,r,t):jStat.lognormal.pdf(e,r,t)},exports.LOGNORM.INV=function(e,r,t){return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t)?error.value:jStat.lognormal.inv(e,r,t)},exports.MAX=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MAXA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MEDIAN=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return jStat.median(e)},exports.MIN=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MINA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MODE={},exports.MODE.MULT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var r,t=e.length,n={},i=[],a=0,o=0;o<t;o++)r=e[o],n[r]=n[r]?n[r]+1:1,n[r]>a&&(a=n[r],i=[]),n[r]===a&&(i[i.length]=r);return i},exports.MODE.SNGL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:exports.MODE.MULT(e).sort(function(e,r){return e-r})[0]},exports.NEGBINOM={},exports.NEGBINOM.DIST=function(e,r,t,n){return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t)?error.value:n?jStat.negbin.cdf(e,r,t):jStat.negbin.pdf(e,r,t)},exports.NORM={},exports.NORM.DIST=function(e,r,t,n){return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t)?error.value:t<=0?error.num:n?jStat.normal.cdf(e,r,t):jStat.normal.pdf(e,r,t)},exports.NORM.INV=function(e,r,t){return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t)?error.value:jStat.normal.inv(e,r,t)},exports.NORM.S={},exports.NORM.S.DIST=function(e,r){return e=utils.parseNumber(e),e instanceof Error?error.value:r?jStat.normal.cdf(e,0,1):jStat.normal.pdf(e,0,1)},exports.NORM.S.INV=function(e){return e=utils.parseNumber(e),e instanceof Error?error.value:jStat.normal.inv(e,0,1)},exports.PEARSON=function(e,r){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var t=jStat.mean(e),n=jStat.mean(r),i=e.length,a=0,o=0,u=0,s=0;s<i;s++)a+=(e[s]-t)*(r[s]-n),o+=Math.pow(e[s]-t,2),u+=Math.pow(r[s]-n,2);return a/Math.sqrt(o*u)},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumber(r),utils.anyIsError(e,r))return error.value;e=e.sort(function(e,r){return e-r});var t=e.length;if(r<1/(t+1)||r>1-1/(t+1))return error.num;var n=r*(t+1)-1,i=Math.floor(n);return utils.cleanFloat(n===i?e[n]:e[i]+(n-i)*(e[i+1]-e[i]))},exports.PERCENTILE.INC=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumber(r),utils.anyIsError(e,r))return error.value;e=e.sort(function(e,r){return e-r});var t=e.length,n=r*(t-1),i=Math.floor(n);return utils.cleanFloat(n===i?e[n]:e[i]+(n-i)*(e[i+1]-e[i]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(e,r,t){if(t=void 0===t?3:t,e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t))return error.value;e=e.sort(function(e,r){return e-r});for(var n=misc.UNIQUE.apply(null,e),i=e.length,a=n.length,o=Math.pow(10,t),u=0,s=!1,l=0;!s&&l<a;)r===n[l]?(u=(e.indexOf(n[l])+1)/(i+1),s=!0):r>=n[l]&&(r<n[l+1]||l===a-1)&&(u=(e.indexOf(n[l])+1+(r-n[l])/(n[l+1]-n[l]))/(i+1),s=!0),l++;return Math.floor(u*o)/o},exports.PERCENTRANK.INC=function(e,r,t){if(t=void 0===t?3:t,e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t))return error.value;e=e.sort(function(e,r){return e-r});for(var n=misc.UNIQUE.apply(null,e),i=e.length,a=n.length,o=Math.pow(10,t),u=0,s=!1,l=0;!s&&l<a;)r===n[l]?(u=e.indexOf(n[l])/(i-1),s=!0):r>=n[l]&&(r<n[l+1]||l===a-1)&&(u=(e.indexOf(n[l])+(r-n[l])/(n[l+1]-n[l]))/(i-1),s=!0),l++;return Math.floor(u*o)/o},exports.PERMUT=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:mathTrig.FACT(e)/mathTrig.FACT(e-r)},exports.PERMUTATIONA=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:Math.pow(e,r)},exports.PHI=function(e){return e=utils.parseNumber(e),e instanceof Error?error.value:Math.exp(-.5*e*e)/SQRT2PI},exports.POISSON={},exports.POISSON.DIST=function(e,r,t){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:t?jStat.poisson.cdf(e,r):jStat.poisson.pdf(e,r)},exports.PROB=function(e,r,t,n){if(void 0===t)return 0;if(n=void 0===n?t:n,e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,r,t,n))return error.value;if(t===n)return e.indexOf(t)>=0?r[e.indexOf(t)]:0;for(var i=e.sort(function(e,r){return e-r}),a=i.length,o=0,u=0;u<a;u++)i[u]>=t&&i[u]<=n&&(o+=r[e.indexOf(i[u])]);return o},exports.QUARTILE={},exports.QUARTILE.EXC=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumber(r),utils.anyIsError(e,r))return error.value;switch(r){case 1:return exports.PERCENTILE.EXC(e,.25);case 2:return exports.PERCENTILE.EXC(e,.5);case 3:return exports.PERCENTILE.EXC(e,.75);default:return error.num}},exports.QUARTILE.INC=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumber(r),utils.anyIsError(e,r))return error.value;switch(r){case 1:return exports.PERCENTILE.INC(e,.25);case 2:return exports.PERCENTILE.INC(e,.5);case 3:return exports.PERCENTILE.INC(e,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(e,r,t){if(e=utils.parseNumber(e),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;r=utils.flatten(r),t=t||!1;var n=t?function(e,r){return e-r}:function(e,r){return r-e};r=r.sort(n);for(var i=r.length,a=0,o=0;o<i;o++)r[o]===e&&a++;return a>1?(2*r.indexOf(e)+a+1)/2:r.indexOf(e)+1},exports.RANK.EQ=function(e,r,t){if(e=utils.parseNumber(e),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;t=t||!1;var n=t?function(e,r){return e-r}:function(e,r){return r-e};return r=r.sort(n),r.indexOf(e)+1},exports.ROW=function(e,r){if(2!==arguments.length)return error.na;if(r<0)return error.num;if(!(e instanceof Array)||"number"!=typeof r)return error.value;if(0!==e.length)return jStat.row(e,r)},exports.ROWS=function(e){return 1!==arguments.length?error.na:e instanceof Array?0===e.length?0:jStat.rows(e):error.value},exports.RSQ=function(e,r){return e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r)?error.value:Math.pow(exports.PEARSON(e,r),2)},exports.SKEW=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var r=jStat.mean(e),t=e.length,n=0,i=0;i<t;i++)n+=Math.pow(e[i]-r,3);return t*n/((t-1)*(t-2)*Math.pow(jStat.stdev(e,!0),3))},exports.SKEW.P=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var r=jStat.mean(e),t=e.length,n=0,i=0,a=0;a<t;a++)i+=Math.pow(e[a]-r,3),n+=Math.pow(e[a]-r,2);return i/=t,n/=t,i/Math.pow(n,1.5)},exports.SLOPE=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;for(var t=jStat.mean(r),n=jStat.mean(e),i=r.length,a=0,o=0,u=0;u<i;u++)a+=(r[u]-t)*(e[u]-n),o+=Math.pow(r[u]-t,2);return a/o},exports.SMALL=function(e,r){return e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumber(r),utils.anyIsError(e,r)?e:e.sort(function(e,r){return e-r})[r-1]},exports.STANDARDIZE=function(e,r,t){return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t)?error.value:(e-r)/t},exports.STDEV={},exports.STDEV.P=function(){var e=exports.VAR.P.apply(this,arguments);return Math.sqrt(e)},exports.STDEV.S=function(){var e=exports.VAR.S.apply(this,arguments);return Math.sqrt(e)},exports.STDEVA=function(){var e=exports.VARA.apply(this,arguments);return Math.sqrt(e)},exports.STDEVPA=function(){var e=exports.VARPA.apply(this,arguments);return Math.sqrt(e)},exports.STEYX=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;for(var t=jStat.mean(r),n=jStat.mean(e),i=r.length,a=0,o=0,u=0,s=0;s<i;s++)a+=Math.pow(e[s]-n,2),o+=(r[s]-t)*(e[s]-n),u+=Math.pow(r[s]-t,2);return Math.sqrt((a-o*o/u)/(i-2))},exports.TRANSPOSE=function(e){return e?jStat.transpose(e):error.na},exports.T=text.T,exports.T.DIST=function(e,r,t){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:t?jStat.studentt.cdf(e,r):jStat.studentt.pdf(e,r)},exports.T.DIST["2T"]=function(e,r){return 2!==arguments.length?error.na:e<0||r<1?error.num:"number"!=typeof e||"number"!=typeof r?error.value:2*(1-jStat.studentt.cdf(e,r))},exports.T.DIST.RT=function(e,r){return 2!==arguments.length?error.na:e<0||r<1?error.num:"number"!=typeof e||"number"!=typeof r?error.value:1-jStat.studentt.cdf(e,r)},exports.T.INV=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),utils.anyIsError(e,r)?error.value:jStat.studentt.inv(e,r)},exports.T.INV["2T"]=function(e,r){return e=utils.parseNumber(e),r=utils.parseNumber(r),e<=0||e>1||r<1?error.num:utils.anyIsError(e,r)?error.value:Math.abs(jStat.studentt.inv(e/2,r))},exports.T.TEST=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;var t,n=jStat.mean(e),i=jStat.mean(r),a=0,o=0;for(t=0;t<e.length;t++)a+=Math.pow(e[t]-n,2);for(t=0;t<r.length;t++)o+=Math.pow(r[t]-i,2);a/=e.length-1,o/=r.length-1;var u=Math.abs(n-i)/Math.sqrt(a/e.length+o/r.length);return exports.T.DIST["2T"](u,e.length+r.length-2)},exports.TREND=function(e,r,t){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,r,t))return error.value;var n=exports.LINEST(e,r),i=n[0],a=n[1],o=[];return t.forEach(function(e){o.push(i*e+a)}),o},exports.TRIMMEAN=function(e,r){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumber(r),utils.anyIsError(e,r))return error.value;var t=mathTrig.FLOOR(e.length*r,2)/2;return jStat.mean(utils.initial(utils.rest(e.sort(function(e,r){return e-r}),t),t))},exports.VAR={},exports.VAR.P=function(){for(var e=utils.numbers(utils.flatten(arguments)),r=e.length,t=0,n=exports.AVERAGE(e),i=0;i<r;i++)t+=Math.pow(e[i]-n,2);return t/r},exports.VAR.S=function(){for(var e=utils.numbers(utils.flatten(arguments)),r=e.length,t=0,n=exports.AVERAGE(e),i=0;i<r;i++)t+=Math.pow(e[i]-n,2);return t/(r-1)},exports.VARA=function(){for(var e=utils.flatten(arguments),r=e.length,t=0,n=0,i=exports.AVERAGEA(e),a=0;a<r;a++){var o=e[a];t+="number"==typeof o?Math.pow(o-i,2):o===!0?Math.pow(1-i,2):Math.pow(0-i,2),null!==o&&n++}return t/(n-1)},exports.VARPA=function(){for(var e=utils.flatten(arguments),r=e.length,t=0,n=0,i=exports.AVERAGEA(e),a=0;a<r;a++){var o=e[a];t+="number"==typeof o?Math.pow(o-i,2):o===!0?Math.pow(1-i,2):Math.pow(0-i,2),null!==o&&n++}return t/n},exports.WEIBULL={},exports.WEIBULL.DIST=function(e,r,t,n){return e=utils.parseNumber(e),r=utils.parseNumber(r),t=utils.parseNumber(t),utils.anyIsError(e,r,t)?error.value:n?1-Math.exp(-Math.pow(e/t,r)):Math.pow(e,r-1)*Math.exp(-Math.pow(e/t,r))*r/Math.pow(t,r)},exports.Z={},exports.Z.TEST=function(e,r,t){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumber(r),utils.anyIsError(e,r))return error.value;t=t||exports.STDEV.S(e);var n=e.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(e)-r)/(t/Math.sqrt(n)),!0)}},function(module,exports,e){var r=e(4),t=e(5),n=e(8);exports.ASC=function(){throw new Error("ASC is not implemented")},exports.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},exports.CHAR=function(e){return e=r.parseNumber(e),e instanceof Error?e:String.fromCharCode(e)},exports.CLEAN=function(e){e=e||"";var r=/[\0-\x1F]/g;return e.replace(r,"")},exports.CODE=function(e){return e=e||"",e.charCodeAt(0)},exports.CONCATENATE=function(){for(var e=r.flatten(arguments),t=0;(t=e.indexOf(!0))>-1;)e[t]="TRUE";for(var n=0;(n=e.indexOf(!1))>-1;)e[n]="FALSE";return e.join("")},exports.DBCS=function(){throw new Error("DBCS is not implemented")},exports.DOLLAR=function(e,i){if(i=void 0===i?2:i,e=r.parseNumber(e),i=r.parseNumber(i),r.anyIsError(e,i))return t.value;var a="";return i<=0?(e=Math.round(e*Math.pow(10,i))/Math.pow(10,i),a="($0,0)"):i>0&&(a="($0,0."+new Array(i+1).join("0")+")"),n(e).format(a)},exports.EXACT=function(e,r){return e===r},exports.FIND=function(e,r,t){return t=void 0===t?0:t,r?r.indexOf(e,t-1)+1:null},exports.FIXED=function(e,i,a){if(i=void 0===i?2:i,a=void 0!==a&&a,e=r.parseNumber(e),i=r.parseNumber(i),r.anyIsError(e,i))return t.value;var o=a?"0":"0,0";return i<=0?e=Math.round(e*Math.pow(10,i))/Math.pow(10,i):i>0&&(o+="."+new Array(i+1).join("0")),n(e).format(o)},exports.HTML2TEXT=function(e){var r="";return e&&(e instanceof Array?e.forEach(function(e){""!==r&&(r+="\n"),r+=e.replace(/<(?:.|\n)*?>/gm,"")}):r=e.replace(/<(?:.|\n)*?>/gm,"")),r},exports.LEFT=function(e,n){return n=void 0===n?1:n,n=r.parseNumber(n),n instanceof Error||"string"!=typeof e?t.value:e?e.substring(0,n):null},exports.LEN=function(e){return 0===arguments.length?t.error:"string"==typeof e?e?e.length:0:e.length?e.length:t.value},exports.LOWER=function(e){return"string"!=typeof e?t.value:e?e.toLowerCase():e},exports.MID=function(e,t,n){if(t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n)||"string"!=typeof e)return n;var i=t-1,a=i+n;return e.substring(i,a)},exports.NUMBERVALUE=function(e,r,t){return r="undefined"==typeof r?".":r,t="undefined"==typeof t?",":t,Number(e.replace(r,".").replace(t,""))},exports.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},exports.PROPER=function(e){return void 0===e||0===e.length?t.value:(e===!0&&(e="TRUE"),e===!1&&(e="FALSE"),isNaN(e)&&"number"==typeof e?t.value:("number"==typeof e&&(e=""+e),e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})))},exports.REGEXEXTRACT=function(e,r){var t=e.match(new RegExp(r));return t?t[t.length>1?t.length-1:0]:null},exports.REGEXMATCH=function(e,r,t){var n=e.match(new RegExp(r));return t?n:!!n},exports.REGEXREPLACE=function(e,r,t){return e.replace(new RegExp(r),t)},exports.REPLACE=function(e,n,i,a){return n=r.parseNumber(n),i=r.parseNumber(i),r.anyIsError(n,i)||"string"!=typeof e||"string"!=typeof a?t.value:e.substr(0,n-1)+a+e.substr(n-1+i)},exports.REPT=function(e,t){return t=r.parseNumber(t),t instanceof Error?t:new Array(t+1).join(e)},exports.RIGHT=function(e,t){return t=void 0===t?1:t,t=r.parseNumber(t),t instanceof Error?t:e?e.substring(e.length-t):null},exports.SEARCH=function(e,r,n){var i;return"string"!=typeof e||"string"!=typeof r?t.value:(n=void 0===n?0:n,i=r.toLowerCase().indexOf(e.toLowerCase(),n-1)+1,0===i?t.value:i)},exports.SPLIT=function(e,r){return e.split(r)},exports.SUBSTITUTE=function(e,r,t,n){if(!(e&&r&&t))return e;if(void 0===n)return e.replace(new RegExp(r,"g"),t);for(var i=0,a=0;e.indexOf(r,i)>0;)if(i=e.indexOf(r,i+1),a++,a===n)return e.substring(0,i)+t+e.substring(i+r.length)},exports.T=function(e){return"string"==typeof e?e:""},exports.TEXT=function(e,i){return e=r.parseNumber(e),r.anyIsError(e)?t.na:n(e).format(i)},exports.TRIM=function(e){return"string"!=typeof e?t.value:e.replace(/ +/g," ").trim()},exports.UNICHAR=this.CHAR,exports.UNICODE=this.CODE,exports.UPPER=function(e){return"string"!=typeof e?t.value:e.toUpperCase()},exports.VALUE=function(e){return"string"!=typeof e?t.value:n().unformat(e)}},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_8__},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_9__},function(module,exports,e){var r=e(4),t=e(8);exports.UNIQUE=function(){for(var e=[],r=0;r<arguments.length;++r){for(var t=!1,n=arguments[r],i=0;i<e.length&&!(t=e[i]===n);++i);t||e.push(n)}return e},exports.FLATTEN=r.flatten,exports.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},exports.REFERENCE=function(e,r){try{for(var t=r.split("."),n=e,i=0;i<t.length;++i){var a=t[i];if("]"===a[a.length-1]){var o=a.indexOf("["),u=a.substring(o+1,a.length-1);n=n[a.substring(0,o)][u]}else n=n[a]}return n}catch(e){}},exports.JOIN=function(e,r){return e.join(r)},exports.NUMBERS=function(){var e=r.flatten(arguments);return e.filter(function(e){return"number"==typeof e})},exports.NUMERAL=function(e,r){return t(e).format(r)}},function(module,exports,e){var r=e(5);exports.CELL=function(){throw new Error("CELL is not implemented")},exports.ERROR={},exports.ERROR.TYPE=function(e){switch(e){case r.nil:return 1;case r.div0:return 2;case r.value:return 3;case r.ref:return 4;case r.name:return 5;case r.num:return 6;case r.na:return 7;case r.data:return 8}return r.na},exports.INFO=function(){throw new Error("INFO is not implemented")},exports.ISBLANK=function(e){return null===e},exports.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},exports.ISERR=function(e){return[r.value,r.ref,r.div0,r.num,r.name,r.nil].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))},exports.ISERROR=function(e){return exports.ISERR(e)||e===r.na},exports.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},exports.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},exports.ISLOGICAL=function(e){return e===!0||e===!1},exports.ISNA=function(e){return e===r.na},exports.ISNONTEXT=function(e){return"string"!=typeof e},exports.ISNUMBER=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)},exports.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},exports.ISREF=function(){throw new Error("ISREF is not implemented")},exports.ISTEXT=function(e){return"string"==typeof e},exports.N=function(e){return this.ISNUMBER(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:this.ISERROR(e)?e:0},exports.NA=function(){return r.na},exports.SHEET=function(){throw new Error("SHEET is not implemented")},exports.SHEETS=function(){throw new Error("SHEETS is not implemented")},exports.TYPE=function(e){return this.ISNUMBER(e)?1:this.ISTEXT(e)?2:this.ISLOGICAL(e)?4:this.ISERROR(e)?16:Array.isArray(e)?64:void 0}},function(module,exports,e){function r(e){return/^[01]{1,10}$/.test(e)}var t=e(5),n=e(9).jStat,i=e(7),a=e(4),o=e(13);exports.BESSELI=function(e,r){return e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?t.value:o.besseli(e,r)},exports.BESSELJ=function(e,r){return e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?t.value:o.besselj(e,r)},exports.BESSELK=function(e,r){return e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?t.value:o.besselk(e,r)},exports.BESSELY=function(e,r){return e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?t.value:o.bessely(e,r)},exports.BIN2DEC=function(e){if(!r(e))return t.num;var n=parseInt(e,2),i=e.toString();return 10===i.length&&"1"===i.substring(0,1)?parseInt(i.substring(1),2)-512:n},exports.BIN2HEX=function(e,n){if(!r(e))return t.num;var a=e.toString();if(10===a.length&&"1"===a.substring(0,1))return(0xfffffffe00+parseInt(a.substring(1),2)).toString(16);var o=parseInt(e,2).toString(16);return void 0===n?o:isNaN(n)?t.value:n<0?t.num:(n=Math.floor(n),n>=o.length?i.REPT("0",n-o.length)+o:t.num)},exports.BIN2OCT=function(e,n){if(!r(e))return t.num;var a=e.toString();if(10===a.length&&"1"===a.substring(0,1))return(1073741312+parseInt(a.substring(1),2)).toString(8);var o=parseInt(e,2).toString(8);return void 0===n?o:isNaN(n)?t.value:n<0?t.num:(n=Math.floor(n),n>=o.length?i.REPT("0",n-o.length)+o:t.num)},exports.BITAND=function(e,r){return e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?t.value:e<0||r<0?t.num:Math.floor(e)!==e||Math.floor(r)!==r?t.num:e>0xffffffffffff||r>0xffffffffffff?t.num:e&r},exports.BITLSHIFT=function(e,r){return e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?t.value:e<0?t.num:Math.floor(e)!==e?t.num:e>0xffffffffffff?t.num:Math.abs(r)>53?t.num:r>=0?e<<r:e>>-r},exports.BITOR=function(e,r){return e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?t.value:e<0||r<0?t.num:Math.floor(e)!==e||Math.floor(r)!==r?t.num:e>0xffffffffffff||r>0xffffffffffff?t.num:e|r},exports.BITRSHIFT=function(e,r){return e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?t.value:e<0?t.num:Math.floor(e)!==e?t.num:e>0xffffffffffff?t.num:Math.abs(r)>53?t.num:r>=0?e>>r:e<<-r},exports.BITXOR=function(e,r){return e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?t.value:e<0||r<0?t.num:Math.floor(e)!==e||Math.floor(r)!==r?t.num:e>0xffffffffffff||r>0xffffffffffff?t.num:e^r},exports.COMPLEX=function(e,r,n){if(e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r))return e;if(n=void 0===n?"i":n,"i"!==n&&"j"!==n)return t.value;if(0===e&&0===r)return 0;if(0===e)return 1===r?n:r.toString()+n;if(0===r)return e.toString();var i=r>0?"+":"";return e.toString()+i+(1===r?n:r.toString()+n)},exports.CONVERT=function(e,r,n){if(e=a.parseNumber(e),e instanceof Error)return e;for(var i,o=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],u={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],
Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},from=null,l=null,c=r,f=n,h=1,p=1,m=0;m<o.length;m++)i=null===o[m][2]?[]:o[m][2],(o[m][1]===c||i.indexOf(c)>=0)&&(from=o[m]),(o[m][1]===f||i.indexOf(f)>=0)&&(l=o[m]);if(null===from){var d=u[r.substring(0,2)],v=s[r.substring(0,1)];"da"===r.substring(0,2)&&(v=["dekao",10,"da"]),d?(h=d[2],c=r.substring(2)):v&&(h=v[1],c=r.substring(v[2].length));for(var g=0;g<o.length;g++)i=null===o[g][2]?[]:o[g][2],(o[g][1]===c||i.indexOf(c)>=0)&&(from=o[g])}if(null===l){var y=u[n.substring(0,2)],b=s[n.substring(0,1)];"da"===n.substring(0,2)&&(b=["dekao",10,"da"]),y?(p=y[2],f=n.substring(2)):b&&(p=b[1],f=n.substring(b[2].length));for(var E=0;E<o.length;E++)i=null===o[E][2]?[]:o[E][2],(o[E][1]===f||i.indexOf(f)>=0)&&(l=o[E])}return null===from||null===l?t.na:from[3]!==l[3]?t.na:e*from[6]*h/(l[6]*p)},exports.DEC2BIN=function(e,r){if(e=a.parseNumber(e),e instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return t.num;if(e<0)return"1"+i.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var n=parseInt(e,10).toString(2);return"undefined"==typeof r?n:isNaN(r)?t.value:r<0?t.num:(r=Math.floor(r),r>=n.length?i.REPT("0",r-n.length)+n:t.num)},exports.DEC2HEX=function(e,r){if(e=a.parseNumber(e),e instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return t.num;if(e<0)return(1099511627776+e).toString(16);var n=parseInt(e,10).toString(16);return"undefined"==typeof r?n:isNaN(r)?t.value:r<0?t.num:(r=Math.floor(r),r>=n.length?i.REPT("0",r-n.length)+n:t.num)},exports.DEC2OCT=function(e,r){if(e=a.parseNumber(e),e instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return t.num;if(e<0)return(1073741824+e).toString(8);var n=parseInt(e,10).toString(8);return"undefined"==typeof r?n:isNaN(r)?t.value:r<0?t.num:(r=Math.floor(r),r>=n.length?i.REPT("0",r-n.length)+n:t.num)},exports.DELTA=function(e,r){return r=void 0===r?0:r,e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?t.value:e===r?1:0},exports.ERF=function(e,r){return r=void 0===r?0:r,e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?t.value:n.erf(e)},exports.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},exports.ERFC=function(e){return isNaN(e)?t.value:n.erfc(e)},exports.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},exports.GESTEP=function(e,r){return r=r||0,e=a.parseNumber(e),a.anyIsError(r,e)?e:e>=r?1:0},exports.HEX2BIN=function(e,r){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return t.num;var n=10===e.length&&"f"===e.substring(0,1).toLowerCase(),a=n?parseInt(e,16)-1099511627776:parseInt(e,16);if(a<-512||a>511)return t.num;if(n)return"1"+i.REPT("0",9-(512+a).toString(2).length)+(512+a).toString(2);var o=a.toString(2);return void 0===r?o:isNaN(r)?t.value:r<0?t.num:(r=Math.floor(r),r>=o.length?i.REPT("0",r-o.length)+o:t.num)},exports.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return t.num;var r=parseInt(e,16);return r>=549755813888?r-1099511627776:r},exports.HEX2OCT=function(e,r){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return t.num;var n=parseInt(e,16);if(n>536870911&&n<0xffe0000000)return t.num;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);var a=n.toString(8);return void 0===r?a:isNaN(r)?t.value:r<0?t.num:(r=Math.floor(r),r>=a.length?i.REPT("0",r-a.length)+a:t.num)},exports.IMABS=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);return a.anyIsError(r,n)?t.value:Math.sqrt(Math.pow(r,2)+Math.pow(n,2))},exports.IMAGINARY=function(e){if(void 0===e||e===!0||e===!1)return t.value;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var r=e.indexOf("+"),n=e.indexOf("-");0===r&&(r=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var i=e.substring(e.length-1,e.length),a="i"===i||"j"===i;return r>=0||n>=0?a?r>=0?isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?t.num:Number(e.substring(r+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?t.num:-Number(e.substring(n+1,e.length-1)):t.num:a?isNaN(e.substring(0,e.length-1))?t.num:e.substring(0,e.length-1):isNaN(e)?t.num:0},exports.IMARGUMENT=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);return a.anyIsError(r,n)?t.value:0===r&&0===n?t.div0:0===r&&n>0?Math.PI/2:0===r&&n<0?-Math.PI/2:0===n&&r>0?0:0===n&&r<0?-Math.PI:r>0?Math.atan(n/r):r<0&&n>=0?Math.atan(n/r)+Math.PI:Math.atan(n/r)-Math.PI},exports.IMCONJUGATE=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);if(a.anyIsError(r,n))return t.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",0!==n?exports.COMPLEX(r,-n,i):e},exports.IMCOS=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);if(a.anyIsError(r,n))return t.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",exports.COMPLEX(Math.cos(r)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(r)*(Math.exp(n)-Math.exp(-n))/2,i)},exports.IMCOSH=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);if(a.anyIsError(r,n))return t.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",exports.COMPLEX(Math.cos(n)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(n)*(Math.exp(r)-Math.exp(-r))/2,i)},exports.IMCOT=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);return a.anyIsError(r,n)?t.value:exports.IMDIV(exports.IMCOS(e),exports.IMSIN(e))},exports.IMDIV=function(e,r){var n=exports.IMREAL(e),i=exports.IMAGINARY(e),o=exports.IMREAL(r),u=exports.IMAGINARY(r);if(a.anyIsError(n,i,o,u))return t.value;var s=e.substring(e.length-1),l=r.substring(r.length-1),c="i";if("j"===s?c="j":"j"===l&&(c="j"),0===o&&0===u)return t.num;var f=o*o+u*u;return exports.COMPLEX((n*o+i*u)/f,(i*o-n*u)/f,c)},exports.IMEXP=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);if(a.anyIsError(r,n))return t.value;var i=e.substring(e.length-1);i="i"===i||"j"===i?i:"i";var o=Math.exp(r);return exports.COMPLEX(o*Math.cos(n),o*Math.sin(n),i)},exports.IMLN=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);if(a.anyIsError(r,n))return t.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",exports.COMPLEX(Math.log(Math.sqrt(r*r+n*n)),Math.atan(n/r),i)},exports.IMLOG10=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);if(a.anyIsError(r,n))return t.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",exports.COMPLEX(Math.log(Math.sqrt(r*r+n*n))/Math.log(10),Math.atan(n/r)/Math.log(10),i)},exports.IMLOG2=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);if(a.anyIsError(r,n))return t.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",exports.COMPLEX(Math.log(Math.sqrt(r*r+n*n))/Math.log(2),Math.atan(n/r)/Math.log(2),i)},exports.IMPOWER=function(e,r){r=a.parseNumber(r);var n=exports.IMREAL(e),i=exports.IMAGINARY(e);if(a.anyIsError(r,n,i))return t.value;var o=e.substring(e.length-1);o="i"===o||"j"===o?o:"i";var u=Math.pow(exports.IMABS(e),r),s=exports.IMARGUMENT(e);return exports.COMPLEX(u*Math.cos(r*s),u*Math.sin(r*s),o)},exports.IMPRODUCT=function(){for(var e=arguments[0],r=1;r<arguments.length;r++){var n=exports.IMREAL(e),i=exports.IMAGINARY(e),o=exports.IMREAL(arguments[r]),u=exports.IMAGINARY(arguments[r]);if(a.anyIsError(n,i,o,u))return t.value;e=exports.COMPLEX(n*o-i*u,n*u+i*o)}return e},exports.IMREAL=function(e){if(void 0===e||e===!0||e===!1)return t.value;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var r=e.indexOf("+"),n=e.indexOf("-");0===r&&(r=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var i=e.substring(e.length-1,e.length),a="i"===i||"j"===i;return r>=0||n>=0?a?r>=0?isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?t.num:Number(e.substring(0,r)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?t.num:Number(e.substring(0,n)):t.num:a?isNaN(e.substring(0,e.length-1))?t.num:0:isNaN(e)?t.num:e},exports.IMSEC=function(e){if(e===!0||e===!1)return t.value;var r=exports.IMREAL(e),n=exports.IMAGINARY(e);return a.anyIsError(r,n)?t.value:exports.IMDIV("1",exports.IMCOS(e))},exports.IMSECH=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);return a.anyIsError(r,n)?t.value:exports.IMDIV("1",exports.IMCOSH(e))},exports.IMSIN=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);if(a.anyIsError(r,n))return t.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",exports.COMPLEX(Math.sin(r)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(r)*(Math.exp(n)-Math.exp(-n))/2,i)},exports.IMSINH=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);if(a.anyIsError(r,n))return t.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",exports.COMPLEX(Math.cos(n)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(n)*(Math.exp(r)+Math.exp(-r))/2,i)},exports.IMSQRT=function(e){var r=exports.IMREAL(e),n=exports.IMAGINARY(e);if(a.anyIsError(r,n))return t.value;var i=e.substring(e.length-1);i="i"===i||"j"===i?i:"i";var o=Math.sqrt(exports.IMABS(e)),u=exports.IMARGUMENT(e);return exports.COMPLEX(o*Math.cos(u/2),o*Math.sin(u/2),i)},exports.IMCSC=function(e){if(e===!0||e===!1)return t.value;var r=exports.IMREAL(e),n=exports.IMAGINARY(e);return a.anyIsError(r,n)?t.num:exports.IMDIV("1",exports.IMSIN(e))},exports.IMCSCH=function(e){if(e===!0||e===!1)return t.value;var r=exports.IMREAL(e),n=exports.IMAGINARY(e);return a.anyIsError(r,n)?t.num:exports.IMDIV("1",exports.IMSINH(e))},exports.IMSUB=function(e,r){var n=this.IMREAL(e),i=this.IMAGINARY(e),o=this.IMREAL(r),u=this.IMAGINARY(r);if(a.anyIsError(n,i,o,u))return t.value;var s=e.substring(e.length-1),l=r.substring(r.length-1),c="i";return"j"===s?c="j":"j"===l&&(c="j"),this.COMPLEX(n-o,i-u,c)},exports.IMSUM=function(){for(var e=a.flatten(arguments),r=e[0],n=1;n<e.length;n++){var i=this.IMREAL(r),o=this.IMAGINARY(r),u=this.IMREAL(e[n]),s=this.IMAGINARY(e[n]);if(a.anyIsError(i,o,u,s))return t.value;r=this.COMPLEX(i+u,o+s)}return r},exports.IMTAN=function(e){if(e===!0||e===!1)return t.value;var r=exports.IMREAL(e),n=exports.IMAGINARY(e);return a.anyIsError(r,n)?t.value:this.IMDIV(this.IMSIN(e),this.IMCOS(e))},exports.OCT2BIN=function(e,r){if(!/^[0-7]{1,10}$/.test(e))return t.num;var n=10===e.length&&"7"===e.substring(0,1),a=n?parseInt(e,8)-1073741824:parseInt(e,8);if(a<-512||a>511)return t.num;if(n)return"1"+i.REPT("0",9-(512+a).toString(2).length)+(512+a).toString(2);var o=a.toString(2);return"undefined"==typeof r?o:isNaN(r)?t.value:r<0?t.num:(r=Math.floor(r),r>=o.length?i.REPT("0",r-o.length)+o:t.num)},exports.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return t.num;var r=parseInt(e,8);return r>=536870912?r-1073741824:r},exports.OCT2HEX=function(e,r){if(!/^[0-7]{1,10}$/.test(e))return t.num;var n=parseInt(e,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);var a=n.toString(16);return void 0===r?a:isNaN(r)?t.value:r<0?t.num:(r=Math.floor(r),r>=a.length?i.REPT("0",r-a.length)+a:t.num)}},function(module,exports,e){function r(e,r){return e.reduce(function(e,t){return r*e+t},0)}function t(e,r,t,n,i){i||(i=-1);var a,o=2/e;if(0===r)return t;if(1===r)return n;for(var u=1;u!=r;++u)a=n*u*o+i*t,t=n,n=a;return n}function n(e,r,n,i,a){return function(o,u){if(0===u)return e(o);if(1===u)return r(o);if(u<0)throw n+": Order ("+u+") must be nonnegative";if(1==i&&0===o)throw n+": Undefined when x == 0";if(2==i&&o<=0)throw n+": Undefined when x <= 0";var s=e(o),l=r(o);return t(o,u,s,l,a)}}var i=Math,a=function(){function e(e){var t,n,c,f=e*e,h=i.abs(e)-.785398164;return i.abs(e)<8?(n=r(a,f),c=r(o,f),t=n/c):(f=64/f,n=r(u,f),c=r(s,f),t=i.sqrt(l/i.abs(e))*(i.cos(h)*n-i.sin(h)*c*8/i.abs(e))),t}function n(e){var t,n,a,o=e*e,u=i.abs(e)-2.356194491;return Math.abs(e)<8?(n=e*r(c,o),a=r(f,o),t=n/a):(o=64/o,n=r(h,o),a=r(p,o),t=i.sqrt(l/i.abs(e))*(i.cos(u)*n-i.sin(u)*a*8/i.abs(e)),e<0&&(t=-t)),t}var a=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),o=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),u=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),l=.636619772,c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),f=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return function(r,a){if(a=Math.round(a),0===a)return e(i.abs(r));if(1===a)return n(i.abs(r));if(a<0)throw"BESSELJ: Order ("+a+") must be nonnegative";if(0===i.abs(r))return 0;var o,u,s,l,c,f,h,p,m=2/i.abs(r);if(i.abs(r)>a)o=t(r,a,e(i.abs(r)),n(i.abs(r)),-1);else{for(s=2*i.floor((a+i.floor(i.sqrt(40*a)))/2),l=0,f=o=c=0,h=1,u=s;u>0;u--)p=u*m*h-f,f=h,h=p,i.abs(h)>1e10&&(h*=1e-10,f*=1e-10,o*=1e-10,c*=1e-10),l&&(c+=h),l=!l,u==a&&(o=f);c=2*c-h,o/=c}return r<0&&a%2?-o:o}}(),o=function(){function e(e){var t,n,f,h=e*e,p=e-.785398164;return e<8?(n=r(o,h),f=r(u,h),t=n/f+c*a(e,0)*i.log(e)):(h=64/h,n=r(s,h),f=r(l,h),t=i.sqrt(c/e)*(i.sin(p)*n+i.cos(p)*f*8/e)),t}function t(e){var t,n,o,u=e*e,s=e-2.356194491;return e<8?(n=e*r(f,u),o=r(h,u),t=n/o+c*(a(e,1)*i.log(e)-1/e)):(u=64/u,n=r(p,u),o=r(m,u),t=i.sqrt(c/e)*(i.sin(s)*n+i.cos(s)*o*8/e)),t}var o=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),u=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),s=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),l=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),c=.636619772,f=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),h=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),p=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),m=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return n(e,t,"BESSELY",1,-1)}(),u=function(){function e(e){return e<=3.75?r(n,e*e/14.0625):i.exp(i.abs(e))/i.sqrt(i.abs(e))*r(a,3.75/i.abs(e))}function t(e){return e<3.75?e*r(o,e*e/14.0625):(e<0?-1:1)*i.exp(i.abs(e))/i.sqrt(i.abs(e))*r(u,3.75/i.abs(e))}var n=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),a=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),o=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),u=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function r(n,a){if(a=Math.round(a),0===a)return e(n);if(1==a)return t(n);if(a<0)throw"BESSELI Order ("+a+") must be nonnegative";if(0===i.abs(n))return 0;var o,u,s,l,c,f,h=2/i.abs(n);for(s=2*i.round((a+i.round(i.sqrt(40*a)))/2),l=o=0,c=1,u=s;u>0;u--)f=u*h*c+l,l=c,c=f,i.abs(c)>1e10&&(c*=1e-10,l*=1e-10,o*=1e-10),u==a&&(o=l);return o*=r(n,0)/c,n<0&&a%2?-o:o}}(),s=function(){function e(e){return e<=2?-i.log(e/2)*u(e,0)+r(a,e*e/4):i.exp(-e)/i.sqrt(e)*r(o,2/e)}function t(e){return e<=2?i.log(e/2)*u(e,1)+1/e*r(s,e*e/4):i.exp(-e)/i.sqrt(e)*r(l,2/e)}var a=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),o=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),s=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),l=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return n(e,t,"BESSELK",2,1)}();exports.besselj=a,exports.bessely=o,exports.besseli=u,exports.besselk=s},function(module,exports,e){function r(e){return 1===new Date(e,1,29).getMonth()}function t(e,r){return Math.ceil((r-e)/1e3/60/60/24)}function n(e){var r=e>-22038912e5?2:1;return(e-o)/864e5+r}var i=e(5),a=e(4),o=new Date(1900,0,1),u=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],s=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],l=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];exports.DATE=function(e,r,t){if(e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),a.anyIsError(e,r,t))return i.value;if(e<0||r<0||t<0)return i.num;var n=new Date(e,r-1,t);return n},exports.DATEVALUE=function(e){if("string"!=typeof e)return i.value;var r=Date.parse(e);return isNaN(r)?i.value:r<=-22038912e5?(r-o)/864e5+1:(r-o)/864e5+2},exports.DAY=function(e){var r=a.parseDate(e);return r instanceof Error?r:r.getDate()},exports.DAYS=function(e,r){return e=a.parseDate(e),r=a.parseDate(r),e instanceof Error?e:r instanceof Error?r:n(e)-n(r)},exports.DAYS360=function(e,r,t){if(t=a.parseBool(t),e=a.parseDate(e),r=a.parseDate(r),e instanceof Error)return e;if(r instanceof Error)return r;if(t instanceof Error)return t;var n,i,o=e.getMonth(),u=r.getMonth();if(t)n=31===e.getDate()?30:e.getDate(),i=31===r.getDate()?30:r.getDate();else{var s=new Date(e.getFullYear(),o+1,0).getDate(),l=new Date(r.getFullYear(),u+1,0).getDate();n=e.getDate()===s?30:e.getDate(),r.getDate()===l?n<30?(u++,i=1):i=30:i=r.getDate()}return 360*(r.getFullYear()-e.getFullYear())+30*(u-o)+(i-n)},exports.EDATE=function(e,r){return e=a.parseDate(e),e instanceof Error?e:isNaN(r)?i.value:(r=parseInt(r,10),e.setMonth(e.getMonth()+r),n(e))},exports.EOMONTH=function(e,r){return e=a.parseDate(e),e instanceof Error?e:isNaN(r)?i.value:(r=parseInt(r,10),n(new Date(e.getFullYear(),e.getMonth()+r+1,0)))},exports.HOUR=function(e){return e=a.parseDate(e),e instanceof Error?e:e.getHours()},exports.INTERVAL=function(e){if("number"!=typeof e&&"string"!=typeof e)return i.value;e=parseInt(e,10);var r=Math.floor(e/94608e4);e%=94608e4;var t=Math.floor(e/2592e3);e%=2592e3;var n=Math.floor(e/86400);e%=86400;var a=Math.floor(e/3600);e%=3600;var o=Math.floor(e/60);e%=60;var u=e;return r=r>0?r+"Y":"",t=t>0?t+"M":"",n=n>0?n+"D":"",a=a>0?a+"H":"",o=o>0?o+"M":"",u=u>0?u+"S":"","P"+r+t+n+"T"+a+o+u},exports.ISOWEEKNUM=function(e){if(e=a.parseDate(e),e instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var r=new Date(e.getFullYear(),0,1);return Math.ceil(((e-r)/864e5+1)/7)},exports.MINUTE=function(e){return e=a.parseDate(e),e instanceof Error?e:e.getMinutes()},exports.MONTH=function(e){return e=a.parseDate(e),e instanceof Error?e:e.getMonth()+1},exports.NETWORKDAYS=function(e,r,t){return this.NETWORKDAYS.INTL(e,r,1,t)},exports.NETWORKDAYS.INTL=function(e,r,t,n){if(e=a.parseDate(e),e instanceof Error)return e;if(r=a.parseDate(r),r instanceof Error)return r;if(t=void 0===t?l[1]:l[t],!(t instanceof Array))return i.value;void 0===n?n=[]:n instanceof Array||(n=[n]);for(var o=0;o<n.length;o++){var u=a.parseDate(n[o]);if(u instanceof Error)return u;n[o]=u}var s=(r-e)/864e5+1,c=s,f=e;for(o=0;o<s;o++){var h=(new Date).getTimezoneOffset()>0?f.getUTCDay():f.getDay(),p=!1;h!==t[0]&&h!==t[1]||(p=!0);for(var m=0;m<n.length;m++){var d=n[m];if(d.getDate()===f.getDate()&&d.getMonth()===f.getMonth()&&d.getFullYear()===f.getFullYear()){p=!0;break}}p&&c--,f.setDate(f.getDate()+1)}return c},exports.NOW=function(){return new Date},exports.SECOND=function(e){return e=a.parseDate(e),e instanceof Error?e:e.getSeconds()},exports.TIME=function(e,r,t){return e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),a.anyIsError(e,r,t)?i.value:e<0||r<0||t<0?i.num:(3600*e+60*r+t)/86400},exports.TIMEVALUE=function(e){return e=a.parseDate(e),e instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},exports.TODAY=function(){return new Date},exports.WEEKDAY=function(e,r){if(e=a.parseDate(e),e instanceof Error)return e;void 0===r&&(r=1);var t=e.getDay();return s[r][t]},exports.WEEKNUM=function(e,r){if(e=a.parseDate(e),e instanceof Error)return e;if(void 0===r&&(r=1),21===r)return this.ISOWEEKNUM(e);var t=u[r],n=new Date(e.getFullYear(),0,1),i=n.getDay()<t?1:0;return n-=24*Math.abs(n.getDay()-t)*60*60*1e3,Math.floor((e-n)/864e5/7+1)+i},exports.WORKDAY=function(e,r,t){return this.WORKDAY.INTL(e,r,1,t)},exports.WORKDAY.INTL=function(e,r,t,n){if(e=a.parseDate(e),e instanceof Error)return e;if(r=a.parseNumber(r),r instanceof Error)return r;if(r<0)return i.num;if(t=void 0===t?l[1]:l[t],!(t instanceof Array))return i.value;void 0===n?n=[]:n instanceof Array||(n=[n]);for(var o=0;o<n.length;o++){var u=a.parseDate(n[o]);if(u instanceof Error)return u;n[o]=u}for(var s=0;s<r;){e.setDate(e.getDate()+1);var c=e.getDay();if(c!==t[0]&&c!==t[1]){for(var f=0;f<n.length;f++){var h=n[f];if(h.getDate()===e.getDate()&&h.getMonth()===e.getMonth()&&h.getFullYear()===e.getFullYear()){s--;break}}s++}}return e},exports.YEAR=function(e){return e=a.parseDate(e),e instanceof Error?e:e.getFullYear()},exports.YEARFRAC=function(e,n,i){if(e=a.parseDate(e),e instanceof Error)return e;if(n=a.parseDate(n),n instanceof Error)return n;i=i||0;var o=e.getDate(),u=e.getMonth()+1,s=e.getFullYear(),l=n.getDate(),c=n.getMonth()+1,f=n.getFullYear();switch(i){case 0:return 31===o&&31===l?(o=30,l=30):31===o?o=30:30===o&&31===l&&(l=30),(l+30*c+360*f-(o+30*u+360*s))/360;case 1:var h=function(e,t){var n=e.getFullYear(),i=new Date(n,2,1);if(r(n)&&e<i&&t>=i)return!0;var a=t.getFullYear(),o=new Date(a,2,1);return r(a)&&t>=o&&e<o},p=365;if(s===f||s+1===f&&(u>c||u===c&&o>=l))return(s===f&&r(s)||h(e,n)||1===c&&29===l)&&(p=366),t(e,n)/p;var m=f-s+1,d=(new Date(f+1,0,1)-new Date(s,0,1))/1e3/60/60/24,v=d/m;return t(e,n)/v;case 2:return t(e,n)/360;case 3:return t(e,n)/365;case 4:return(l+30*c+360*f-(o+30*u+360*s))/360}}},function(module,exports,__webpack_require__){function compact(e){if(!e)return e;for(var r=[],t=0;t<e.length;++t)e[t]&&r.push(e[t]);return r}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}var error=__webpack_require__(5),stats=__webpack_require__(6),maths=__webpack_require__(2),utils=__webpack_require__(4);exports.FINDFIELD=function(e,r){for(var t=null,n=0;n<e.length;n++)if(e[n][0]===r){t=n;break}return null==t?error.value:t},exports.DAVERAGE=function(e,r,t){if(isNaN(r)&&"string"!=typeof r)return error.value;var n=findResultIndex(e,t),i=[];if("string"==typeof r){var a=exports.FINDFIELD(e,r);i=utils.rest(e[a])}else i=utils.rest(e[r]);for(var o=0,u=0;u<n.length;u++)o+=i[n[u]];return 0===n.length?error.div0:o/n.length},exports.DCOUNT=function(e,r,t){if(isNaN(r)&&"string"!=typeof r)return error.value;var n=findResultIndex(e,t),i=[];if("string"==typeof r){var a=exports.FINDFIELD(e,r);i=utils.rest(e[a])}else i=utils.rest(e[r]);for(var o=[],u=0;u<n.length;u++)o[u]=i[n[u]];return stats.COUNT(o)},exports.DCOUNTA=function(e,r,t){if(isNaN(r)&&"string"!=typeof r)return error.value;var n=findResultIndex(e,t),i=[];if("string"==typeof r){var a=exports.FINDFIELD(e,r);i=utils.rest(e[a])}else i=utils.rest(e[r]);for(var o=[],u=0;u<n.length;u++)o[u]=i[n[u]];return stats.COUNTA(o)},exports.DGET=function(e,r,t){if(isNaN(r)&&"string"!=typeof r)return error.value;var n=findResultIndex(e,t),i=[];if("string"==typeof r){var a=exports.FINDFIELD(e,r);i=utils.rest(e[a])}else i=utils.rest(e[r]);return 0===n.length?error.value:n.length>1?error.num:i[n[0]]},exports.DMAX=function(e,r,t){if(isNaN(r)&&"string"!=typeof r)return error.value;var n=findResultIndex(e,t),i=[];if("string"==typeof r){var a=exports.FINDFIELD(e,r);i=utils.rest(e[a])}else i=utils.rest(e[r]);for(var o=i[n[0]],u=1;u<n.length;u++)o<i[n[u]]&&(o=i[n[u]]);return o},exports.DMIN=function(e,r,t){if(isNaN(r)&&"string"!=typeof r)return error.value;var n=findResultIndex(e,t),i=[];if("string"==typeof r){var a=exports.FINDFIELD(e,r);i=utils.rest(e[a])}else i=utils.rest(e[r]);for(var o=i[n[0]],u=1;u<n.length;u++)o>i[n[u]]&&(o=i[n[u]]);return o},exports.DPRODUCT=function(e,r,t){if(isNaN(r)&&"string"!=typeof r)return error.value;var n=findResultIndex(e,t),i=[];if("string"==typeof r){var a=exports.FINDFIELD(e,r);i=utils.rest(e[a])}else i=utils.rest(e[r]);for(var o=[],u=0;u<n.length;u++)o[u]=i[n[u]];o=compact(o);var s=1;for(u=0;u<o.length;u++)s*=o[u];return s},exports.DSTDEV=function(e,r,t){if(isNaN(r)&&"string"!=typeof r)return error.value;var n=findResultIndex(e,t),i=[];if("string"==typeof r){var a=exports.FINDFIELD(e,r);i=utils.rest(e[a])}else i=utils.rest(e[r]);for(var o=[],u=0;u<n.length;u++)o[u]=i[n[u]];return o=compact(o),stats.STDEV.S(o)},exports.DSTDEVP=function(e,r,t){if(isNaN(r)&&"string"!=typeof r)return error.value;var n=findResultIndex(e,t),i=[];if("string"==typeof r){var a=exports.FINDFIELD(e,r);i=utils.rest(e[a])}else i=utils.rest(e[r]);for(var o=[],u=0;u<n.length;u++)o[u]=i[n[u]];return o=compact(o),stats.STDEV.P(o)},exports.DSUM=function(e,r,t){if(isNaN(r)&&"string"!=typeof r)return error.value;var n=findResultIndex(e,t),i=[];if("string"==typeof r){var a=exports.FINDFIELD(e,r);i=utils.rest(e[a])}else i=utils.rest(e[r]);for(var o=[],u=0;u<n.length;u++)o[u]=i[n[u]];return maths.SUM(o)},exports.DVAR=function(e,r,t){if(isNaN(r)&&"string"!=typeof r)return error.value;var n=findResultIndex(e,t),i=[];if("string"==typeof r){var a=exports.FINDFIELD(e,r);i=utils.rest(e[a])}else i=utils.rest(e[r]);for(var o=[],u=0;u<n.length;u++)o[u]=i[n[u]];return stats.VAR.S(o)},exports.DVARP=function(e,r,t){if(isNaN(r)&&"string"!=typeof r)return error.value;var n=findResultIndex(e,t),i=[];if("string"==typeof r){var a=exports.FINDFIELD(e,r);i=utils.rest(e[a])}else i=utils.rest(e[r]);for(var o=[],u=0;u<n.length;u++)o[u]=i[n[u]];return stats.VAR.P(o)}},function(module,exports,e){var r=e(5),t=e(4),n=e(11);exports.AND=function(){for(var e=t.flatten(arguments),r=!0,n=0;n<e.length;n++)e[n]||(r=!1);return r},exports.CHOOSE=function(){if(arguments.length<2)return r.na;var e=arguments[0];return e<1||e>254?r.value:arguments.length<e+1?r.value:arguments[e]},exports.FALSE=function(){return!1},exports.IF=function(e,r,t){return e?r:t},exports.IFERROR=function(e,r){return n.ISERROR(e)?r:e},exports.IFNA=function(e,t){return e===r.na?t:e},exports.NOT=function(e){return!e},exports.OR=function(){for(var e=t.flatten(arguments),r=!1,n=0;n<e.length;n++)e[n]&&(r=!0);return r},exports.TRUE=function(){return!0},exports.XOR=function(){for(var e=t.flatten(arguments),r=0,n=0;n<e.length;n++)e[n]&&r++;return!!(1&Math.floor(Math.abs(r)))},exports.SWITCH=function(){var e;if(arguments.length>0){var r=arguments[0],t=arguments.length-1,n=Math.floor(t/2),i=!1,a=t%2===0?null:arguments[arguments.length-1];if(n)for(var o=0;o<n;o++)if(r===arguments[2*o+1]){e=arguments[2*o+2],i=!0;break}!i&&a&&(e=a)}return e}},function(module,exports,e){function r(e){return e&&e.getTime&&!isNaN(e.getTime())}function t(e){return e instanceof Date?e:new Date(e)}var n=e(5),i=e(14),a=e(4);exports.ACCRINT=function(e,n,a,o,u,s,l){return e=t(e),n=t(n),a=t(a),r(e)&&r(n)&&r(a)?o<=0||u<=0?"#NUM!":[1,2,4].indexOf(s)===-1?"#NUM!":[0,1,2,3,4].indexOf(l)===-1?"#NUM!":a<=e?"#NUM!":(u=u||0,l=l||0,u*o*i.YEARFRAC(e,a,l)):"#VALUE!"},exports.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},exports.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},exports.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},exports.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},exports.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},exports.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},exports.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},exports.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},exports.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},exports.CUMIPMT=function(e,r,t,i,o,u){if(e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),a.anyIsError(e,r,t))return n.value;if(e<=0||r<=0||t<=0)return n.num;if(i<1||o<1||i>o)return n.num;if(0!==u&&1!==u)return n.num;var s=exports.PMT(e,r,t,0,u),l=0;1===i&&0===u&&(l=-t,i++);for(var c=i;c<=o;c++)l+=1===u?exports.FV(e,c-2,s,t,1)-s:exports.FV(e,c-1,s,t,0);return l*=e},exports.CUMPRINC=function(e,r,t,i,o,u){if(e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),a.anyIsError(e,r,t))return n.value;if(e<=0||r<=0||t<=0)return n.num;if(i<1||o<1||i>o)return n.num;if(0!==u&&1!==u)return n.num;var s=exports.PMT(e,r,t,0,u),l=0;1===i&&(l=0===u?s+t*e:s,i++);for(var c=i;c<=o;c++)l+=u>0?s-(exports.FV(e,c-2,s,t,1)-s)*e:s-exports.FV(e,c-1,s,t,0)*e;return l},exports.DB=function(e,r,t,i,o){if(o=void 0===o?12:o,e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,r,t,i,o))return n.value;if(e<0||r<0||t<0||i<0)return n.num;if([1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o)===-1)return n.num;if(i>t)return n.num;if(r>=e)return 0;for(var u=(1-Math.pow(r/e,1/t)).toFixed(3),s=e*u*o/12,l=s,c=0,f=i===t?t-1:i,h=2;h<=f;h++)c=(e-l)*u,l+=c;return 1===i?s:i===t?(e-l)*u:c},exports.DDB=function(e,r,t,i,o){if(o=void 0===o?2:o,e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,r,t,i,o))return n.value;if(e<0||r<0||t<0||i<0||o<=0)return n.num;if(i>t)return n.num;if(r>=e)return 0;for(var u=0,s=0,l=1;l<=i;l++)s=Math.min((e-u)*(o/t),e-r-u),u+=s;return s},exports.DISC=function(){throw new Error("DISC is not implemented")},exports.DOLLARDE=function(e,r){if(e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r))return n.value;if(r<0)return n.num;if(r>=0&&r<1)return n.div0;r=parseInt(r,10);var t=parseInt(e,10);t+=e%1*Math.pow(10,Math.ceil(Math.log(r)/Math.LN10))/r;var i=Math.pow(10,Math.ceil(Math.log(r)/Math.LN2)+1);return t=Math.round(t*i)/i},exports.DOLLARFR=function(e,r){if(e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r))return n.value;if(r<0)return n.num;if(r>=0&&r<1)return n.div0;r=parseInt(r,10);var t=parseInt(e,10);return t+=e%1*Math.pow(10,-Math.ceil(Math.log(r)/Math.LN10))*r},exports.DURATION=function(){throw new Error("DURATION is not implemented")},exports.EFFECT=function(e,r){return e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?n.value:e<=0||r<1?n.num:(r=parseInt(r,10),Math.pow(1+e/r,r)-1)},exports.FV=function(e,r,t,i,o){if(i=i||0,o=o||0,e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,r,t,i,o))return n.value;var u;if(0===e)u=i+t*r;else{var s=Math.pow(1+e,r);u=1===o?i*s+t*(1+e)*(s-1)/e:i*s+t*(s-1)/e}return-u},exports.FVSCHEDULE=function(e,r){if(e=a.parseNumber(e),r=a.parseNumberArray(a.flatten(r)),a.anyIsError(e,r))return n.value;for(var t=r.length,i=e,o=0;o<t;o++)i*=1+r[o];return i},exports.INTRATE=function(){throw new Error("INTRATE is not implemented")},exports.IPMT=function(e,r,t,i,o,u){if(o=o||0,u=u||0,e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),i=a.parseNumber(i),o=a.parseNumber(o),u=a.parseNumber(u),
a.anyIsError(e,r,t,i,o,u))return n.value;var s,l=exports.PMT(e,t,i,o,u);return s=1===r?1===u?0:-i:1===u?exports.FV(e,r-2,l,i,1)-l:exports.FV(e,r-1,l,i,0),s*e},exports.IRR=function(e,r){if(r=r||0,e=a.parseNumberArray(a.flatten(e)),r=a.parseNumber(r),a.anyIsError(e,r))return n.value;for(var t=function(e,r,t){for(var n=t+1,i=e[0],a=1;a<e.length;a++)i+=e[a]/Math.pow(n,(r[a]-r[0])/365);return i},i=function(e,r,t){for(var n=t+1,i=0,a=1;a<e.length;a++){var o=(r[a]-r[0])/365;i-=o*e[a]/Math.pow(n,o+1)}return i},o=[],u=!1,s=!1,l=0;l<e.length;l++)o[l]=0===l?0:o[l-1]+365,e[l]>0&&(u=!0),e[l]<0&&(s=!0);if(!u||!s)return n.num;r=void 0===r?.1:r;var c,f,h,p=r,m=1e-10,d=!0;do h=t(e,o,p),c=p-h/i(e,o,p),f=Math.abs(c-p),p=c,d=f>m&&Math.abs(h)>m;while(d);return p},exports.ISPMT=function(e,r,t,i){return e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),i=a.parseNumber(i),a.anyIsError(e,r,t,i)?n.value:i*e*(r/t-1)},exports.MDURATION=function(){throw new Error("MDURATION is not implemented")},exports.MIRR=function(e,r,t){if(e=a.parseNumberArray(a.flatten(e)),r=a.parseNumber(r),t=a.parseNumber(t),a.anyIsError(e,r,t))return n.value;for(var i=e.length,o=[],u=[],s=0;s<i;s++)e[s]<0?o.push(e[s]):u.push(e[s]);var l=-exports.NPV(t,u)*Math.pow(1+t,i-1),c=exports.NPV(r,o)*(1+r);return Math.pow(l/c,1/(i-1))-1},exports.NOMINAL=function(e,r){return e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(e,r)?n.value:e<=0||r<1?n.num:(r=parseInt(r,10),(Math.pow(e+1,1/r)-1)*r)},exports.NPER=function(e,r,t,i,o){if(o=void 0===o?0:o,i=void 0===i?0:i,e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,r,t,i,o))return n.value;var u=r*(1+e*o)-i*e,s=t*e+r*(1+e*o);return Math.log(u/s)/Math.log(1+e)},exports.NPV=function(){var e=a.parseNumberArray(a.flatten(arguments));if(e instanceof Error)return e;for(var r=e[0],t=0,n=1;n<e.length;n++)t+=e[n]/Math.pow(1+r,n);return t},exports.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},exports.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},exports.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},exports.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},exports.PDURATION=function(e,r,t){return e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),a.anyIsError(e,r,t)?n.value:e<=0?n.num:(Math.log(t)-Math.log(r))/Math.log(1+e)},exports.PMT=function(e,r,t,i,o){if(i=i||0,o=o||0,e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,r,t,i,o))return n.value;var u;if(0===e)u=(t+i)/r;else{var s=Math.pow(1+e,r);u=1===o?(i*e/(s-1)+t*e/(1-1/s))/(1+e):i*e/(s-1)+t*e/(1-1/s)}return-u},exports.PPMT=function(e,r,t,i,o,u){return o=o||0,u=u||0,e=a.parseNumber(e),t=a.parseNumber(t),i=a.parseNumber(i),o=a.parseNumber(o),u=a.parseNumber(u),a.anyIsError(e,t,i,o,u)?n.value:exports.PMT(e,t,i,o,u)-exports.IPMT(e,r,t,i,o,u)},exports.PRICE=function(){throw new Error("PRICE is not implemented")},exports.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},exports.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},exports.PV=function(e,r,t,i,o){return i=i||0,o=o||0,e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,r,t,i,o)?n.value:0===e?-t*r-i:((1-Math.pow(1+e,r))/e*t*(1+e*o)-i)/Math.pow(1+e,r)},exports.RATE=function(e,r,t,i,o,u){if(u=void 0===u?.01:u,i=void 0===i?0:i,o=void 0===o?0:o,e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),i=a.parseNumber(i),o=a.parseNumber(o),u=a.parseNumber(u),a.anyIsError(e,r,t,i,o,u))return n.value;for(var s=1e-6,l=100,c=0,f=!1,h=u;c<l&&!f;){var p=Math.pow(h+1,e),m=Math.pow(h+1,e-1),d=i+p*t+r*(p-1)*(h*o+1)/h,v=e*m*t-r*(p-1)*(h*o+1)/Math.pow(h,2),g=e*r*m*(h*o+1)/h+r*(p-1)*o/h,y=h-d/(v+g);Math.abs(y-h)<s&&(f=!0),c++,h=y}return f?h:Number.NaN+h},exports.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},exports.RRI=function(e,r,t){return e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),a.anyIsError(e,r,t)?n.value:0===e||0===r?n.num:Math.pow(t/r,1/e)-1},exports.SLN=function(e,r,t){return e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),a.anyIsError(e,r,t)?n.value:0===t?n.num:(e-r)/t},exports.SYD=function(e,r,t,i){return e=a.parseNumber(e),r=a.parseNumber(r),t=a.parseNumber(t),i=a.parseNumber(i),a.anyIsError(e,r,t,i)?n.value:0===t?n.num:i<1||i>t?n.num:(i=parseInt(i,10),(e-r)*(t-i+1)*2/(t*(t+1)))},exports.TBILLEQ=function(e,r,t){return e=a.parseDate(e),r=a.parseDate(r),t=a.parseNumber(t),a.anyIsError(e,r,t)?n.value:t<=0?n.num:e>r?n.num:r-e>31536e6?n.num:365*t/(360-t*i.DAYS360(e,r,!1))},exports.TBILLPRICE=function(e,r,t){return e=a.parseDate(e),r=a.parseDate(r),t=a.parseNumber(t),a.anyIsError(e,r,t)?n.value:t<=0?n.num:e>r?n.num:r-e>31536e6?n.num:100*(1-t*i.DAYS360(e,r,!1)/360)},exports.TBILLYIELD=function(e,r,t){return e=a.parseDate(e),r=a.parseDate(r),t=a.parseNumber(t),a.anyIsError(e,r,t)?n.value:t<=0?n.num:e>r?n.num:r-e>31536e6?n.num:360*(100-t)/(t*i.DAYS360(e,r,!1))},exports.VDB=function(){throw new Error("VDB is not implemented")},exports.XIRR=function(e,r,t){if(e=a.parseNumberArray(a.flatten(e)),r=a.parseDateArray(a.flatten(r)),t=a.parseNumber(t),a.anyIsError(e,r,t))return n.value;for(var o=function(e,r,t){for(var n=t+1,a=e[0],o=1;o<e.length;o++)a+=e[o]/Math.pow(n,i.DAYS(r[o],r[0])/365);return a},u=function(e,r,t){for(var n=t+1,a=0,o=1;o<e.length;o++){var u=i.DAYS(r[o],r[0])/365;a-=u*e[o]/Math.pow(n,u+1)}return a},s=!1,l=!1,c=0;c<e.length;c++)e[c]>0&&(s=!0),e[c]<0&&(l=!0);if(!s||!l)return n.num;t=t||.1;var f,h,p,m=t,d=1e-10,v=!0;do p=o(e,r,m),f=m-p/u(e,r,m),h=Math.abs(f-m),m=f,v=h>d&&Math.abs(p)>d;while(v);return m},exports.XNPV=function(e,r,t){if(e=a.parseNumber(e),r=a.parseNumberArray(a.flatten(r)),t=a.parseDateArray(a.flatten(t)),a.anyIsError(e,r,t))return n.value;for(var o=0,u=0;u<r.length;u++)o+=r[u]/Math.pow(1+e,i.DAYS(t[u],t[0])/365);return o},exports.YIELD=function(){throw new Error("YIELD is not implemented")},exports.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},exports.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(module,exports,e){var r=e(5);exports.MATCH=function(e,t,n){if(!e&&!t)return r.na;if(2===arguments.length&&(n=1),!(t instanceof Array))return r.na;if(n!==-1&&0!==n&&1!==n)return r.na;for(var i,a,o=0;o<t.length;o++)if(1===n){if(t[o]===e)return o+1;t[o]<e&&(a?t[o]>a&&(i=o+1,a=t[o]):(i=o+1,a=t[o]))}else if(0===n){if("string"==typeof e){if(e=e.replace(/\?/g,"."),t[o].toLowerCase().match(e.toLowerCase()))return o+1}else if(t[o]===e)return o+1}else if(n===-1){if(t[o]===e)return o+1;t[o]>e&&(a?t[o]<a&&(i=o+1,a=t[o]):(i=o+1,a=t[o]))}return i?i:r.na}}])})},{jStat:2,numeral:3,numeric:4}],2:[function(require,module,exports){this.j$=this.jStat=function(e,r){function t(r,t){var n=r>t?r:t;return e.pow(10,17-~~(e.log(n>0?n:-n)*e.LOG10E))}function n(e){return"[object Function]"===h.call(e)}function i(e){return"number"==typeof e&&e===e}function a(e){return c.apply([],e)}function o(){return new o._init(arguments)}function u(){return 0}function s(){return 1}function l(e,r){return e===r?1:0}var c=Array.prototype.concat,f=Array.prototype.slice,h=Object.prototype.toString,p=Array.isArray||function(e){return"[object Array]"===h.call(e)};o.fn=o.prototype,o._init=function(e){var r;if(p(e[0]))if(p(e[0][0])){for(n(e[1])&&(e[0]=o.map(e[0],e[1])),r=0;r<e[0].length;r++)this[r]=e[0][r];this.length=e[0].length}else this[0]=n(e[1])?o.map(e[0],e[1]):e[0],this.length=1;else if(i(e[0]))this[0]=o.seq.apply(null,e),this.length=1;else{if(e[0]instanceof o)return o(e[0].toArray());this[0]=[],this.length=1}return this},o._init.prototype=o.prototype,o._init.constructor=o,o.utils={calcRdx:t,isArray:p,isFunction:n,isNumber:i,toVector:a},o.extend=function(e){var r,t;if(1===arguments.length){for(t in e)o[t]=e[t];return this}for(r=1;r<arguments.length;r++)for(t in arguments[r])e[t]=arguments[r][t];return e},o.rows=function(e){return e.length||1},o.cols=function(e){return e[0].length||1},o.dimensions=function(e){return{rows:o.rows(e),cols:o.cols(e)}},o.row=function(e,r){return e[r]},o.col=function(e,r){for(var t=new Array(e.length),n=0;n<e.length;n++)t[n]=[e[n][r]];return t},o.diag=function(e){for(var r=o.rows(e),t=new Array(r),n=0;n<r;n++)t[n]=[e[n][n]];return t},o.antidiag=function(e){for(var r=o.rows(e)-1,t=new Array(r),n=0;r>=0;r--,n++)t[n]=[e[n][r]];return t},o.transpose=function(e){var r,t,n,i,a,o=[];for(p(e[0])||(e=[e]),t=e.length,n=e[0].length,a=0;a<n;a++){for(r=new Array(t),i=0;i<t;i++)r[i]=e[i][a];o.push(r)}return 1===o.length?o[0]:o},o.map=function(e,r,t){var n,i,a,o,u;for(p(e[0])||(e=[e]),i=e.length,a=e[0].length,o=t?e:new Array(i),n=0;n<i;n++)for(o[n]||(o[n]=new Array(a)),u=0;u<a;u++)o[n][u]=r(e[n][u],n,u);return 1===o.length?o[0]:o},o.alter=function(e,r){return o.map(e,r,!0)},o.create=function(e,r,t){var i,a,o=new Array(e);for(n(r)&&(t=r,r=e),i=0;i<e;i++)for(o[i]=new Array(r),a=0;a<r;a++)o[i][a]=t(i,a);return o},o.zeros=function(e,r){return i(r)||(r=e),o.create(e,r,u)},o.ones=function(e,r){return i(r)||(r=e),o.create(e,r,s)},o.rand=function(r,t){return i(t)||(t=r),o.create(r,t,e.random)},o.identity=function(e,r){return i(r)||(r=e),o.create(e,r,l)},o.symmetric=function(e){var r,t,n=e.length;if(e.length!==e[0].length)return!1;for(r=0;r<n;r++)for(t=0;t<n;t++)if(e[t][r]!==e[r][t])return!1;return!0},o.clear=function(e){return o.alter(e,u)},o.seq=function(e,r,i,a){n(a)||(a=!1);var o,u=[],s=t(e,r),l=(r*s-e*s)/((i-1)*s),c=e;for(o=0;c<=r;o++,c=(e*s+l*s*o)/s)u.push(a?a(c,o):c);return u};var m=o.prototype;return m.length=0,m.push=Array.prototype.push,m.sort=Array.prototype.sort,m.splice=Array.prototype.splice,m.slice=Array.prototype.slice,m.toArray=function(){return this.length>1?f.call(this):f.call(this)[0]},m.map=function(e,r){return o(o.map(this,e,r))},m.alter=function(e){return o.alter(this,e),this},function(e){for(var r=0;r<e.length;r++)(function(e){m[e]=function(r){var t,n=this;return r?(setTimeout(function(){r.call(n,m[e].call(n))}),this):(t=o[e](this),p(t)?o(t):t)}})(e[r])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var r=0;r<e.length;r++)(function(e){m[e]=function(r,t){var n=this;return t?(setTimeout(function(){t.call(n,m[e].call(n,r))}),this):o(o[e](this,r))}})(e[r])}("row col".split(" ")),function(e){for(var r=0;r<e.length;r++)(function(e){m[e]=new Function("return jStat(jStat."+e+".apply(null, arguments));")})(e[r])}("create zeros ones rand identity".split(" ")),o}(Math),function(e,r){function t(e,r){return e-r}function n(e,t,n){return r.max(t,r.min(e,n))}var i=e.utils.isFunction;e.sum=function e(r){for(var e=0,t=r.length;--t>=0;)e+=r[t];return e},e.sumsqrd=function(e){for(var r=0,t=e.length;--t>=0;)r+=e[t]*e[t];return r},e.sumsqerr=function(r){for(var t,n=e.mean(r),i=0,a=r.length;--a>=0;)t=r[a]-n,i+=t*t;return i},e.product=function(e){for(var r=1,t=e.length;--t>=0;)r*=e[t];return r},e.min=function(e){for(var r=e[0],t=0;++t<e.length;)e[t]<r&&(r=e[t]);return r},e.max=function(e){for(var r=e[0],t=0;++t<e.length;)e[t]>r&&(r=e[t]);return r},e.mean=function(r){return e.sum(r)/r.length},e.meansqerr=function(r){return e.sumsqerr(r)/r.length},e.geomean=function(t){return r.pow(e.product(t),1/t.length)},e.median=function(e){var r=e.length,n=e.slice().sort(t);return 1&r?n[r/2|0]:(n[r/2-1]+n[r/2])/2},e.cumsum=function(e){var r,t=e.length,n=new Array(t);for(n[0]=e[0],r=1;r<t;r++)n[r]=n[r-1]+e[r];return n},e.diff=function(e){var r,t=[],n=e.length;for(r=1;r<n;r++)t.push(e[r]-e[r-1]);return t},e.mode=function(e){var r,n=e.length,i=e.slice().sort(t),a=1,o=0,u=0,s=[];for(r=0;r<n;r++)i[r]===i[r+1]?a++:(a>o?(s=[i[r]],o=a,u=0):a===o&&(s.push(i[r]),u++),a=1);return 0===u?s[0]:s},e.range=function(r){return e.max(r)-e.min(r)},e.variance=function(r,t){return e.sumsqerr(r)/(r.length-(t?1:0))},e.stdev=function(t,n){return r.sqrt(e.variance(t,n))},e.meandev=function(t){var n,i=0,a=e.mean(t);for(n=t.length-1;n>=0;n--)i+=r.abs(t[n]-a);return i/t.length},e.meddev=function(t){var n,i=0,a=e.median(t);for(n=t.length-1;n>=0;n--)i+=r.abs(t[n]-a);return i/t.length},e.coeffvar=function(r){return e.stdev(r)/e.mean(r)},e.quartiles=function(e){var n=e.length,i=e.slice().sort(t);return[i[r.round(n/4)-1],i[r.round(n/2)-1],i[r.round(3*n/4)-1]]},e.quantiles=function(e,i,a,o){var u,s,l,c,f,h,p=e.slice().sort(t),m=[i.length],d=e.length;for("undefined"==typeof a&&(a=3/8),"undefined"==typeof o&&(o=3/8),u=0;u<i.length;u++)s=i[u],l=a+s*(1-a-o),c=d*s+l,f=r.floor(n(c,1,d-1)),h=n(c-f,0,1),m[u]=(1-h)*p[f-1]+h*p[f];return m},e.percentileOfScore=function(e,r,t){var n,i,a=0,o=e.length,u=!1;for("strict"===t&&(u=!0),i=0;i<o;i++)n=e[i],(u&&n<r||!u&&n<=r)&&a++;return a/o},e.covariance=function(r,t){var n,i=e.mean(r),a=e.mean(t),o=r.length,u=new Array(o);for(n=0;n<o;n++)u[n]=(r[n]-i)*(t[n]-a);return e.sum(u)/(o-1)},e.corrcoeff=function(r,t){return e.covariance(r,t)/e.stdev(r,1)/e.stdev(t,1)};var a=e.prototype;a.cumsum=function(r,t){var n=[],o=0,u=this;if(i(r)&&(t=r,r=!1),t)return setTimeout(function(){t.call(u,a.cumsum.call(u,r))}),this;if(this.length>1){for(u=r===!0?this:this.transpose();o<u.length;o++)n[o]=e.cumsum(u[o]);return n}return e.cumsum(this[0],r)},function(r){for(var t=0;t<r.length;t++)(function(r){a[r]=function(t,n){var o=[],u=0,s=this;if(i(t)&&(n=t,t=!1),n)return setTimeout(function(){n.call(s,a[r].call(s,t))}),this;if(this.length>1){for(s=t===!0?this:this.transpose();u<s.length;u++)o[u]=e[r](s[u]);return t===!0?e[r](e.utils.toVector(o)):o}return e[r](this[0],t)}})(r[t])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),function(r){for(var t=0;t<r.length;t++)(function(r){a[r]=function(){var t=[],n=0,o=this,u=Array.prototype.slice.call(arguments);if(i(u[u.length-1])){var s=u[u.length-1],l=u.slice(0,u.length-1);return setTimeout(function(){s.call(o,a[r].apply(o,l))}),this}var s=void 0,c=function(t){return e[r].apply(o,[t].concat(u))};if(this.length>1){for(o=o.transpose();n<o.length;n++)t[n]=c(o[n]);return t}return c(this[0])}})(r[t])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(e,r){e.gammaln=function(e){var t,n,i,a=0,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],u=1.000000000190015;for(i=(n=t=e)+5.5,i-=(t+.5)*r.log(i);a<6;a++)u+=o[a]/++n;return r.log(2.5066282746310007*u/t)-i},e.gammafn=function(e){var t,n,i,a,o=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],u=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],s=!1,l=0,c=0,f=0,h=e;if(h<=0){if(a=h%1+3.6e-16,!a)return 1/0;s=(1&h?-1:1)*r.PI/r.sin(r.PI*a),h=1-h}for(i=h,n=h<1?h++:(h-=l=(0|h)-1)-1,t=0;t<8;++t)f=(f+o[t])*n,c=c*n+u[t];if(a=f/c+1,i<h)a/=i;else if(i>h)for(t=0;t<l;++t)a*=h,h++;return s&&(a=s/a),a},e.gammap=function(t,n){var i,a=e.gammaln(t),o=t,u=1/t,s=u,l=n+1-t,c=1/1e-30,f=1/l,h=f,p=1,m=-~(8.5*r.log(t>=1?t:1/t)+.4*t+17);if(n<0||t<=0)return NaN;if(n<t+1){for(;p<=m;p++)u+=s*=n/++o;return u*r.exp(-n+t*r.log(n)-a)}for(;p<=m;p++)i=-p*(p-t),l+=2,f=i*f+l,c=l+i/c,f=1/f,h*=f*c;return 1-h*r.exp(-n+t*r.log(n)-a)},e.factorialln=function(r){return r<0?NaN:e.gammaln(r+1)},e.factorial=function(r){return r<0?NaN:e.gammafn(r+1)},e.combination=function(t,n){return t>170||n>170?r.exp(e.combinationln(t,n)):e.factorial(t)/e.factorial(n)/e.factorial(t-n)},e.combinationln=function(r,t){return e.factorialln(r)-e.factorialln(t)-e.factorialln(r-t)},e.permutation=function(r,t){return e.factorial(r)/e.factorial(r-t)},e.betafn=function(t,n){if(!(t<=0||n<=0))return t+n>170?r.exp(e.betaln(t,n)):e.gammafn(t)*e.gammafn(n)/e.gammafn(t+n)},e.betaln=function(r,t){return e.gammaln(r)+e.gammaln(t)-e.gammaln(r+t)},e.betacf=function(e,t,n){var i,a,o,u,s=1e-30,l=1,c=t+n,f=t+1,h=t-1,p=1,m=1-c*e/f;for(r.abs(m)<s&&(m=s),m=1/m,u=m;l<=100&&(i=2*l,a=l*(n-l)*e/((h+i)*(t+i)),m=1+a*m,r.abs(m)<s&&(m=s),p=1+a/p,r.abs(p)<s&&(p=s),m=1/m,u*=m*p,a=-(t+l)*(c+l)*e/((t+i)*(f+i)),m=1+a*m,r.abs(m)<s&&(m=s),p=1+a/p,r.abs(p)<s&&(p=s),m=1/m,o=m*p,u*=o,!(r.abs(o-1)<3e-7));l++);return u},e.gammapinv=function(t,n){var i,a,o,u,s,l,c,f=0,h=n-1,p=1e-8,m=e.gammaln(n);if(t>=1)return r.max(100,n+100*r.sqrt(n));if(t<=0)return 0;for(n>1?(l=r.log(h),c=r.exp(h*(l-1)-m),s=t<.5?t:1-t,o=r.sqrt(-2*r.log(s)),i=(2.30753+.27061*o)/(1+o*(.99229+.04481*o))-o,t<.5&&(i=-i),i=r.max(.001,n*r.pow(1-1/(9*n)-i/(3*r.sqrt(n)),3))):(o=1-n*(.253+.12*n),i=t<o?r.pow(t/o,1/n):1-r.log(1-(t-o)/(1-o)));f<12;f++){if(i<=0)return 0;if(a=e.gammap(n,i)-t,o=n>1?c*r.exp(-(i-h)+h*(r.log(i)-l)):r.exp(-i+h*r.log(i)-m),u=a/o,i-=o=u/(1-.5*r.min(1,u*((n-1)/i-1))),i<=0&&(i=.5*(i+o)),r.abs(o)<p*i)break}return i},e.erf=function(e){var t,n,i,a,o=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],u=o.length-1,s=!1,l=0,c=0;for(e<0&&(e=-e,s=!0),t=2/(2+e),n=4*t-2;u>0;u--)i=l,l=n*l-c+o[u],c=i;return a=t*r.exp(-e*e+.5*(o[0]+n*l)-c),s?a-1:1-a},e.erfc=function(r){return 1-e.erf(r)},e.erfcinv=function(t){var n,i,a,o,u=0;if(t>=2)return-100;if(t<=0)return 100;for(o=t<1?t:2-t,a=r.sqrt(-2*r.log(o/2)),n=-.70711*((2.30753+.27061*a)/(1+a*(.99229+.04481*a))-a);u<2;u++)i=e.erfc(n)-o,n+=i/(1.1283791670955126*r.exp(-n*n)-n*i);return t<1?n:-n},e.ibetainv=function(t,n,i){var a,o,u,s,l,c,f,h,p,m,d,v=1e-8,g=n-1,y=i-1,b=0;if(t<=0)return 0;if(t>=1)return 1;for(n>=1&&i>=1?(u=t<.5?t:1-t,s=r.sqrt(-2*r.log(u)),f=(2.30753+.27061*s)/(1+s*(.99229+.04481*s))-s,t<.5&&(f=-f),h=(f*f-3)/6,p=2/(1/(2*n-1)+1/(2*i-1)),m=f*r.sqrt(h+p)/p-(1/(2*i-1)-1/(2*n-1))*(h+5/6-2/(3*p)),f=n/(n+i*r.exp(2*m))):(a=r.log(n/(n+i)),o=r.log(i/(n+i)),s=r.exp(n*a)/n,l=r.exp(i*o)/i,m=s+l,f=t<s/m?r.pow(n*m*t,1/n):1-r.pow(i*m*(1-t),1/i)),d=-e.gammaln(n)-e.gammaln(i)+e.gammaln(n+i);b<10;b++){if(0===f||1===f)return f;if(c=e.ibeta(f,n,i)-t,s=r.exp(g*r.log(f)+y*r.log(1-f)+d),l=c/s,f-=s=l/(1-.5*r.min(1,l*(g/f-y/(1-f)))),f<=0&&(f=.5*(f+s)),f>=1&&(f=.5*(f+s+1)),r.abs(s)<v*f&&b>0)break}return f},e.ibeta=function(t,n,i){var a=0===t||1===t?0:r.exp(e.gammaln(n+i)-e.gammaln(n)-e.gammaln(i)+n*r.log(t)+i*r.log(1-t));return!(t<0||t>1)&&(t<(n+1)/(n+i+2)?a*e.betacf(t,n,i)/n:1-a*e.betacf(1-t,i,n)/i)},e.randn=function(t,n){var i,a,o,u,s;if(n||(n=t),t)return e.create(t,n,function(){return e.randn()});do i=r.random(),a=1.7156*(r.random()-.5),o=i-.449871,u=r.abs(a)+.386595,s=o*o+u*(.196*u-.25472*o);while(s>.27597&&(s>.27846||a*a>-4*r.log(i)*i*i));return a/i},e.randg=function(t,n,i){var a,o,u,s,l,c,f=t;if(i||(i=n),t||(t=1),n)return c=e.zeros(n,i),c.alter(function(){return e.randg(t)}),c;t<1&&(t+=1),a=t-1/3,o=1/r.sqrt(9*a);do{do l=e.randn(),s=1+o*l;while(s<=0);s=s*s*s,u=r.random()}while(u>1-.331*r.pow(l,4)&&r.log(u)>.5*l*l+a*(1-s+r.log(s)));if(t==f)return a*s;do u=r.random();while(0===u);return r.pow(u,1/f)*a*s},function(r){for(var t=0;t<r.length;t++)(function(r){e.fn[r]=function(){return e(e.map(this,function(t){return e[r](t)}))}})(r[t])}("gammaln gammafn factorial factorialln".split(" ")),function(r){for(var t=0;t<r.length;t++)(function(r){e.fn[r]=function(){return e(e[r].apply(null,arguments))}})(r[t])}("randn".split(" "))}(this.jStat,Math),function(e,r){!function(r){for(var t=0;t<r.length;t++)(function(r){e[r]=function(e,r,t){return this instanceof arguments.callee?(this._a=e,this._b=r,this._c=t,this):new arguments.callee(e,r,t)},e.fn[r]=function(t,n,i){var a=e[r](t,n,i);return a.data=this,a},e[r].prototype.sample=function(t){var n=this._a,i=this._b,a=this._c;return t?e.alter(t,function(){return e[r].sample(n,i,a)}):e[r].sample(n,i,a)},function(t){for(var n=0;n<t.length;n++)(function(t){e[r].prototype[t]=function(n){var i=this._a,a=this._b,o=this._c;return n||0===n||(n=this.data),"number"!=typeof n?e.fn.map.call(n,function(n){return e[r][t](n,i,a,o)}):e[r][t](n,i,a,o)}})(t[n])}("pdf cdf inv".split(" ")),function(t){for(var n=0;n<t.length;n++)(function(t){e[r].prototype[t]=function(){return e[r][t](this._a,this._b,this._c)}})(t[n])}("mean median mode variance".split(" "))})(r[t])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),e.extend(e.beta,{pdf:function(t,n,i){return t>1||t<0?0:1==n&&1==i?1:n<512||i<512?r.pow(t,n-1)*r.pow(1-t,i-1)/e.betafn(n,i):r.exp((n-1)*r.log(t)+(i-1)*r.log(1-t)-e.betaln(n,i))},cdf:function(r,t,n){return r>1||r<0?1*(r>1):e.ibeta(r,t,n)},inv:function(r,t,n){return e.ibetainv(r,t,n)},mean:function(e,r){return e/(e+r)},median:function(e,r){throw new Error("median not yet implemented")},mode:function(e,t){return e*t/(r.pow(e+t,2)*(e+t+1))},sample:function(r,t){var n=e.randg(r);return n/(n+e.randg(t))},variance:function(e,t){return e*t/(r.pow(e+t,2)*(e+t+1))}}),e.extend(e.centralF,{pdf:function(t,n,i){if(!(t<0))return r.sqrt(r.pow(n*t,n)*r.pow(i,i)/r.pow(n*t+i,n+i))/(t*e.betafn(n/2,i/2))},cdf:function(r,t,n){return e.ibeta(t*r/(t*r+n),t/2,n/2)},inv:function(r,t,n){return n/(t*(1/e.ibetainv(r,t/2,n/2)-1))},mean:function(e,r){return r>2?r/(r-2):void 0},mode:function(e,r){return e>2?r*(e-2)/(e*(r+2)):void 0},sample:function(r,t){var n=2*e.randg(r/2),i=2*e.randg(t/2);return n/r/(i/t)},variance:function(e,r){if(!(r<=4))return 2*r*r*(e+r-2)/(e*(r-2)*(r-2)*(r-4))}}),e.extend(e.cauchy,{pdf:function(e,t,n){return n/(r.pow(e-t,2)+r.pow(n,2))/r.PI},cdf:function(e,t,n){return r.atan((e-t)/n)/r.PI+.5},inv:function(e,t,n){return t+n*r.tan(r.PI*(e-.5))},median:function(e,r){return e},mode:function(e,r){return e},sample:function(t,n){return e.randn()*r.sqrt(1/(2*e.randg(.5)))*n+t}}),e.extend(e.chisquare,{pdf:function(t,n){return r.exp((n/2-1)*r.log(t)-t/2-n/2*r.log(2)-e.gammaln(n/2))},cdf:function(r,t){return e.gammap(t/2,r/2)},inv:function(r,t){return 2*e.gammapinv(r,.5*t)},mean:function(e){return e},median:function(e){return e*r.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(r){return 2*e.randg(r/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,t){return e<0?0:t*r.exp(-t*e)},cdf:function(e,t){return e<0?0:1-r.exp(-t*e)},inv:function(e,t){return-r.log(1-e)/t},mean:function(e){return 1/e},median:function(e){return 1/e*r.log(2)},mode:function(e){return 0},sample:function(e){return-1/e*r.log(r.random())},variance:function(e){return r.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(t,n,i){return r.exp((n-1)*r.log(t)-t/i-e.gammaln(n)-n*r.log(i))},cdf:function(r,t,n){return e.gammap(t,r/n)},inv:function(r,t,n){return e.gammapinv(r,t)*n},mean:function(e,r){return e*r},mode:function(e,r){if(e>1)return(e-1)*r},sample:function(r,t){return e.randg(r)*t},variance:function(e,r){return e*r*r}}),e.extend(e.invgamma,{pdf:function(t,n,i){return r.exp(-(n+1)*r.log(t)-i/t-e.gammaln(n)+n*r.log(i))},cdf:function(r,t,n){return 1-e.gammap(t,n/r)},inv:function(r,t,n){return n/e.gammapinv(1-r,t)},mean:function(e,r){return e>1?r/(e-1):void 0},mode:function(e,r){return r/(e+1)},sample:function(r,t){return t/e.randg(r)},variance:function(e,r){if(!(e<=2))return r*r/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,t,n){return r.exp(r.log(t)+r.log(n)+(t-1)*r.log(e)+(n-1)*r.log(1-r.pow(e,t)))},cdf:function(e,t,n){return 1-r.pow(1-r.pow(e,t),n)},mean:function(r,t){return t*e.gammafn(1+1/r)*e.gammafn(t)/e.gammafn(1+1/r+t)},median:function(e,t){return r.pow(1-r.pow(2,-1/t),1/e)},mode:function(e,t){if(e>=1&&t>=1&&1!==e&&1!==t)return r.pow((e-1)/(e*t-1),1/e)},variance:function(e,r){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,t,n){return r.exp(-r.log(e)-.5*r.log(2*r.PI)-r.log(n)-r.pow(r.log(e)-t,2)/(2*n*n))},cdf:function(t,n,i){return.5+.5*e.erf((r.log(t)-n)/r.sqrt(2*i*i))},inv:function(t,n,i){return r.exp(-1.4142135623730951*i*e.erfcinv(2*t)+n)},mean:function(e,t){return r.exp(e+t*t/2)},median:function(e,t){return r.exp(e)},mode:function(e,t){return r.exp(e-t*t)},sample:function(t,n){return r.exp(e.randn()*n+t)},variance:function(e,t){return(r.exp(t*t)-1)*r.exp(2*e+t*t)}}),e.extend(e.normal,{pdf:function(e,t,n){return r.exp(-.5*r.log(2*r.PI)-r.log(n)-r.pow(e-t,2)/(2*n*n))},cdf:function(t,n,i){return.5*(1+e.erf((t-n)/r.sqrt(2*i*i)))},inv:function(r,t,n){return-1.4142135623730951*n*e.erfcinv(2*r)+t},mean:function(e,r){return e},median:function(e,r){return e},mode:function(e,r){return e},sample:function(r,t){return e.randn()*t+r},variance:function(e,r){return r*r}}),e.extend(e.pareto,{pdf:function(e,t,n){if(!(e<=t))return n*r.pow(t,n)/r.pow(e,n+1)},cdf:function(e,t,n){return 1-r.pow(t/e,n)},mean:function(e,t){if(!(t<=1))return t*r.pow(e,t)/(t-1)},median:function(e,t){return e*(t*r.SQRT2)},mode:function(e,r){return e},variance:function(e,t){if(!(t<=2))return e*e*t/(r.pow(t-1,2)*(t-2))}}),e.extend(e.studentt,{pdf:function(t,n){return e.gammafn((n+1)/2)/(r.sqrt(n*r.PI)*e.gammafn(n/2))*r.pow(1+t*t/n,-((n+1)/2))},cdf:function(t,n){var i=n/2;return e.ibeta((t+r.sqrt(t*t+n))/(2*r.sqrt(t*t+n)),i,i)},inv:function(t,n){var i=e.ibetainv(2*r.min(t,1-t),.5*n,.5);return i=r.sqrt(n*(1-i)/i),t>.5?i:-i},mean:function(e){return e>1?0:void 0},median:function(e){return 0},mode:function(e){return 0},sample:function(t){return e.randn()*r.sqrt(t/(2*e.randg(t/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,t,n){return e<0?0:n/t*r.pow(e/t,n-1)*r.exp(-r.pow(e/t,n))},cdf:function(e,t,n){return e<0?0:1-r.exp(-r.pow(e/t,n))},inv:function(e,t,n){return t*r.pow(-r.log(1-e),1/n)},mean:function(r,t){return r*e.gammafn(1+1/t)},median:function(e,t){return e*r.pow(r.log(2),1/t)},mode:function(e,t){if(!(t<=1))return e*r.pow((t-1)/t,1/t)},sample:function(e,t){return e*r.pow(-r.log(r.random()),1/t)},variance:function(t,n){return t*t*e.gammafn(1+2/n)-r.pow(this.mean(t,n),2)}}),e.extend(e.uniform,{pdf:function(e,r,t){return e<r||e>t?0:1/(t-r)},cdf:function(e,r,t){return e<r?0:e<t?(e-r)/(t-r):1},mean:function(e,r){return.5*(e+r)},median:function(r,t){return e.mean(r,t)},mode:function(e,r){throw new Error("mode is not yet implemented")},sample:function(e,t){return e/2+t/2+(t/2-e/2)*(2*r.random()-1)},variance:function(e,t){return r.pow(t-e,2)/12}}),e.extend(e.binomial,{pdf:function(t,n,i){return 0===i||1===i?n*i===t?1:0:e.combination(n,t)*r.pow(i,t)*r.pow(1-i,n-t)},cdf:function(r,t,n){var i=[],a=0;if(r<0)return 0;if(r<t){for(;a<=r;a++)i[a]=e.binomial.pdf(a,t,n);return e.sum(i)}return 1}}),e.extend(e.negbin,{pdf:function(t,n,i){return!(t!==t|0)&&(t<0?0:e.combination(t+n-1,n-1)*r.pow(1-i,t)*r.pow(i,n))},cdf:function(r,t,n){var i=0,a=0;if(r<0)return 0;for(;a<=r;a++)i+=e.negbin.pdf(a,t,n);return i}}),e.extend(e.hypgeom,{pdf:function(t,n,i,a){if(t!==t|0)return!1;if(t<0||t<i-(n-a))return 0;if(t>a||t>i)return 0;if(2*i>n)return 2*a>n?e.hypgeom.pdf(n-i-a+t,n,n-i,n-a):e.hypgeom.pdf(a-t,n,n-i,a);if(2*a>n)return e.hypgeom.pdf(i-t,n,i,n-a);if(i<a)return e.hypgeom.pdf(t,n,a,i);for(var o=1,u=0,s=0;s<t;s++){for(;o>1&&u<a;)o*=1-i/(n-u),u++;o*=(a-s)*(i-s)/((s+1)*(n-i-a+s+1))}for(;u<a;u++)o*=1-i/(n-u);return r.min(1,r.max(0,o))},cdf:function(t,n,i,a){if(t<0||t<i-(n-a))return 0;if(t>=a||t>=i)return 1;if(2*i>n)return 2*a>n?e.hypgeom.cdf(n-i-a+t,n,n-i,n-a):1-e.hypgeom.cdf(a-t-1,n,n-i,a);if(2*a>n)return 1-e.hypgeom.cdf(i-t-1,n,i,n-a);if(i<a)return e.hypgeom.cdf(t,n,a,i);for(var o=1,u=1,s=0,l=0;l<t;l++){for(;o>1&&s<a;){var c=1-i/(n-s);u*=c,o*=c,s++}u*=(a-l)*(i-l)/((l+1)*(n-i-a+l+1)),o+=u}for(;s<a;s++)o*=1-i/(n-s);return r.min(1,r.max(0,o))}}),e.extend(e.poisson,{pdf:function(t,n){return r.pow(n,t)*r.exp(-n)/e.factorial(t)},cdf:function(r,t){var n=[],i=0;if(r<0)return 0;for(;i<=r;i++)n.push(e.poisson.pdf(i,t));return e.sum(n)},mean:function(e){return e},variance:function(e){return e},sample:function(e){var t=1,n=0,i=r.exp(-e);do n++,t*=r.random();while(t>i);return n-1}}),e.extend(e.triangular,{pdf:function(e,r,t,n){return t<=r||n<r||n>t?void 0:e<r||e>t?0:e<=n?2*(e-r)/((t-r)*(n-r)):2*(t-e)/((t-r)*(t-n))},cdf:function(e,t,n,i){if(!(n<=t||i<t||i>n))return e<t?0:e<=i?r.pow(e-t,2)/((n-t)*(i-t)):1-r.pow(n-e,2)/((n-t)*(n-i))},mean:function(e,r,t){return(e+r+t)/3},median:function(e,t,n){return n<=(e+t)/2?t-r.sqrt((t-e)*(t-n))/r.sqrt(2):n>(e+t)/2?e+r.sqrt((t-e)*(n-e))/r.sqrt(2):void 0},mode:function(e,r,t){return t},sample:function(e,t,n){var i=r.random();return i<(n-e)/(t-e)?e+r.sqrt(i*(t-e)*(n-e)):t-r.sqrt((1-i)*(t-e)*(t-n))},variance:function(e,r,t){return(e*e+r*r+t*t-e*r-e*t-r*t)/18}})}(this.jStat,Math),function(e,r){var t=Array.prototype.push,n=e.utils.isArray;e.extend({add:function(r,t){return n(t)?(n(t[0])||(t=[t]),e.map(r,function(e,r,n){return e+t[r][n]})):e.map(r,function(e){return e+t})},subtract:function(r,t){return n(t)?(n(t[0])||(t=[t]),e.map(r,function(e,r,n){return e-t[r][n]||0})):e.map(r,function(e){return e-t})},divide:function(r,t){return n(t)?(n(t[0])||(t=[t]),e.multiply(r,e.inv(t))):e.map(r,function(e){return e/t})},multiply:function(r,t){var i,a,o,u,s=r.length,l=r[0].length,c=e.zeros(s,o=n(t)?t[0].length:l),f=0;if(n(t)){for(;f<o;f++)for(i=0;i<s;i++){for(u=0,a=0;a<l;a++)u+=r[i][a]*t[a][f];c[i][f]=u}return 1===s&&1===f?c[0][0]:c}return e.map(r,function(e){return e*t})},dot:function(r,t){n(r[0])||(r=[r]),n(t[0])||(t=[t]);for(var i,a,o=1===r[0].length&&1!==r.length?e.transpose(r):r,u=1===t[0].length&&1!==t.length?e.transpose(t):t,s=[],l=0,c=o.length,f=o[0].length;l<c;l++){for(s[l]=[],i=0,a=0;a<f;a++)i+=o[l][a]*u[l][a];s[l]=i}return 1===s.length?s[0]:s},pow:function(t,n){return e.map(t,function(e){return r.pow(e,n)})},abs:function(t){return e.map(t,function(e){return r.abs(e)})},norm:function(e,t){var i=0,a=0;for(isNaN(t)&&(t=2),n(e[0])&&(e=e[0]);a<e.length;a++)i+=r.pow(r.abs(e[a]),t);return r.pow(i,1/t)},angle:function(t,n){return r.acos(e.dot(t,n)/(e.norm(t)*e.norm(n)))},aug:function(e,r){for(var n=e.slice(),i=0;i<n.length;i++)t.apply(n[i],r[i]);return n},inv:function(r){for(var t,n=r.length,i=r[0].length,a=e.identity(n,i),o=e.gauss_jordan(r,a),u=[],s=0;s<n;s++)for(u[s]=[],t=i-1;t<o[0].length;t++)u[s][t-i]=o[s][t];return u},det:function(e){var r,t=e.length,n=2*t,i=new Array(n),a=t-1,o=n-1,u=a-t+1,s=o,l=0,c=0;if(2===t)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(;l<n;l++)i[l]=1;for(l=0;l<t;l++){for(r=0;r<t;r++)i[u<0?u+t:u]*=e[l][r],i[s<t?s+t:s]*=e[l][r],u++,s--;u=--a-t+1,s=--o}for(l=0;l<t;l++)c+=i[l];for(;l<n;l++)c-=i[l];return c},gauss_elimination:function(t,n){var i,a,o,u,s=0,l=0,c=t.length,f=t[0].length,h=1,p=0,m=[];for(t=e.aug(t,n),i=t[0].length;s<c;s++){for(a=t[s][s],l=s,u=s+1;u<f;u++)a<r.abs(t[u][s])&&(a=t[u][s],l=u);if(l!=s)for(u=0;u<i;u++)o=t[s][u],t[s][u]=t[l][u],t[l][u]=o;for(l=s+1;l<c;l++)for(h=t[l][s]/t[s][s],u=s;u<i;u++)t[l][u]=t[l][u]-h*t[s][u]}for(s=c-1;s>=0;s--){for(p=0,l=s+1;l<=c-1;l++)p=m[l]*t[s][l];m[s]=(t[s][i-1]-p)/t[s][s]}return m},gauss_jordan:function(t,n){for(var i=e.aug(t,n),a=i.length,o=i[0].length,u=0;u<a;u++){for(var s=u,l=u+1;l<a;l++)r.abs(i[l][u])>r.abs(i[s][u])&&(s=l);var f=i[u];i[u]=i[s],i[s]=f;for(var l=u+1;l<a;l++){c=i[l][u]/i[u][u];for(var h=u;h<o;h++)i[l][h]-=i[u][h]*c}}for(var u=a-1;u>=0;u--){c=i[u][u];for(var l=0;l<u;l++)for(var h=o-1;h>u-1;h--)i[l][h]-=i[u][h]*i[l][u]/c;i[u][u]/=c;for(var h=a;h<o;h++)i[u][h]/=c}return i},lu:function(e,r){throw new Error("lu not yet implemented")},cholesky:function(e,r){throw new Error("cholesky not yet implemented")},gauss_jacobi:function(t,n,i,a){for(var o,u,s,l,c=0,f=0,h=t.length,p=[],m=[],d=[];c<h;c++)for(p[c]=[],m[c]=[],d[c]=[],f=0;f<h;f++)c>f?(p[c][f]=t[c][f],m[c][f]=d[c][f]=0):c<f?(m[c][f]=t[c][f],p[c][f]=d[c][f]=0):(d[c][f]=t[c][f],p[c][f]=m[c][f]=0);
for(s=e.multiply(e.multiply(e.inv(d),e.add(p,m)),-1),u=e.multiply(e.inv(d),n),o=i,l=e.add(e.multiply(s,i),u),c=2;r.abs(e.norm(e.subtract(l,o)))>a;)o=l,l=e.add(e.multiply(s,o),u),c++;return l},gauss_seidel:function(t,n,i,a){for(var o,u,s,l,c,f=0,h=t.length,p=[],m=[],d=[];f<h;f++)for(p[f]=[],m[f]=[],d[f]=[],o=0;o<h;o++)f>o?(p[f][o]=t[f][o],m[f][o]=d[f][o]=0):f<o?(m[f][o]=t[f][o],p[f][o]=d[f][o]=0):(d[f][o]=t[f][o],p[f][o]=m[f][o]=0);for(l=e.multiply(e.multiply(e.inv(e.add(d,p)),m),-1),s=e.multiply(e.inv(e.add(d,p)),n),u=i,c=e.add(e.multiply(l,i),s),f=2;r.abs(e.norm(e.subtract(c,u)))>a;)u=c,c=e.add(e.multiply(l,u),s),f+=1;return c},SOR:function(t,n,i,a,o){for(var u,s,l,c,f,h=0,p=t.length,m=[],d=[],v=[];h<p;h++)for(m[h]=[],d[h]=[],v[h]=[],u=0;u<p;u++)h>u?(m[h][u]=t[h][u],d[h][u]=v[h][u]=0):h<u?(d[h][u]=t[h][u],m[h][u]=v[h][u]=0):(v[h][u]=t[h][u],m[h][u]=d[h][u]=0);for(c=e.multiply(e.inv(e.add(v,e.multiply(m,o))),e.subtract(e.multiply(v,1-o),e.multiply(d,o))),l=e.multiply(e.multiply(e.inv(e.add(v,e.multiply(m,o))),n),o),s=i,f=e.add(e.multiply(c,i),l),h=2;r.abs(e.norm(e.subtract(f,s)))>a;)s=f,f=e.add(e.multiply(c,s),l),h++;return f},householder:function(t){for(var n,i,a,o,u,s=t.length,l=t[0].length,c=0,f=[],h=[];c<s-1;c++){for(n=0,o=c+1;o<l;o++)n+=t[o][c]*t[o][c];for(u=t[c+1][c]>0?-1:1,n=u*r.sqrt(n),i=r.sqrt((n*n-t[c+1][c]*n)/2),f=e.zeros(s,1),f[c+1][0]=(t[c+1][c]-n)/(2*i),a=c+2;a<s;a++)f[a][0]=t[a][c]/(2*i);h=e.subtract(e.identity(s,l),e.multiply(e.multiply(f,e.transpose(f)),2)),t=e.multiply(h,e.multiply(t,h))}return t},QR:function(t,n){for(var i,a,o,u,s,l,c=t.length,f=t[0].length,h=0,p=[],m=[],d=[];h<c-1;h++){for(a=0,i=h+1;i<f;i++)a+=t[i][h]*t[i][h];for(s=t[h+1][h]>0?-1:1,a=s*r.sqrt(a),o=r.sqrt((a*a-t[h+1][h]*a)/2),p=e.zeros(c,1),p[h+1][0]=(t[h+1][h]-a)/(2*o),u=h+2;u<c;u++)p[u][0]=t[u][h]/(2*o);m=e.subtract(e.identity(c,f),e.multiply(e.multiply(p,e.transpose(p)),2)),t=e.multiply(m,t),n=e.multiply(m,n)}for(h=c-1;h>=0;h--){for(l=0,i=h+1;i<=f-1;i++)l=d[i]*t[h][i];d[h]=n[h][0]/t[h][h]}return d},jacobi:function(t){for(var n,i,a,o,u,s,l,c,f=1,h=0,p=t.length,m=e.identity(p,p),d=[];1===f;){for(h++,s=t[0][1],o=0,u=1,i=0;i<p;i++)for(a=0;a<p;a++)i!=a&&s<r.abs(t[i][a])&&(s=r.abs(t[i][a]),o=i,u=a);for(l=t[o][o]===t[u][u]?t[o][u]>0?r.PI/4:-r.PI/4:r.atan(2*t[o][u]/(t[o][o]-t[u][u]))/2,c=e.identity(p,p),c[o][o]=r.cos(l),c[o][u]=-r.sin(l),c[u][o]=r.sin(l),c[u][u]=r.cos(l),m=e.multiply(m,c),n=e.multiply(e.multiply(e.inv(c),t),c),t=n,f=0,i=1;i<p;i++)for(a=1;a<p;a++)i!=a&&r.abs(t[i][a])>.001&&(f=1)}for(i=0;i<p;i++)d.push(t[i][i]);return[m,d]},rungekutta:function(e,r,t,n,i,a){var o,u,s,l,c;if(2===a)for(;n<=t;)o=r*e(n,i),u=r*e(n+r,i+o),s=i+(o+u)/2,i=s,n+=r;if(4===a)for(;n<=t;)o=r*e(n,i),u=r*e(n+r/2,i+o/2),l=r*e(n+r/2,i+u/2),c=r*e(n+r,i+l),s=i+(o+2*u+2*l+c)/6,i=s,n+=r;return i},romberg:function(e,t,n,i){for(var a,o,u,s,l,c=0,f=(n-t)/2,h=[],p=[],m=[];c<i/2;){for(l=e(t),u=t,s=0;u<=n;u+=f,s++)h[s]=u;for(a=h.length,u=1;u<a-1;u++)l+=(u%2!==0?4:2)*e(h[u]);l=f/3*(l+e(n)),m[c]=l,f/=2,c++}for(o=m.length,a=1;1!==o;){for(u=0;u<o-1;u++)p[u]=(r.pow(4,a)*m[u+1]-m[u])/(r.pow(4,a)-1);o=p.length,m=p,p=[],a++}return m},richardson:function(e,t,n,i){function a(e,r){for(var t,n=0,i=e.length;n<i;n++)e[n]===r&&(t=n);return t}for(var o,u,s,l,c,f=(e.length,r.abs(n-e[a(e,n)+1])),h=0,p=[],m=[];i>=f;)o=a(e,n+i),u=a(e,n),p[h]=(t[o]-2*t[u]+t[2*u-o])/(i*i),i/=2,h++;for(l=p.length,s=1;1!=l;){for(c=0;c<l-1;c++)m[c]=(r.pow(4,s)*p[c+1]-p[c])/(r.pow(4,s)-1);l=m.length,p=m,m=[],s++}return p},simpson:function(e,r,t,n){for(var i,a=(t-r)/n,o=e(r),u=[],s=r,l=0,c=1;s<=t;s+=a,l++)u[l]=s;for(i=u.length;c<i-1;c++)o+=(c%2!==0?4:2)*e(u[c]);return a/3*(o+e(t))},hermite:function(e,r,t,n){for(var i,a=e.length,o=0,u=0,s=[],l=[],c=[],f=[];u<a;u++){for(s[u]=1,i=0;i<a;i++)u!=i&&(s[u]*=(n-e[i])/(e[u]-e[i]));for(l[u]=0,i=0;i<a;i++)u!=i&&(l[u]+=1/(e[u]-e[i]));c[u]=(1-2*(n-e[u])*l[u])*(s[u]*s[u]),f[u]=(n-e[u])*(s[u]*s[u]),o+=c[u]*r[u]+f[u]*t[u]}return o},lagrange:function(e,r,t){for(var n,i,a=0,o=0,u=e.length;o<u;o++){for(i=r[o],n=0;n<u;n++)o!=n&&(i*=(t-e[n])/(e[o]-e[n]));a+=i}return a},cubic_spline:function(r,t,n){for(var i,a=r.length,o=0,u=[],s=[],l=[],c=[],f=[],h=[],p=[];o<a-1;o++)f[o]=r[o+1]-r[o];for(l[0]=0,o=1;o<a-1;o++)l[o]=3/f[o]*(t[o+1]-t[o])-3/f[o-1]*(t[o]-t[o-1]);for(o=1;o<a-1;o++)u[o]=[],s[o]=[],u[o][o-1]=f[o-1],u[o][o]=2*(f[o-1]+f[o]),u[o][o+1]=f[o],s[o][0]=l[o];for(c=e.multiply(e.inv(u),s),i=0;i<a-1;i++)h[i]=(t[i+1]-t[i])/f[i]-f[i]*(c[i+1][0]+2*c[i][0])/3,p[i]=(c[i+1][0]-c[i][0])/(3*f[i]);for(i=0;i<a&&!(r[i]>n);i++);return i-=1,t[i]+(n-r[i])*h[i]+e.sq(n-r[i])*c[i]+(n-r[i])*e.sq(n-r[i])*p[i]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(r){var t,n,i=r.length,a=r[0].length,o=0,u=[],s=[],l=[],c=[],f=[],h=[],p=[],m=[],d=[],v=[];for(o=0;o<i;o++)u[o]=e.sum(r[o])/a;for(o=0;o<a;o++)for(p[o]=[],t=0;t<i;t++)p[o][t]=r[t][o]-u[t];for(p=e.transpose(p),o=0;o<i;o++)for(m[o]=[],t=0;t<i;t++)m[o][t]=e.dot([p[o]],[p[t]])/(a-1);for(l=e.jacobi(m),d=l[0],s=l[1],v=e.transpose(d),o=0;o<s.length;o++)for(t=o;t<s.length;t++)s[o]<s[t]&&(n=s[o],s[o]=s[t],s[t]=n,c=v[o],v[o]=v[t],v[t]=c);for(h=e.transpose(p),o=0;o<i;o++)for(f[o]=[],t=0;t<h.length;t++)f[o][t]=e.dot([v[o]],[h[t]]);return[r,s,v,f]}}),function(r){for(var t=0;t<r.length;t++)(function(r){e.fn[r]=function(t,n){var i=this;return n?(setTimeout(function(){n.call(i,e.fn[r].call(i,t))},15),this):"number"==typeof e[r](this,t)?e[r](this,t):e(e[r](this,t))}})(r[t])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),function(e,r){var t=[].slice,n=e.utils.isNumber;e.extend({zscore:function(){var r=t.call(arguments);return n(r[1])?(r[0]-r[1])/r[2]:(r[0]-e.mean(r[1]))/e.stdev(r[1],r[2])},ztest:function(){var i=t.call(arguments);if(4===i.length){if(n(i[1])){var a=e.zscore(i[0],i[1],i[2]);return 1===i[3]?e.normal.cdf(-r.abs(a),0,1):2*e.normal.cdf(-r.abs(a),0,1)}var a=i[0];return 1===i[2]?e.normal.cdf(-r.abs(a),0,1):2*e.normal.cdf(-r.abs(a),0,1)}var a=e.zscore(i[0],i[1],i[3]);return 1===i[1]?e.normal.cdf(-r.abs(a),0,1):2*e.normal.cdf(-r.abs(a),0,1)}}),e.extend(e.fn,{zscore:function(e,r){return(e-this.mean())/this.stdev(r)},ztest:function(t,n,i){var a=r.abs(this.zscore(t,i));return 1===n?e.normal.cdf(-a,0,1):2*e.normal.cdf(-a,0,1)}}),e.extend({tscore:function(){var n=t.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/r.sqrt(n[3])):(n[0]-e.mean(n[1]))/(e.stdev(n[1],!0)/r.sqrt(n[1].length))},ttest:function(){var i,a=t.call(arguments);return 5===a.length?(i=r.abs(e.tscore(a[0],a[1],a[2],a[3])),1===a[4]?e.studentt.cdf(-i,a[3]-1):2*e.studentt.cdf(-i,a[3]-1)):n(a[1])?(i=r.abs(a[0]),1==a[2]?e.studentt.cdf(-i,a[1]-1):2*e.studentt.cdf(-i,a[1]-1)):(i=r.abs(e.tscore(a[0],a[1])),1==a[2]?e.studentt.cdf(-i,a[1].length-1):2*e.studentt.cdf(-i,a[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/r.sqrt(this.cols()))},ttest:function(t,n){return 1===n?1-e.studentt.cdf(r.abs(this.tscore(t)),this.cols()-1):2*e.studentt.cdf(-r.abs(this.tscore(t)),this.cols()-1)}}),e.extend({anovafscore:function(){var n,i,a,o,u,s,l,c,f=t.call(arguments);if(1===f.length){for(u=new Array(f[0].length),l=0;l<f[0].length;l++)u[l]=f[0][l];f=u}if(2===f.length)return e.variance(f[0])/e.variance(f[1]);for(i=new Array,l=0;l<f.length;l++)i=i.concat(f[l]);for(a=e.mean(i),n=0,l=0;l<f.length;l++)n+=f[l].length*r.pow(e.mean(f[l])-a,2);for(n/=f.length-1,s=0,l=0;l<f.length;l++)for(o=e.mean(f[l]),c=0;c<f[l].length;c++)s+=r.pow(f[l][c]-o,2);return s/=i.length-f.length,n/s},anovaftest:function(){var r,i,a,o,u=t.call(arguments);if(n(u[0]))return 1-e.centralF.cdf(u[0],u[1],u[2]);for(anovafscore=e.anovafscore(u),r=u.length-1,a=0,o=0;o<u.length;o++)a+=u[o].length;return i=a-r-1,1-e.centralF.cdf(anovafscore,r,i)},ftest:function(r,t,n){return 1-e.centralF.cdf(r,t,n)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var r,t=0;for(r=0;r<this.length;r++)t+=this[r].length;return e.ftest(this.anovafscore(),this.length-1,t-this.length)}}),e.extend({normalci:function(){var n,i=t.call(arguments),a=new Array(2);return n=4===i.length?r.abs(e.normal.inv(i[1]/2,0,1)*i[2]/r.sqrt(i[3])):r.abs(e.normal.inv(i[1]/2,0,1)*e.stdev(i[2])/r.sqrt(i[2].length)),a[0]=i[0]-n,a[1]=i[0]+n,a},tci:function(){var n,i=t.call(arguments),a=new Array(2);return n=4===i.length?r.abs(e.studentt.inv(i[1]/2,i[3]-1)*i[2]/r.sqrt(i[3])):r.abs(e.studentt.inv(i[1]/2,i[2].length-1)*e.stdev(i[2],!0)/r.sqrt(i[2].length)),a[0]=i[0]-n,a[1]=i[0]+n,a},significant:function(e,r){return e<r}}),e.extend(e.fn,{normalci:function(r,t){return e.normalci(r,t,this.toArray())},tci:function(r,t){return e.tci(r,t,this.toArray())}})}(this.jStat,Math)},{}],3:[function(require,module,exports){(function(){function e(e){this._value=e}function r(e,r,t,n){var i,a,o=Math.pow(10,r);return a=(t(e*o)/o).toFixed(r),n&&(i=new RegExp("0{1,"+n+"}$"),a=a.replace(i,"")),a}function t(e,r,t){var n;return n=r.indexOf("$")>-1?i(e,r,t):r.indexOf("%")>-1?a(e,r,t):r.indexOf(":")>-1?o(e,r):s(e._value,r,t)}function n(e,r){var t,n,i,a,o,s=r,l=["KB","MB","GB","TB","PB","EB","ZB","YB"],c=!1;if(r.indexOf(":")>-1)e._value=u(r);else if(r===v)e._value=0;else{for("."!==m[d].delimiters.decimal&&(r=r.replace(/\./g,"").replace(m[d].delimiters.decimal,".")),t=new RegExp("[^a-zA-Z]"+m[d].abbreviations.thousand+"(?:\\)|(\\"+m[d].currency.symbol+")?(?:\\))?)?$"),n=new RegExp("[^a-zA-Z]"+m[d].abbreviations.million+"(?:\\)|(\\"+m[d].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+m[d].abbreviations.billion+"(?:\\)|(\\"+m[d].currency.symbol+")?(?:\\))?)?$"),a=new RegExp("[^a-zA-Z]"+m[d].abbreviations.trillion+"(?:\\)|(\\"+m[d].currency.symbol+")?(?:\\))?)?$"),o=0;o<=l.length&&!(c=r.indexOf(l[o])>-1&&Math.pow(1024,o+1));o++);e._value=(c?c:1)*(s.match(t)?Math.pow(10,3):1)*(s.match(n)?Math.pow(10,6):1)*(s.match(i)?Math.pow(10,9):1)*(s.match(a)?Math.pow(10,12):1)*(r.indexOf("%")>-1?.01:1)*((r.split("-").length+Math.min(r.split("(").length-1,r.split(")").length-1))%2?1:-1)*Number(r.replace(/[^0-9\.]+/g,"")),e._value=c?Math.ceil(e._value):e._value}return e._value}function i(e,r,t){var n,i,a=r.indexOf("$"),o=r.indexOf("("),u=r.indexOf("-"),l="";return r.indexOf(" $")>-1?(l=" ",r=r.replace(" $","")):r.indexOf("$ ")>-1?(l=" ",r=r.replace("$ ","")):r=r.replace("$",""),i=s(e._value,r,t),a<=1?i.indexOf("(")>-1||i.indexOf("-")>-1?(i=i.split(""),n=1,(a<o||a<u)&&(n=0),i.splice(n,0,m[d].currency.symbol+l),i=i.join("")):i=m[d].currency.symbol+l+i:i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,l+m[d].currency.symbol),i=i.join("")):i=i+l+m[d].currency.symbol,i}function a(e,r,t){var n,i="",a=100*e._value;return r.indexOf(" %")>-1?(i=" ",r=r.replace(" %","")):r=r.replace("%",""),n=s(a,r,t),n.indexOf(")")>-1?(n=n.split(""),n.splice(-1,0,i+"%"),n=n.join("")):n=n+i+"%",n}function o(e){var r=Math.floor(e._value/60/60),t=Math.floor((e._value-60*r*60)/60),n=Math.round(e._value-60*r*60-60*t);return r+":"+(t<10?"0"+t:t)+":"+(n<10?"0"+n:n)}function u(e){var r=e.split(":"),t=0;return 3===r.length?(t+=60*Number(r[0])*60,t+=60*Number(r[1]),t+=Number(r[2])):2===r.length&&(t+=60*Number(r[0]),t+=Number(r[1])),Number(t)}function s(e,t,n){var i,a,o,u,s,l,c=!1,f=!1,h=!1,p="",g=!1,y=!1,b=!1,E=!1,N=!1,M="",I="",S=Math.abs(e),x=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],A="",w=!1;if(0===e&&null!==v)return v;if(t.indexOf("(")>-1?(c=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(f=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1&&(g=t.indexOf("aK")>=0,y=t.indexOf("aM")>=0,b=t.indexOf("aB")>=0,E=t.indexOf("aT")>=0,N=g||y||b||E,t.indexOf(" a")>-1?(p=" ",t=t.replace(" a","")):t=t.replace("a",""),S>=Math.pow(10,12)&&!N||E?(p+=m[d].abbreviations.trillion,e/=Math.pow(10,12)):S<Math.pow(10,12)&&S>=Math.pow(10,9)&&!N||b?(p+=m[d].abbreviations.billion,e/=Math.pow(10,9)):S<Math.pow(10,9)&&S>=Math.pow(10,6)&&!N||y?(p+=m[d].abbreviations.million,e/=Math.pow(10,6)):(S<Math.pow(10,6)&&S>=Math.pow(10,3)&&!N||g)&&(p+=m[d].abbreviations.thousand,e/=Math.pow(10,3))),t.indexOf("b")>-1)for(t.indexOf(" b")>-1?(M=" ",t=t.replace(" b","")):t=t.replace("b",""),o=0;o<=x.length;o++)if(i=Math.pow(1024,o),a=Math.pow(1024,o+1),e>=i&&e<a){M+=x[o],i>0&&(e/=i);break}return t.indexOf("o")>-1&&(t.indexOf(" o")>-1?(I=" ",t=t.replace(" o","")):t=t.replace("o",""),I+=m[d].ordinal(e)),t.indexOf("[.]")>-1&&(h=!0,t=t.replace("[.]",".")),u=e.toString().split(".")[0],s=t.split(".")[1],l=t.indexOf(","),s?(s.indexOf("[")>-1?(s=s.replace("]",""),s=s.split("["),A=r(e,s[0].length+s[1].length,n,s[1].length)):A=r(e,s.length,n),u=A.split(".")[0],A=A.split(".")[1].length?m[d].delimiters.decimal+A.split(".")[1]:"",h&&0===Number(A.slice(1))&&(A="")):u=r(e,null,n),u.indexOf("-")>-1&&(u=u.slice(1),w=!0),l>-1&&(u=u.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+m[d].delimiters.thousands)),0===t.indexOf(".")&&(u=""),(c&&w?"(":"")+(!c&&w?"-":"")+(!w&&f?"+":"")+u+A+(I?I:"")+(p?p:"")+(M?M:"")+(c&&w?")":"")}function l(e,r){m[e]=r}function c(e){var r=e.toString().split(".");return r.length<2?1:Math.pow(10,r[1].length)}function f(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,r){var t=c(e),n=c(r);return t>n?t:n},-(1/0))}var h,p="1.5.3",m={},d="en",v=null,g="0,0",y="undefined"!=typeof module&&module.exports;h=function(r){return h.isNumeral(r)?r=r.value():0===r||"undefined"==typeof r?r=0:Number(r)||(r=h.fn.unformat(r)),new e(Number(r))},h.version=p,h.isNumeral=function(r){return r instanceof e},h.language=function(e,r){if(!e)return d;if(e&&!r){if(!m[e])throw new Error("Unknown language : "+e);d=e}return!r&&m[e]||l(e,r),h},h.languageData=function(e){if(!e)return m[d];if(!m[e])throw new Error("Unknown language : "+e);return m[e]},h.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var r=e%10;return 1===~~(e%100/10)?"th":1===r?"st":2===r?"nd":3===r?"rd":"th"},currency:{symbol:"$"}}),h.zeroFormat=function(e){v="string"==typeof e?e:null},h.defaultFormat=function(e){g="string"==typeof e?e:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,r){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var t,n,i=this.length>>>0,a=!1;for(1<arguments.length&&(n=r,a=!0),t=0;i>t;++t)this.hasOwnProperty(t)&&(a?n=e(n,this[t],t,this):(n=this[t],a=!0));if(!a)throw new TypeError("Reduce of empty array with no initial value");return n}),h.fn=e.prototype={clone:function(){return h(this)},format:function(e,r){return t(this,e?e:g,void 0!==r?r:Math.round)},unformat:function(e){return"[object Number]"===Object.prototype.toString.call(e)?e:n(this,e?e:g)},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){function r(e,r,n,i){return e+t*r}var t=f.call(null,this._value,e);return this._value=[this._value,e].reduce(r,0)/t,this},subtract:function(e){function r(e,r,n,i){return e-t*r}var t=f.call(null,this._value,e);return this._value=[e].reduce(r,this._value*t)/t,this},multiply:function(e){function r(e,r,t,n){var i=f(e,r);return e*i*(r*i)/(i*i)}return this._value=[this._value,e].reduce(r,1),this},divide:function(e){function r(e,r,t,n){var i=f(e,r);return e*i/(r*i)}return this._value=[this._value,e].reduce(r),this},difference:function(e){return Math.abs(h(this._value).subtract(e).value())}},y&&(module.exports=h),"undefined"==typeof ender&&(this.numeral=h),"function"==typeof define&&define.amd&&define([],function(){return h})}).call(this)},{}],4:[function(require,module,exports){(function(global){"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,r){var t,n,i,a;for("undefined"==typeof r&&(r=15),i=.5,t=new Date;;){for(i*=2,a=i;a>3;a-=4)e(),e(),e(),e();for(;a>0;)e(),a--;if(n=new Date,n-t>r)break}for(a=i;a>3;a-=4)e(),e(),e(),e();for(;a>0;)e(),a--;return n=new Date,1e3*(3*i-1)/(n-t)},numeric._myIndexOf=function(e){var r,t=this.length;for(r=0;r<t;++r)if(this[r]===e)return r;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){function r(e){if(0===e)return"0";if(isNaN(e))return"NaN";if(e<0)return"-"+r(-e);if(isFinite(e)){var t=Math.floor(Math.log(e)/Math.log(10)),n=e/Math.pow(10,t),i=n.toPrecision(numeric.precision);return 10===parseFloat(i)&&(t++,n=1,i=n.toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+t.toString()}return"Infinity"}function t(e){var i;if("undefined"==typeof e)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof e)return n.push('"'+e+'"'),!1;if("boolean"==typeof e)return n.push(e.toString()),!1;if("number"==typeof e){var a=r(e),o=e.toPrecision(numeric.precision),u=parseFloat(e.toString()).toString(),s=[a,o,u,parseFloat(o).toString(),parseFloat(u).toString()];for(i=1;i<s.length;i++)s[i].length<a.length&&(a=s[i]);return n.push(Array(numeric.precision+8-a.length).join(" ")+a),!1}if(null===e)return n.push("null"),!1;if("function"==typeof e){n.push(e.toString());var l=!1;for(i in e)e.hasOwnProperty(i)&&(l?n.push(",\n"):n.push("\n{"),l=!0,n.push(i),n.push(": \n"),t(e[i]));return l&&n.push("}\n"),!0}if(e instanceof Array){if(e.length>numeric.largeArray)return n.push("...Large Array..."),!0;var l=!1;for(n.push("["),i=0;i<e.length;i++)i>0&&(n.push(","),l&&n.push("\n ")),l=t(e[i]);return n.push("]"),!0}n.push("{");var l=!1;for(i in e)e.hasOwnProperty(i)&&(l&&n.push(",\n"),l=!0,n.push(i),n.push(": \n"),t(e[i]));return n.push("}"),!0}var n=[];return t(e),n.join("")},numeric.parseDate=function(e){function r(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var t,n=[];for(t=0;t<e.length;t++)n[t]=r(e[t]);return n}return r(e)},numeric.parseFloat=function(e){function r(e){if("string"==typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var t,n=[];for(t=0;t<e.length;t++)n[t]=r(e[t]);return n}return r(e)},numeric.parseCSV=function(e){var r,t,n=e.split("\n"),i=[],a=/(([^'",]*)|('[^']*')|("[^"]*")),/g,o=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,u=function(e){return e.substr(0,e.length-1)},s=0;for(t=0;t<n.length;t++){var l,c=(n[t]+",").match(a);if(c.length>0){for(i[s]=[],r=0;r<c.length;r++)l=u(c[r]),o.test(l)?i[s][r]=parseFloat(l):i[s][r]=l;s++}}return i},numeric.toCSV=function(e){var r,t,n,i,a,o,u=numeric.dim(e);for(n=u[0],i=u[1],o=[],r=0;r<n;r++){for(a=[],t=0;t<n;t++)a[t]=e[r][t].toString();o[r]=a.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(e){var r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(),r},numeric.imageURL=function(e){function r(e){var r,t,n,i,a,o,u,s,l=e.length,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="";for(r=0;r<l;r+=3)t=e[r],n=e[r+1],i=e[r+2],a=t>>2,o=((3&t)<<4)+(n>>4),u=((15&n)<<2)+(i>>6),s=63&i,r+1>=l?u=s=64:r+2>=l&&(s=64),f+=c.charAt(a)+c.charAt(o)+c.charAt(u)+c.charAt(s);return f}function t(e,from,r){"undefined"==typeof from&&(from=0),"undefined"==typeof r&&(r=e.length);var t,n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],i=-1,a=0;e.length;for(t=from;t<r;t++)a=255&(i^e[t]),i=i>>>8^n[a];return i^-1}var n,i,a,o,u,s,l,c,f,h,p=e[0].length,m=e[0][0].length,d=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,m>>24&255,m>>16&255,m>>8&255,255&m,p>>24&255,p>>16&255,p>>8&255,255&p,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(h=t(d,12,29),d[29]=h>>24&255,d[30]=h>>16&255,d[31]=h>>8&255,d[32]=255&h,n=1,i=0,l=0;l<p;l++){for(l<p-1?d.push(0):d.push(1),u=3*m+1+(0===l)&255,s=3*m+1+(0===l)>>8&255,d.push(u),d.push(s),d.push(255&~u),d.push(255&~s),0===l&&d.push(0),c=0;c<m;c++)for(a=0;a<3;a++)u=e[a][l][c],u=u>255?255:u<0?0:Math.round(u),n=(n+u)%65521,i=(i+n)%65521,d.push(u);d.push(0)}return f=(i<<16)+n,d.push(f>>24&255),d.push(f>>16&255),d.push(f>>8&255),d.push(255&f),o=d.length-41,d[33]=o>>24&255,d[34]=o>>16&255,d[35]=o>>8&255,d[36]=255&o,h=t(d,37),d.push(h>>24&255),d.push(h>>16&255),d.push(h>>8&255),d.push(255&h),d.push(0),d.push(0),d.push(0),d.push(0),d.push(73),d.push(69),d.push(78),d.push(68),d.push(174),d.push(66),d.push(96),d.push(130),"data:image/png;base64,"+r(d)},numeric._dim=function(e){for(var r=[];"object"==typeof e;)r.push(e.length),e=e[0];return r},numeric.dim=function(e){var r,t;return"object"==typeof e?(r=e[0],"object"==typeof r?(t=r[0],"object"==typeof t?numeric._dim(e):[e.length,r.length]):[e.length]):[]},numeric.mapreduce=function(e,r){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+r+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,r){return Function("x","var n = x.length;\nvar i,xi;\n"+r+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(r,t){var n,i;if(!(r instanceof Array&&t instanceof Array))return!1;if(i=r.length,i!==t.length)return!1;for(n=0;n<i;n++)if(r[n]!==t[n]){if("object"!=typeof r[n])return!1;if(!e(r[n],t[n]))return!1}return!0},numeric.rep=function(e,r,t){"undefined"==typeof t&&(t=0);var n,i=e[t],a=Array(i);if(t===e.length-1){for(n=i-2;n>=0;n-=2)a[n+1]=r,a[n]=r;return n===-1&&(a[0]=r),a}for(n=i-1;n>=0;n--)a[n]=numeric.rep(e,r,t+1);return a},numeric.dotMMsmall=function(e,r){var t,n,i,a,o,u,s,l,c,f,h;for(a=e.length,o=r.length,u=r[0].length,s=Array(a),t=a-1;t>=0;t--){for(l=Array(u),c=e[t],i=u-1;i>=0;i--){for(f=c[o-1]*r[o-1][i],n=o-2;n>=1;n-=2)h=n-1,f+=c[n]*r[n][i]+c[h]*r[h][i];0===n&&(f+=c[0]*r[0][i]),l[i]=f}s[t]=l}return s},numeric._getCol=function(e,r,t){var n,i=e.length;for(n=i-1;n>0;--n)t[n]=e[n][r],--n,t[n]=e[n][r];0===n&&(t[0]=e[0][r])},numeric.dotMMbig=function(e,r){var t,n,i,a,o=numeric._getCol,u=r.length,s=Array(u),l=e.length,c=r[0].length,f=new Array(l),h=numeric.dotVV;for(--u,--l,n=l;n!==-1;--n)f[n]=Array(c);for(--c,n=c;n!==-1;--n)for(o(r,n,s),i=l;i!==-1;--i)a=0,t=e[i],f[i][n]=h(t,s);return f},numeric.dotMV=function(e,r){var t,n=e.length,i=(r.length,Array(n)),a=numeric.dotVV;for(t=n-1;t>=0;t--)i[t]=a(e[t],r);return i},numeric.dotVM=function(e,r){var t,n,i,a,o,u,s;for(i=e.length,a=r[0].length,o=Array(a),n=a-1;n>=0;n--){for(u=e[i-1]*r[i-1][n],t=i-2;t>=1;t-=2)s=t-1,u+=e[t]*r[t][n]+e[s]*r[s][n];0===t&&(u+=e[0]*r[0][n]),o[n]=u}return o},numeric.dotVV=function(e,r){var t,n,i=e.length,a=e[i-1]*r[i-1];for(t=i-2;t>=1;t-=2)n=t-1,a+=e[t]*r[t]+e[n]*r[n];return 0===t&&(a+=e[0]*r[0]),a},numeric.dot=function(e,r){var t=numeric.dim;switch(1e3*t(e).length+t(r).length){case 2002:return r.length<10?numeric.dotMMsmall(e,r):numeric.dotMMbig(e,r);case 2001:return numeric.dotMV(e,r);case 1002:return numeric.dotVM(e,r);case 1001:return numeric.dotVV(e,r);case 1e3:return numeric.mulVS(e,r);case 1:return numeric.mulSV(e,r);case 0:return e*r;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var r,t,n,i,a=e.length,o=Array(a);for(r=a-1;r>=0;r--){for(i=Array(a),t=r+2,n=a-1;n>=t;n-=2)i[n]=0,i[n-1]=0;for(n>r&&(i[n]=0),i[r]=e[r],n=r-1;n>=1;n-=2)i[n]=0,i[n-1]=0;0===n&&(i[0]=0),o[r]=i}return o},numeric.getDiag=function(e){var r,t=Math.min(e.length,e[0].length),n=Array(t);for(r=t-1;r>=1;--r)n[r]=e[r][r],--r,n[r]=e[r][r];return 0===r&&(n[0]=e[0][0]),n},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,r,t){"undefined"==typeof t&&(t="");var n,i,a=[],o=/\[i\]$/,u="",s=!1;for(n=0;n<e.length;n++)o.test(e[n])?(i=e[n].substring(0,e[n].length-3),u=i):i=e[n],"ret"===i&&(s=!0),a.push(i);return a[e.length]="_s",a[e.length+1]="_k",a[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+u+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(s?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+t+"\nfor(i=_n-1;i!==-1;--i) {\n    "+r+"\n}\nreturn ret;",Function.apply(null,a)},numeric.pointwise2=function(e,r,t){"undefined"==typeof t&&(t="");var n,i,a=[],o=/\[i\]$/,u="",s=!1;for(n=0;n<e.length;n++)o.test(e[n])?(i=e[n].substring(0,e[n].length-3),u=i):i=e[n],"ret"===i&&(s=!0),a.push(i);return a[e.length]="var _n = "+u+".length;\nvar i"+(s?"":", ret = Array(_n)")+";\n"+t+"\nfor(i=_n-1;i!==-1;--i) {\n"+r+"\n}\nreturn ret;",Function.apply(null,a)},numeric._biforeach=function e(r,t,n,i,a){if(i===n.length-1)return void a(r,t);var o,u=n[i];for(o=u-1;o>=0;o--)e("object"==typeof r?r[o]:r,"object"==typeof t?t[o]:t,n,i+1,a)},numeric._biforeach2=function e(r,t,n,i,a){if(i===n.length-1)return a(r,t);var o,u=n[i],s=Array(u);for(o=u-1;o>=0;--o)s[o]=e("object"==typeof r?r[o]:r,"object"==typeof t?t[o]:t,n,i+1,a);return s},numeric._foreach=function e(r,t,n,i){if(n===t.length-1)return void i(r);var a,o=t[n];for(a=o-1;a>=0;a--)e(r[a],t,n+1,i)},numeric._foreach2=function e(r,t,n,i){if(n===t.length-1)return i(r);var a,o=t[n],u=Array(o);for(a=o-1;a>=0;a--)u[a]=e(r[a],t,n+1,i);return u},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,r;for(e=0;e<numeric.mathfuns2.length;++e)r=numeric.mathfuns2[e],numeric.ops2[r]=r;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){r=numeric.ops2[e];var t,n,i="";numeric.myIndexOf.call(numeric.mathfuns2,e)!==-1?(i="var "+r+" = Math."+r+";\n",t=function(e,t,n){return e+" = "+r+"("+t+","+n+")"},n=function(e,t){return e+" = "+r+"("+e+","+t+")"}):(t=function(e,t,n){return e+" = "+t+" "+r+" "+n},n=numeric.opseq.hasOwnProperty(e+"eq")?function(e,t){return e+" "+r+"= "+t}:function(e,t){return e+" = "+e+" "+r+" "+t}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],t("ret[i]","x[i]","y[i]"),i),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],t("ret[i]","x","y[i]"),i),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],t("ret[i]","x[i]","y"),i),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+n("x","y")+"\n}\nreturn x;\n"),numeric[r]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],n("ret[i]","x[i]"),i),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],n("ret[i]","x"),i),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)r=numeric.mathfuns2[e],delete numeric.ops2[r];for(e=0;e<numeric.mathfuns.length;++e)r=numeric.mathfuns[e],numeric.ops1[r]=r;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(i="",r=numeric.ops1[e],numeric.myIndexOf.call(numeric.mathfuns,e)!==-1&&Math.hasOwnProperty(r)&&(i="var "+r+" = Math."+r+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+r+"(ret[i]);",i),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+r+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+r+"(x[i]);",i),numeric[e]=Function("x",'if(typeof x !== "object") return '+r+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));
for(e=0;e<numeric.mathfuns.length;++e)r=numeric.mathfuns[e],delete numeric.ops1[r];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(r=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(r[0],r[1]),numeric[e]=Function("x","s","k",r[1]+'if(typeof x !== "object") {    xi = x;\n'+r[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+r[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,r){return"object"==typeof e?"object"==typeof r?numeric.truncVV(e,r):numeric.truncVS(e,r):"object"==typeof r?numeric.truncSV(e,r):Math.round(e/r)*r},numeric.inv=function(e){var r,t,n,i,a,o,u,e,s=numeric.dim(e),l=Math.abs,c=s[0],f=s[1],h=numeric.clone(e),p=numeric.identity(c);for(o=0;o<f;++o){var m=-1,d=-1;for(a=o;a!==c;++a)u=l(h[a][o]),u>d&&(m=a,d=u);for(t=h[m],h[m]=h[o],h[o]=t,i=p[m],p[m]=p[o],p[o]=i,e=t[o],u=o;u!==f;++u)t[u]/=e;for(u=f-1;u!==-1;--u)i[u]/=e;for(a=c-1;a!==-1;--a)if(a!==o){for(r=h[a],n=p[a],e=r[o],u=o+1;u!==f;++u)r[u]-=t[u]*e;for(u=f-1;u>0;--u)n[u]-=i[u]*e,--u,n[u]-=i[u]*e;0===u&&(n[0]-=i[0]*e)}}return p},numeric.det=function(e){var r=numeric.dim(e);if(2!==r.length||r[0]!==r[1])throw new Error("numeric: det() only works on square matrices");var t,n,i,a,o,u,s,l,c=r[0],f=1,h=numeric.clone(e);for(n=0;n<c-1;n++){for(i=n,t=n+1;t<c;t++)Math.abs(h[t][n])>Math.abs(h[i][n])&&(i=t);for(i!==n&&(s=h[i],h[i]=h[n],h[n]=s,f*=-1),a=h[n],t=n+1;t<c;t++){for(o=h[t],u=o[n]/a[n],i=n+1;i<c-1;i+=2)l=i+1,o[i]-=a[i]*u,o[l]-=a[l]*u;i!==c&&(o[i]-=a[i]*u)}if(0===a[n])return 0;f*=a[n]}return f*h[n][n]},numeric.transpose=function(e){var r,t,n,i,a,o=e.length,u=e[0].length,s=Array(u);for(t=0;t<u;t++)s[t]=Array(o);for(r=o-1;r>=1;r-=2){for(i=e[r],n=e[r-1],t=u-1;t>=1;--t)a=s[t],a[r]=i[t],a[r-1]=n[t],--t,a=s[t],a[r]=i[t],a[r-1]=n[t];0===t&&(a=s[0],a[r]=i[0],a[r-1]=n[0])}if(0===r){for(n=e[0],t=u-1;t>=1;--t)s[t][0]=n[t],--t,s[t][0]=n[t];0===t&&(s[0][0]=n[0])}return s},numeric.negtranspose=function(e){var r,t,n,i,a,o=e.length,u=e[0].length,s=Array(u);for(t=0;t<u;t++)s[t]=Array(o);for(r=o-1;r>=1;r-=2){for(i=e[r],n=e[r-1],t=u-1;t>=1;--t)a=s[t],a[r]=-i[t],a[r-1]=-n[t],--t,a=s[t],a[r]=-i[t],a[r-1]=-n[t];0===t&&(a=s[0],a[r]=-i[0],a[r-1]=-n[0])}if(0===r){for(n=e[0],t=u-1;t>=1;--t)s[t][0]=-n[t],--t,s[t][0]=-n[t];0===t&&(s[0][0]=-n[0])}return s},numeric._random=function e(r,t){var n,i,a=r[t],o=Array(a);if(t===r.length-1){for(i=Math.random,n=a-1;n>=1;n-=2)o[n]=i(),o[n-1]=i();return 0===n&&(o[0]=i()),o}for(n=a-1;n>=0;n--)o[n]=e(r,t+1);return o},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,r,t){if("undefined"==typeof t&&(t=Math.max(Math.round(r-e)+1,1)),t<2)return 1===t?[e]:[];var n,i=Array(t);for(t--,n=t;n>=0;n--)i[n]=(n*r+(t-n)*e)/t;return i},numeric.getBlock=function(e,from,r){function t(e,i){var a,o=from[i],u=r[i]-o,s=Array(u);if(i===n.length-1){for(a=u;a>=0;a--)s[a]=e[a+o];return s}for(a=u;a>=0;a--)s[a]=t(e[a+o],i+1);return s}var n=numeric.dim(e);return t(e,0)},numeric.setBlock=function(e,from,r,t){function n(e,t,a){var o,u=from[a],s=r[a]-u;if(a===i.length-1)for(o=s;o>=0;o--)e[o+u]=t[o];for(o=s;o>=0;o--)n(e[o+u],t[o],a+1)}var i=numeric.dim(e);return n(e,t,0),e},numeric.getRange=function(e,r,t){var n,i,a,o,u=r.length,s=t.length,l=Array(u);for(n=u-1;n!==-1;--n)for(l[n]=Array(s),a=l[n],o=e[r[n]],i=s-1;i!==-1;--i)a[i]=o[t[i]];return l},numeric.blockMatrix=function(e){var r=numeric.dim(e);if(r.length<4)return numeric.blockMatrix([e]);var t,n,i,a,o,u=r[0],s=r[1];for(t=0,n=0,i=0;i<u;++i)t+=e[i][0].length;for(a=0;a<s;++a)n+=e[0][a][0].length;var l=Array(t);for(i=0;i<t;++i)l[i]=Array(n);var c,f,h,p,m,d=0;for(i=0;i<u;++i){for(c=n,a=s-1;a!==-1;--a)for(o=e[i][a],c-=o[0].length,h=o.length-1;h!==-1;--h)for(m=o[h],f=l[d+h],p=m.length-1;p!==-1;--p)f[c+p]=m[p];d+=e[i][0].length}return l},numeric.tensor=function(e,r){if("number"==typeof e||"number"==typeof r)return numeric.mul(e,r);var t=numeric.dim(e),n=numeric.dim(r);if(1!==t.length||1!==n.length)throw new Error("numeric: tensor product is only defined for vectors");var i,a,o,u,s=t[0],l=n[0],c=Array(s);for(a=s-1;a>=0;a--){for(i=Array(l),u=e[a],o=l-1;o>=3;--o)i[o]=u*r[o],--o,i[o]=u*r[o],--o,i[o]=u*r[o],--o,i[o]=u*r[o];for(;o>=0;)i[o]=u*r[o],--o;c[a]=i}return c},numeric.T=function(e,r){this.x=e,this.y=r},numeric.t=function(e,r){return new numeric.T(e,r)},numeric.Tbinop=function(e,r,t,n,i){numeric.indexOf;if("string"!=typeof i){var a;i="";for(a in numeric)numeric.hasOwnProperty(a)&&(e.indexOf(a)>=0||r.indexOf(a)>=0||t.indexOf(a)>=0||n.indexOf(a)>=0)&&a.length>1&&(i+="var "+a+" = numeric."+a+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+n+");\n  }\n  return new numeric.T("+t+");\n}\nif(y.y) {\n  return new numeric.T("+r+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,r=numeric.div;if(this.y){var t=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(r(this.x,t),r(numeric.neg(this.y),t))}return new T(r(1,this.x))},numeric.T.prototype.div=function e(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,r.x),e(this.y,r.x)):new numeric.T(e(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,r=this.x,t=this.y;return t?new numeric.T(e(r),e(t)):new numeric.T(e(r))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,r=this.x,t=this.y;return t?new numeric.T(e(r),numeric.negtranspose(t)):new numeric.T(e(r))},numeric.Tunop=function(e,r,t){return"string"!=typeof t&&(t=""),Function("var x = this;\n"+t+"\nif(x.y) {  "+r+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if("undefined"==typeof e.y)return new numeric.T(numeric.inv(e.x));var r,t,n,i,a,o,u,s,l,c,f,r,t,n,h,p,m,d,v,g,y,b=e.x.length,E=numeric.identity(b),N=numeric.rep([b,b],0),M=numeric.clone(e.x),I=numeric.clone(e.y);for(r=0;r<b;r++){for(m=M[r][r],d=I[r][r],h=m*m+d*d,n=r,t=r+1;t<b;t++)m=M[t][r],d=I[t][r],p=m*m+d*d,p>h&&(n=t,h=p);for(n!==r&&(y=M[r],M[r]=M[n],M[n]=y,y=I[r],I[r]=I[n],I[n]=y,y=E[r],E[r]=E[n],E[n]=y,y=N[r],N[r]=N[n],N[n]=y),i=M[r],a=I[r],s=E[r],l=N[r],m=i[r],d=a[r],t=r+1;t<b;t++)v=i[t],g=a[t],i[t]=(v*m+g*d)/h,a[t]=(g*m-v*d)/h;for(t=0;t<b;t++)v=s[t],g=l[t],s[t]=(v*m+g*d)/h,l[t]=(g*m-v*d)/h;for(t=r+1;t<b;t++){for(o=M[t],u=I[t],c=E[t],f=N[t],m=o[r],d=u[r],n=r+1;n<b;n++)v=i[n],g=a[n],o[n]-=v*m-g*d,u[n]-=g*m+v*d;for(n=0;n<b;n++)v=s[n],g=l[n],c[n]-=v*m-g*d,f[n]-=g*m+v*d}}for(r=b-1;r>0;r--)for(s=E[r],l=N[r],t=r-1;t>=0;t--)for(c=E[t],f=N[t],m=M[t][r],d=I[t][r],n=b-1;n>=0;n--)v=s[n],g=l[n],c[n]-=m*v-d*g,f[n]-=m*g+d*v;return new numeric.T(E,N)},numeric.T.prototype.get=function(e){var r,t=this.x,n=this.y,i=0,a=e.length;if(n){for(;i<a;)r=e[i],t=t[r],n=n[r],i++;return new numeric.T(t,n)}for(;i<a;)r=e[i],t=t[r],i++;return new numeric.T(t)},numeric.T.prototype.set=function(e,r){var t,n=this.x,i=this.y,a=0,o=e.length,u=r.x,s=r.y;if(0===o)return s?this.y=s:i&&(this.y=void 0),this.x=n,this;if(s){for(i||(i=numeric.rep(numeric.dim(n),0),this.y=i);a<o-1;)t=e[a],n=n[t],i=i[t],a++;return t=e[a],n[t]=u,i[t]=s,this}if(i){for(;a<o-1;)t=e[a],n=n[t],i=i[t],a++;return t=e[a],n[t]=u,u instanceof Array?i[t]=numeric.rep(numeric.dim(u),0):i[t]=0,this}for(;a<o-1;)t=e[a],n=n[t],a++;return t=e[a],n[t]=u,this},numeric.T.prototype.getRows=function(e,r){var t,n,i=r-e+1,a=Array(i),o=this.x,u=this.y;for(t=e;t<=r;t++)a[t-e]=o[t];if(u){for(n=Array(i),t=e;t<=r;t++)n[t-e]=u[t];return new numeric.T(a,n)}return new numeric.T(a)},numeric.T.prototype.setRows=function(e,r,t){var n,i=this.x,a=this.y,o=t.x,u=t.y;for(n=e;n<=r;n++)i[n]=o[n-e];if(u)for(a||(a=numeric.rep(numeric.dim(i),0),this.y=a),n=e;n<=r;n++)a[n]=u[n-e];else if(a)for(n=e;n<=r;n++)a[n]=numeric.rep([o[n-e].length],0);return this},numeric.T.prototype.getRow=function(e){var r=this.x,t=this.y;return t?new numeric.T(r[e],t[e]):new numeric.T(r[e])},numeric.T.prototype.setRow=function(e,r){var t=this.x,n=this.y,i=r.x,a=r.y;return t[e]=i,a?(n||(n=numeric.rep(numeric.dim(t),0),this.y=n),n[e]=a):n&&(n=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(from,e){var r=this.x,t=this.y,n=numeric.getBlock;return t?new numeric.T(n(r,from,e),n(t,from,e)):new numeric.T(n(r,from,e))},numeric.T.prototype.setBlock=function(from,e,r){r instanceof numeric.T||(r=new numeric.T(r));var t=this.x,n=this.y,i=numeric.setBlock,a=r.x,o=r.y;return o?(n||(this.y=numeric.rep(numeric.dim(this),0),n=this.y),i(t,from,e,a),i(n,from,e,o),this):(i(t,from,e,a),void(n&&i(n,from,e,numeric.rep(numeric.dim(a),0))))},numeric.T.rep=function(e,r){var t=numeric.T;r instanceof t||(r=new t(r));var n=r.x,i=r.y,a=numeric.rep;return i?new t(a(e,n),a(e,i)):new t(a(e,n))},numeric.T.diag=function e(r){r instanceof numeric.T||(r=new numeric.T(r));var t=r.x,n=r.y,e=numeric.diag;return n?new numeric.T(e(t),e(n)):new numeric.T(e(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,r=this.x,t=this.y;return t?new e.T(e.getDiag(r),e.getDiag(t)):new e.T(e.getDiag(r))},numeric.house=function(e){var r=numeric.clone(e),t=e[0]>=0?1:-1,n=t*numeric.norm2(e);r[0]+=n;var i=numeric.norm2(r);if(0===i)throw new Error("eig: internal error");return numeric.div(r,i)},numeric.toUpperHessenberg=function(e){var r=numeric.dim(e);if(2!==r.length||r[0]!==r[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var t,n,i,a,o,u,s,l,c,f,h=r[0],p=numeric.clone(e),m=numeric.identity(h);for(n=0;n<h-2;n++){for(a=Array(h-n-1),t=n+1;t<h;t++)a[t-n-1]=p[t][n];if(numeric.norm2(a)>0){for(o=numeric.house(a),u=numeric.getBlock(p,[n+1,n],[h-1,h-1]),s=numeric.tensor(o,numeric.dot(o,u)),t=n+1;t<h;t++)for(l=p[t],c=s[t-n-1],i=n;i<h;i++)l[i]-=2*c[i-n];for(u=numeric.getBlock(p,[0,n+1],[h-1,h-1]),s=numeric.tensor(numeric.dot(u,o),o),t=0;t<h;t++)for(l=p[t],c=s[t],i=n+1;i<h;i++)l[i]-=2*c[i-n-1];for(u=Array(h-n-1),t=n+1;t<h;t++)u[t-n-1]=m[t];for(s=numeric.tensor(o,numeric.dot(o,u)),t=n+1;t<h;t++)for(f=m[t],c=s[t-n-1],i=0;i<h;i++)f[i]-=2*c[i]}}return{H:p,Q:m}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(e,r){"undefined"==typeof r&&(r=1e4),e=numeric.clone(e);var t,n,i,a,o,u,s,l,c,f,h,p,m,d,v,g,y,b,E=(numeric.clone(e),numeric.dim(e)),N=E[0],M=numeric.identity(N);if(N<3)return{Q:M,B:[[0,N-1]]};var I=numeric.epsilon;for(b=0;b<r;b++){for(g=0;g<N-1;g++)if(Math.abs(e[g+1][g])<I*(Math.abs(e[g][g])+Math.abs(e[g+1][g+1]))){var S=numeric.QRFrancis(numeric.getBlock(e,[0,0],[g,g]),r),x=numeric.QRFrancis(numeric.getBlock(e,[g+1,g+1],[N-1,N-1]),r);for(p=Array(g+1),v=0;v<=g;v++)p[v]=M[v];for(m=numeric.dot(S.Q,p),v=0;v<=g;v++)M[v]=m[v];for(p=Array(N-g-1),v=g+1;v<N;v++)p[v-g-1]=M[v];for(m=numeric.dot(x.Q,p),v=g+1;v<N;v++)M[v]=m[v-g-1];return{Q:M,B:S.B.concat(numeric.add(x.B,g+1))}}if(i=e[N-2][N-2],a=e[N-2][N-1],o=e[N-1][N-2],u=e[N-1][N-1],l=i+u,s=i*u-a*o,c=numeric.getBlock(e,[0,0],[2,2]),l*l>=4*s){var A,w;A=.5*(l+Math.sqrt(l*l-4*s)),w=.5*(l-Math.sqrt(l*l-4*s)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,A+w)),numeric.diag(numeric.rep([3],A*w)))}else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,l)),numeric.diag(numeric.rep([3],s)));for(t=[c[0][0],c[1][0],c[2][0]],n=numeric.house(t),p=[e[0],e[1],e[2]],m=numeric.tensor(n,numeric.dot(n,p)),v=0;v<3;v++)for(h=e[v],d=m[v],y=0;y<N;y++)h[y]-=2*d[y];for(p=numeric.getBlock(e,[0,0],[N-1,2]),m=numeric.tensor(numeric.dot(p,n),n),v=0;v<N;v++)for(h=e[v],d=m[v],y=0;y<3;y++)h[y]-=2*d[y];for(p=[M[0],M[1],M[2]],m=numeric.tensor(n,numeric.dot(n,p)),v=0;v<3;v++)for(f=M[v],d=m[v],y=0;y<N;y++)f[y]-=2*d[y];var T;for(g=0;g<N-2;g++){for(y=g;y<=g+1;y++)if(Math.abs(e[y+1][y])<I*(Math.abs(e[y][y])+Math.abs(e[y+1][y+1]))){var S=numeric.QRFrancis(numeric.getBlock(e,[0,0],[y,y]),r),x=numeric.QRFrancis(numeric.getBlock(e,[y+1,y+1],[N-1,N-1]),r);for(p=Array(y+1),v=0;v<=y;v++)p[v]=M[v];for(m=numeric.dot(S.Q,p),v=0;v<=y;v++)M[v]=m[v];for(p=Array(N-y-1),v=y+1;v<N;v++)p[v-y-1]=M[v];for(m=numeric.dot(x.Q,p),v=y+1;v<N;v++)M[v]=m[v-y-1];return{Q:M,B:S.B.concat(numeric.add(x.B,y+1))}}for(T=Math.min(N-1,g+3),t=Array(T-g),v=g+1;v<=T;v++)t[v-g-1]=e[v][g];for(n=numeric.house(t),p=numeric.getBlock(e,[g+1,g],[T,N-1]),m=numeric.tensor(n,numeric.dot(n,p)),v=g+1;v<=T;v++)for(h=e[v],d=m[v-g-1],y=g;y<N;y++)h[y]-=2*d[y-g];for(p=numeric.getBlock(e,[0,g+1],[N-1,T]),m=numeric.tensor(numeric.dot(p,n),n),v=0;v<N;v++)for(h=e[v],d=m[v],y=g+1;y<=T;y++)h[y]-=2*d[y-g-1];for(p=Array(T-g),v=g+1;v<=T;v++)p[v-g-1]=M[v];for(m=numeric.tensor(n,numeric.dot(n,p)),v=g+1;v<=T;v++)for(f=M[v],d=m[v-g-1],y=0;y<N;y++)f[y]-=2*d[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,r){var t,n,i,a,o,u,s,l,c,f,h,p,m,d,v,g,y,b=numeric.toUpperHessenberg(e),E=numeric.QRFrancis(b.H,r),N=numeric.T,M=e.length,I=E.B,S=numeric.dot(E.Q,numeric.dot(b.H,numeric.transpose(E.Q))),x=new N(numeric.dot(E.Q,b.Q)),A=I.length,w=Math.sqrt;for(n=0;n<A;n++)if(t=I[n][0],t===I[n][1]);else{if(a=t+1,o=S[t][t],u=S[t][a],s=S[a][t],l=S[a][a],0===u&&0===s)continue;c=-o-l,f=o*l-u*s,h=c*c-4*f,h>=0?(p=c<0?-.5*(c-w(h)):-.5*(c+w(h)),g=(o-p)*(o-p)+u*u,y=s*s+(l-p)*(l-p),g>y?(g=w(g),d=(o-p)/g,v=u/g):(y=w(y),d=s/y,v=(l-p)/y),i=new N([[v,-d],[d,v]]),x.setRows(t,a,i.dot(x.getRows(t,a)))):(p=-.5*c,m=.5*w(-h),g=(o-p)*(o-p)+u*u,y=s*s+(l-p)*(l-p),g>y?(g=w(g+m*m),d=(o-p)/g,v=u/g,p=0,m/=g):(y=w(y+m*m),d=s/y,v=(l-p)/y,p=m/y,m=0),i=new N([[v,-d],[d,v]],[[p,m],[m,-p]]),x.setRows(t,a,i.dot(x.getRows(t,a))))}var T=x.dot(e).dot(x.transjugate()),M=e.length,O=numeric.T.identity(M);for(a=0;a<M;a++)if(a>0)for(n=a-1;n>=0;n--){var R=T.get([n,n]),_=T.get([a,a]);numeric.neq(R.x,_.x)||numeric.neq(R.y,_.y)?(p=T.getRow(n).getBlock([n],[a-1]),m=O.getRow(a).getBlock([n],[a-1]),O.set([a,n],T.get([n,a]).neg().sub(p.dot(m)).div(R.sub(_)))):O.setRow(a,O.getRow(n))}for(a=0;a<M;a++)p=O.getRow(a),O.setRow(a,p.div(p.norm2()));return O=O.transpose(),O=x.transjugate().dot(O),{lambda:T.getDiag(),E:O}},numeric.ccsSparse=function(e){var r,t,n,i,a=e.length,o=[];for(n=a-1;n!==-1;--n){t=e[n];for(i in t){for(i=parseInt(i);i>=o.length;)o[o.length]=0;0!==t[i]&&o[i]++}}var r=o.length,u=Array(r+1);for(u[0]=0,n=0;n<r;++n)u[n+1]=u[n]+o[n];var s=Array(u[r]),l=Array(u[r]);for(n=a-1;n!==-1;--n){t=e[n];for(i in t)0!==t[i]&&(o[i]--,s[u[i]+o[i]]=n,l[u[i]+o[i]]=t[i])}return[u,s,l]},numeric.ccsFull=function(e){var r,t,n,i,a=e[0],o=e[1],u=e[2],s=numeric.ccsDim(e),l=s[0],c=s[1],f=numeric.rep([l,c],0);for(r=0;r<c;r++)for(n=a[r],i=a[r+1],t=n;t<i;++t)f[o[t]][r]=u[t];return f},numeric.ccsTSolve=function(e,r,t,n,i){function a(e){var r;if(0===t[e]){for(t[e]=1,r=o[e];r<o[e+1];++r)a(u[r]);i[f]=e,++f}}var o=e[0],u=e[1],s=e[2],l=o.length-1,c=Math.max,f=0;"undefined"==typeof n&&(t=numeric.rep([l],0)),"undefined"==typeof n&&(n=numeric.linspace(0,t.length-1)),"undefined"==typeof i&&(i=[]);var h,p,m,d,v,g,y;for(h=n.length-1;h!==-1;--h)a(n[h]);for(i.length=f,h=i.length-1;h!==-1;--h)t[i[h]]=0;for(h=n.length-1;h!==-1;--h)p=n[h],t[p]=r[p];for(h=i.length-1;h!==-1;--h){for(p=i[h],m=o[p],d=c(o[p+1],m),v=m;v!==d;++v)if(u[v]===p){t[p]/=s[v];break}for(y=t[p],v=m;v!==d;++v)g=u[v],g!==p&&(t[g]-=y*s[v])}return t},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,r,t,n,i,a){var o,u,s,l=0,c=i.length,f=this.k,h=this.k1,p=this.j;if(0===n[e])for(n[e]=1,p[0]=e,f[0]=u=r[e],h[0]=s=r[e+1];;)if(u>=s){if(i[c]=p[l],0===l)return;++c,--l,u=f[l],s=h[l]}else o=a[t[u]],0===n[o]?(n[o]=1,f[l]=u,++l,p[l]=o,u=r[o],h[l]=s=r[o+1]):++u},numeric.ccsLPSolve=function(e,r,t,n,i,a,o){var u,s,l,c,f,h,p,m,d,v=e[0],g=e[1],y=e[2],b=(v.length-1,r[0]),E=r[1],N=r[2];for(s=b[i],l=b[i+1],n.length=0,u=s;u<l;++u)o.dfs(a[E[u]],v,g,t,n,a);for(u=n.length-1;u!==-1;--u)t[n[u]]=0;for(u=s;u!==l;++u)c=a[E[u]],t[c]=N[u];for(u=n.length-1;u!==-1;--u){for(c=n[u],f=v[c],h=v[c+1],p=f;p<h;++p)if(a[g[p]]===c){t[c]/=y[p];break}for(d=t[c],p=f;p<h;++p)m=a[g[p]],m!==c&&(t[m]-=d*y[p])}return t},numeric.ccsLUP1=function(e,r){var t,n,i,a,o,u,s,l=e[0].length-1,c=[numeric.rep([l+1],0),[],[]],f=[numeric.rep([l+1],0),[],[]],h=c[0],p=c[1],m=c[2],d=f[0],v=f[1],g=f[2],y=numeric.rep([l],0),b=numeric.rep([l],0),E=numeric.ccsLPSolve,N=(Math.max,Math.abs),M=numeric.linspace(0,l-1),I=numeric.linspace(0,l-1),S=new numeric.ccsDFS(l);for("undefined"==typeof r&&(r=1),t=0;t<l;++t){for(E(c,e,y,b,t,I,S),a=-1,o=-1,n=b.length-1;n!==-1;--n)i=b[n],i<=t||(u=N(y[i]),u>a&&(o=i,a=u));for(N(y[t])<r*a&&(n=M[t],a=M[o],M[t]=a,I[a]=t,M[o]=n,I[n]=o,a=y[t],y[t]=y[o],y[o]=a),a=h[t],o=d[t],s=y[t],p[a]=M[t],m[a]=1,++a,n=b.length-1;n!==-1;--n)i=b[n],u=y[i],b[n]=0,y[i]=0,i<=t?(v[o]=i,g[o]=u,++o):(p[a]=M[i],m[a]=u/s,++a);h[t+1]=a,d[t+1]=o}for(n=p.length-1;n!==-1;--n)p[n]=I[p[n]];return{L:c,U:f,P:M,Pinv:I}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,r,t,n,i,a,o){var u,s,l,c=0,f=i.length,h=this.k,p=this.k1,m=this.j;if(0===n[e])for(n[e]=1,m[0]=e,h[0]=s=r[a[e]],p[0]=l=r[a[e]+1];;){if(isNaN(s))throw new Error("Ow!");if(s>=l){if(i[f]=a[m[c]],0===c)return;++f,--c,s=h[c],l=p[c]}else u=t[s],0===n[u]?(n[u]=1,h[c]=s,++c,m[c]=u,u=a[u],s=r[u],p[c]=l=r[u+1]):++s}},numeric.ccsLPSolve0=function(e,r,t,n,i,a,o,u){var s,l,c,f,h,p,m,d,v,g=e[0],y=e[1],b=e[2],E=(g.length-1,r[0]),N=r[1],M=r[2];for(l=E[i],c=E[i+1],n.length=0,s=l;s<c;++s)u.dfs(N[s],g,y,t,n,a,o);for(s=n.length-1;s!==-1;--s)f=n[s],t[o[f]]=0;for(s=l;s!==c;++s)f=N[s],t[f]=M[s];for(s=n.length-1;s!==-1;--s){for(f=n[s],d=o[f],h=g[f],p=g[f+1],m=h;m<p;++m)if(y[m]===d){t[d]/=b[m];break}for(v=t[d],m=h;m<p;++m)t[y[m]]-=v*b[m];t[d]=v}},numeric.ccsLUP0=function(e,r){var t,n,i,a,o,u,s,l=e[0].length-1,c=[numeric.rep([l+1],0),[],[]],f=[numeric.rep([l+1],0),[],[]],h=c[0],p=c[1],m=c[2],d=f[0],v=f[1],g=f[2],y=numeric.rep([l],0),b=numeric.rep([l],0),E=numeric.ccsLPSolve0,N=(Math.max,Math.abs),M=numeric.linspace(0,l-1),I=numeric.linspace(0,l-1),S=new numeric.ccsDFS0(l);for("undefined"==typeof r&&(r=1),t=0;t<l;++t){for(E(c,e,y,b,t,I,M,S),a=-1,o=-1,n=b.length-1;n!==-1;--n)i=b[n],i<=t||(u=N(y[M[i]]),u>a&&(o=i,a=u));for(N(y[M[t]])<r*a&&(n=M[t],a=M[o],M[t]=a,I[a]=t,M[o]=n,I[n]=o),a=h[t],o=d[t],s=y[M[t]],p[a]=M[t],m[a]=1,++a,n=b.length-1;n!==-1;--n)i=b[n],u=y[M[i]],b[n]=0,y[M[i]]=0,i<=t?(v[o]=i,g[o]=u,++o):(p[a]=M[i],m[a]=u/s,++a);h[t+1]=a,d[t+1]=o}for(n=p.length-1;n!==-1;--n)p[n]=I[p[n]];return{L:c,U:f,P:M,Pinv:I}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,r,t){var n=numeric.ccsDim(e),i=n[0],a=n[1];"undefined"==typeof r?r=numeric.linspace(0,i-1):"number"==typeof r&&(r=[r]),"undefined"==typeof t?t=numeric.linspace(0,a-1):"number"==typeof t&&(t=[t]);var o,u,s,l,c,f=r.length,h=t.length,p=numeric.rep([a],0),m=[],d=[],v=[p,m,d],g=e[0],y=e[1],b=e[2],E=numeric.rep([i],0),N=0,M=numeric.rep([i],0);for(u=0;u<h;++u){l=t[u];var I=g[l],S=g[l+1];for(o=I;o<S;++o)s=y[o],M[s]=1,E[s]=b[o];for(o=0;o<f;++o)c=r[o],M[c]&&(m[N]=o,d[N]=E[r[o]],++N);for(o=I;o<S;++o)s=y[o],M[s]=0;p[u+1]=N}return v},numeric.ccsDot=function(e,r){var t,n,i,a,o,u,s,l,c,f,h,p=e[0],m=e[1],d=e[2],v=r[0],g=r[1],y=r[2],b=numeric.ccsDim(e),E=numeric.ccsDim(r),N=b[0],M=(b[1],E[1]),I=numeric.rep([N],0),S=numeric.rep([N],0),x=Array(N),A=numeric.rep([M],0),w=[],T=[],O=[A,w,T];for(i=0;i!==M;++i){for(a=v[i],o=v[i+1],c=0,n=a;n<o;++n)for(f=g[n],h=y[n],u=p[f],s=p[f+1],t=u;t<s;++t)l=m[t],0===S[l]&&(x[c]=l,S[l]=1,c+=1),I[l]=I[l]+d[t]*h;for(a=A[i],o=a+c,A[i+1]=o,n=c-1;n!==-1;--n)h=a+n,t=x[n],w[h]=t,T[h]=I[t],S[t]=0,I[t]=0;A[i+1]=A[i]+c}return O},numeric.ccsLUPSolve=function(e,r){var t=e.L,n=e.U,i=(e.P,r[0]),a=!1;"object"!=typeof i&&(r=[[0,r.length],numeric.linspace(0,r.length-1),r],i=r[0],a=!0);var o,u,s,l,c,f,h=r[1],p=r[2],m=t[0].length-1,d=i.length-1,v=numeric.rep([m],0),g=Array(m),y=numeric.rep([m],0),b=Array(m),E=numeric.rep([d+1],0),N=[],M=[],I=numeric.ccsTSolve,S=0;for(o=0;o<d;++o){for(c=0,s=i[o],l=i[o+1],u=s;u<l;++u)f=e.Pinv[h[u]],b[c]=f,y[f]=p[u],++c;for(b.length=c,I(t,y,v,b,g),u=b.length-1;u!==-1;--u)y[b[u]]=0;if(I(n,v,y,g,b),a)return y;for(u=g.length-1;u!==-1;--u)v[g[u]]=0;for(u=b.length-1;u!==-1;--u)f=b[u],N[S]=f,M[S]=y[f],y[f]=0,++S;E[o+1]=S}return[E,N,M]},numeric.ccsbinop=function(e,r){return"undefined"==typeof r&&(r=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+r+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var r,t=e[0],n=e[1],i=e[2],a=numeric.sup(n)+1,o=t.length,u=numeric.rep([a],0),s=Array(o),l=Array(o),c=numeric.rep([a],0);for(r=0;r<o;++r)c[n[r]]++;for(r=0;r<a;++r)u[r+1]=u[r]+c[r];var f,h,p=u.slice(0);for(r=0;r<o;++r)h=n[r],f=p[h],s[f]=t[r],l[f]=i[r],p[h]=p[h]+1;return[u,s,l]},numeric.ccsGather=function(e){var r,t,n,i,a,o=e[0],u=e[1],s=e[2],l=o.length-1,c=u.length,f=Array(c),h=Array(c),p=Array(c);for(a=0,r=0;r<l;++r)for(n=o[r],i=o[r+1],t=n;t!==i;++t)h[a]=r,f[a]=u[t],p[a]=s[t],++a;return[f,h,p]},numeric.sdim=function e(r,t,n){if("undefined"==typeof t&&(t=[]),"object"!=typeof r)return t;"undefined"==typeof n&&(n=0),n in t||(t[n]=0),r.length>t[n]&&(t[n]=r.length);var i;for(i in r)r.hasOwnProperty(i)&&e(r[i],t,n+1);return t},numeric.sclone=function e(r,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=numeric.sdim(r).length);var i,a=Array(r.length);if(t===n-1){for(i in r)r.hasOwnProperty(i)&&(a[i]=r[i]);return a}for(i in r)r.hasOwnProperty(i)&&(a[i]=e(r[i],t+1,n));return a},numeric.sdiag=function(e){var r,t,n=e.length,i=Array(n);for(r=n-1;r>=1;r-=2)t=r-1,i[r]=[],i[r][r]=e[r],i[t]=[],i[t][t]=e[t];return 0===r&&(i[0]=[],i[0][0]=e[r]),i},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var r,t,n,i=[];e.length;for(r in e)if(e.hasOwnProperty(r)){n=e[r];for(t in n)n.hasOwnProperty(t)&&("object"!=typeof i[t]&&(i[t]=[]),i[t][r]=n[t])}return i},numeric.sLUP=function(e,r){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,r){var t,n,i,a,o,u,s,l=e.length,c=(r.length,numeric.stranspose(r)),f=c.length,h=Array(l);for(i=l-1;i>=0;i--){for(s=[],t=e[i],o=f-1;o>=0;o--){u=0,n=c[o];for(a in t)t.hasOwnProperty(a)&&a in n&&(u+=t[a]*n[a]);u&&(s[o]=u)}h[i]=s}return h},numeric.sdotMV=function(e,r){var t,n,i,a,o=e.length,u=Array(o);for(n=o-1;n>=0;n--){t=e[n],a=0;for(i in t)t.hasOwnProperty(i)&&r[i]&&(a+=t[i]*r[i]);a&&(u[n]=a)}return u},numeric.sdotVM=function(e,r){var t,n,i,a,o=[];for(t in e)if(e.hasOwnProperty(t)){i=r[t],a=e[t];for(n in i)i.hasOwnProperty(n)&&(o[n]||(o[n]=0),o[n]+=a*i[n])}return o},numeric.sdotVV=function(e,r){var t,n=0;for(t in e)e[t]&&r[t]&&(n+=e[t]*r[t]);return n},numeric.sdot=function(e,r){var t=numeric.sdim(e).length,n=numeric.sdim(r).length,i=1e3*t+n;switch(i){case 0:return e*r;case 1001:return numeric.sdotVV(e,r);case 2001:return numeric.sdotMV(e,r);case 1002:return numeric.sdotVM(e,r);case 2002:return numeric.sdotMM(e,r);default:throw new Error("numeric.sdot not implemented for tensors of order "+t+" and "+n)}},numeric.sscatter=function(e){var r,t,n,i,a=e[0].length,o=e.length,u=[];for(t=a-1;t>=0;--t)if(e[o-1][t]){for(i=u,n=0;n<o-2;n++)r=e[n][t],i[r]||(i[r]=[]),i=i[r];i[e[n][t]]=e[n+1][t]}return u},numeric.sgather=function e(r,t,n){"undefined"==typeof t&&(t=[]),"undefined"==typeof n&&(n=[]);var i,a,o;i=n.length;for(a in r)if(r.hasOwnProperty(a))if(n[i]=parseInt(a),o=r[a],"number"==typeof o){if(o){if(0===t.length)for(a=i+1;a>=0;--a)t[a]=[];for(a=i;a>=0;--a)t[a].push(n[a]);t[i+1].push(o)}}else e(o,t,n);return n.length>i&&n.pop(),t},numeric.cLU=function(e){var r,t,n,i,a,o,u=e[0],s=e[1],l=e[2],c=u.length,f=0;for(r=0;r<c;r++)u[r]>f&&(f=u[r]);f++;var h,p,m,d=Array(f),v=Array(f),g=numeric.rep([f],1/0),y=numeric.rep([f],-(1/0));for(n=0;n<c;n++)r=u[n],t=s[n],t<g[r]&&(g[r]=t),t>y[r]&&(y[r]=t);for(r=0;r<f-1;r++)y[r]>y[r+1]&&(y[r+1]=y[r]);for(r=f-1;r>=1;r--)g[r]<g[r-1]&&(g[r-1]=g[r]);var b=0,E=0;for(r=0;r<f;r++)v[r]=numeric.rep([y[r]-g[r]+1],0),d[r]=numeric.rep([r-g[r]],0),b+=r-g[r]+1,E+=y[r]-r+1;for(n=0;n<c;n++)r=u[n],v[r][s[n]-g[r]]=l[n];for(r=0;r<f-1;r++)for(i=r-g[r],h=v[r],t=r+1;g[t]<=r&&t<f;t++)if(a=r-g[t],o=y[r]-r,p=v[t],m=p[a]/h[i]){for(n=1;n<=o;n++)p[n+a]-=m*h[n+i];d[t][r-g[t]]=m}var c,N,M,h=[],p=[],I=[],S=[],x=[],A=[];for(c=0,N=0,r=0;r<f;r++){for(i=g[r],a=y[r],M=v[r],t=r;t<=a;t++)M[t-i]&&(h[c]=r,p[c]=t,I[c]=M[t-i],c++);for(M=d[r],t=i;t<r;t++)M[t-i]&&(S[N]=r,x[N]=t,A[N]=M[t-i],N++);S[N]=r,x[N]=r,A[N]=1,N++}return{U:[h,p,I],L:[S,x,A]}},numeric.cLUsolve=function(e,r){var t,n,i=e.L,a=e.U,o=numeric.clone(r),u=i[0],s=i[1],l=i[2],c=a[0],f=a[1],h=a[2],p=c.length,m=(u.length,o.length);for(n=0,t=0;t<m;t++){for(;s[n]<t;)o[t]-=l[n]*o[s[n]],n++;n++}for(n=p-1,t=m-1;t>=0;t--){for(;f[n]>t;)o[t]-=h[n]*o[f[n]],n--;o[t]/=h[n],n--}return o},numeric.cgrid=function(e,r){"number"==typeof e&&(e=[e,e]);var t,n,i,a=numeric.rep(e,-1);if("function"!=typeof r)switch(r){case"L":r=function(r,t){return r>=e[0]/2||t<e[1]/2};break;default:r=function(e,r){return!0}}for(i=0,t=1;t<e[0]-1;t++)for(n=1;n<e[1]-1;n++)r(t,n)&&(a[t][n]=i,i++);return a},numeric.cdelsq=function(e){var r,t,n,i,a,o=[[-1,0],[0,-1],[0,1],[1,0]],u=numeric.dim(e),s=u[0],l=u[1],c=[],f=[],h=[];for(r=1;r<s-1;r++)for(t=1;t<l-1;t++)if(!(e[r][t]<0)){for(n=0;n<4;n++)i=r+o[n][0],a=t+o[n][1],e[i][a]<0||(c.push(e[r][t]),f.push(e[i][a]),h.push(-1));c.push(e[r][t]),f.push(e[r][t]),h.push(4)}return[c,f,h]},numeric.cdotMV=function(e,r){var t,n,i,a=e[0],o=e[1],u=e[2],s=a.length;for(i=0,n=0;n<s;n++)a[n]>i&&(i=a[n]);for(i++,t=numeric.rep([i],0),n=0;n<s;n++)t[a[n]]+=u[n]*r[o[n]];return t},numeric.Spline=function(e,r,t,n,i){this.x=e,this.yl=r,this.yr=t,this.kl=n,this.kr=i},numeric.Spline.prototype._at=function(e,r){var e,t,n,i,a=this.x,o=this.yl,u=this.yr,s=this.kl,l=this.kr,c=numeric.add,f=numeric.sub,h=numeric.mul;t=f(h(s[r],a[r+1]-a[r]),f(u[r+1],o[r])),n=c(h(l[r+1],a[r]-a[r+1]),f(u[r+1],o[r])),i=(e-a[r])/(a[r+1]-a[r]);var p=i*(1-i);return c(c(c(h(1-i,o[r]),h(i,u[r+1])),h(t,p*(1-i))),h(n,p*i))},numeric.Spline.prototype.at=function(e){if("number"==typeof e){var r,t,n,i=this.x,a=i.length,o=Math.floor;for(r=0,t=a-1;t-r>1;)n=o((r+t)/2),i[n]<=e?r=n:t=n;return this._at(e,r)}var u,a=e.length,s=Array(a);for(u=a-1;u!==-1;--u)s[u]=this.at(e[u]);return s},numeric.Spline.prototype.diff=function(){var e,r,t,n=this.x,i=this.yl,a=this.yr,o=this.kl,u=this.kr,s=i.length,l=o,c=u,f=Array(s),h=Array(s),p=numeric.add,m=numeric.mul,d=numeric.div,v=numeric.sub;for(e=s-1;e!==-1;--e)r=n[e+1]-n[e],t=v(a[e+1],i[e]),f[e]=d(p(m(t,6),m(o[e],-4*r),m(u[e+1],-2*r)),r*r),h[e+1]=d(p(m(t,-6),m(o[e],2*r),m(u[e+1],4*r)),r*r);return new numeric.Spline(n,l,c,f,h)},numeric.Spline.prototype.roots=function(){function e(e){return e*e}var r=[],t=this.x,n=this.yl,i=this.yr,a=this.kl,o=this.kr;"number"==typeof n[0]&&(n=[n],i=[i],a=[a],o=[o]);var u,s,l,c,f,h,p,m,d,v,g,y,b,E,N,M,I,S,x,A,w,T,O,R,_=n.length,C=t.length-1,r=Array(_),V=Math.sqrt;for(u=0;u!==_;++u){for(c=n[u],f=i[u],h=a[u],p=o[u],m=[],s=0;s!==C;s++){for(s>0&&f[s]*c[s]<0&&m.push(t[s]),M=t[s+1]-t[s],I=t[s],g=c[s],y=f[s+1],d=h[s]/M,v=p[s+1]/M,N=e(d-v+3*(g-y))+12*v*g,b=v+3*g+2*d-3*y,E=3*(v+d+2*(g-y)),N<=0?(x=b/E,S=x>t[s]&&x<t[s+1]?[t[s],x,t[s+1]]:[t[s],t[s+1]]):(x=(b-V(N))/E,A=(b+V(N))/E,S=[t[s]],x>t[s]&&x<t[s+1]&&S.push(x),A>t[s]&&A<t[s+1]&&S.push(A),S.push(t[s+1])),T=S[0],x=this._at(T,s),l=0;l<S.length-1;l++)if(O=S[l+1],A=this._at(O,s),0!==x)if(0===A||x*A>0)T=O,x=A;else{for(var $=0;;){if(R=(x*O-A*T)/(x-A),R<=T||R>=O)break;if(w=this._at(R,s),w*A>0)O=R,A=w,$===-1&&(x*=.5),$=-1;else{if(!(w*x>0))break;T=R,x=w,1===$&&(A*=.5),$=1}}m.push(R),T=S[l+1],x=this._at(T,s)}else m.push(T),T=O,x=A;0===A&&m.push(O)}r[u]=m}return"number"==typeof this.yl[0]?r[0]:r},numeric.spline=function(e,r,t,n){var i,a=e.length,o=[],u=[],s=[],l=numeric.sub,c=numeric.mul,f=numeric.add;for(i=a-2;i>=0;i--)u[i]=e[i+1]-e[i],s[i]=l(r[i+1],r[i]);"string"!=typeof t&&"string"!=typeof n||(t=n="periodic");var h=[[],[],[]];switch(typeof t){case"undefined":o[0]=c(3/(u[0]*u[0]),s[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/u[0],1/u[0]);
break;case"string":o[0]=f(c(3/(u[a-2]*u[a-2]),s[a-2]),c(3/(u[0]*u[0]),s[0])),h[0].push(0,0,0),h[1].push(a-2,0,1),h[2].push(1/u[a-2],2/u[a-2]+2/u[0],1/u[0]);break;default:o[0]=t,h[0].push(0),h[1].push(0),h[2].push(1)}for(i=1;i<a-1;i++)o[i]=f(c(3/(u[i-1]*u[i-1]),s[i-1]),c(3/(u[i]*u[i]),s[i])),h[0].push(i,i,i),h[1].push(i-1,i,i+1),h[2].push(1/u[i-1],2/u[i-1]+2/u[i],1/u[i]);switch(typeof n){case"undefined":o[a-1]=c(3/(u[a-2]*u[a-2]),s[a-2]),h[0].push(a-1,a-1),h[1].push(a-2,a-1),h[2].push(1/u[a-2],2/u[a-2]);break;case"string":h[1][h[1].length-1]=0;break;default:o[a-1]=n,h[0].push(a-1),h[1].push(a-1),h[2].push(1)}o="number"!=typeof o[0]?numeric.transpose(o):[o];var p=Array(o.length);if("string"==typeof t)for(i=p.length-1;i!==-1;--i)p[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),o[i]),p[i][a-1]=p[i][0];else for(i=p.length-1;i!==-1;--i)p[i]=numeric.cLUsolve(numeric.cLU(h),o[i]);return p="number"==typeof r[0]?p[0]:numeric.transpose(p),new numeric.Spline(e,r,r,p,p)},numeric.fftpow2=function e(r,t){var n=r.length;if(1!==n){var i,a,o=Math.cos,u=Math.sin,s=Array(n/2),l=Array(n/2),c=Array(n/2),f=Array(n/2);for(a=n/2,i=n-1;i!==-1;--i)--a,c[a]=r[i],f[a]=t[i],--i,s[a]=r[i],l[a]=t[i];e(s,l),e(c,f),a=n/2;var h,p,m,d=-6.283185307179586/n;for(i=n-1;i!==-1;--i)--a,a===-1&&(a=n/2-1),h=d*i,p=o(h),m=u(h),r[i]=s[a]+p*c[a]-m*f[a],t[i]=l[a]+p*f[a]+m*c[a]}},numeric._ifftpow2=function e(r,t){var n=r.length;if(1!==n){var i,a,o=Math.cos,u=Math.sin,s=Array(n/2),l=Array(n/2),c=Array(n/2),f=Array(n/2);for(a=n/2,i=n-1;i!==-1;--i)--a,c[a]=r[i],f[a]=t[i],--i,s[a]=r[i],l[a]=t[i];e(s,l),e(c,f),a=n/2;var h,p,m,d=6.283185307179586/n;for(i=n-1;i!==-1;--i)--a,a===-1&&(a=n/2-1),h=d*i,p=o(h),m=u(h),r[i]=s[a]+p*c[a]-m*f[a],t[i]=l[a]+p*f[a]+m*c[a]}},numeric.ifftpow2=function(e,r){numeric._ifftpow2(e,r),numeric.diveq(e,e.length),numeric.diveq(r,r.length)},numeric.convpow2=function(e,r,t,n){numeric.fftpow2(e,r),numeric.fftpow2(t,n);var i,a,o,u,s,l=e.length;for(i=l-1;i!==-1;--i)a=e[i],u=r[i],o=t[i],s=n[i],e[i]=a*o-u*s,r[i]=a*s+u*o;numeric.ifftpow2(e,r)},numeric.T.prototype.fft=function(){var e,r,t=this.x,n=this.y,i=t.length,a=Math.log,o=a(2),u=Math.ceil(a(2*i-1)/o),s=Math.pow(2,u),l=numeric.rep([s],0),c=numeric.rep([s],0),f=Math.cos,h=Math.sin,p=-3.141592653589793/i,m=numeric.rep([s],0),d=numeric.rep([s],0);Math.floor(i/2);for(e=0;e<i;e++)m[e]=t[e];if("undefined"!=typeof n)for(e=0;e<i;e++)d[e]=n[e];for(l[0]=1,e=1;e<=s/2;e++)r=p*e*e,l[e]=f(r),c[e]=h(r),l[s-e]=f(r),c[s-e]=h(r);var v=new numeric.T(m,d),g=new numeric.T(l,c);return v=v.mul(g),numeric.convpow2(v.x,v.y,numeric.clone(g.x),numeric.neg(g.y)),v=v.mul(g),v.x.length=i,v.y.length=i,v},numeric.T.prototype.ifft=function(){var e,r,t=this.x,n=this.y,i=t.length,a=Math.log,o=a(2),u=Math.ceil(a(2*i-1)/o),s=Math.pow(2,u),l=numeric.rep([s],0),c=numeric.rep([s],0),f=Math.cos,h=Math.sin,p=3.141592653589793/i,m=numeric.rep([s],0),d=numeric.rep([s],0);Math.floor(i/2);for(e=0;e<i;e++)m[e]=t[e];if("undefined"!=typeof n)for(e=0;e<i;e++)d[e]=n[e];for(l[0]=1,e=1;e<=s/2;e++)r=p*e*e,l[e]=f(r),c[e]=h(r),l[s-e]=f(r),c[s-e]=h(r);var v=new numeric.T(m,d),g=new numeric.T(l,c);return v=v.mul(g),numeric.convpow2(v.x,v.y,numeric.clone(g.x),numeric.neg(g.y)),v=v.mul(g),v.x.length=i,v.y.length=i,v.div(i)},numeric.gradient=function(e,r){var t=r.length,n=e(r);if(isNaN(n))throw new Error("gradient: f(x) is a NaN!");var i,a,o,u,s,l,c,f,h,p,m=Math.max,d=numeric.clone(r),v=Array(t),m=(numeric.div,numeric.sub,Math.max),g=.001,y=Math.abs,b=Math.min,E=0;for(i=0;i<t;i++)for(var N=m(1e-6*n,1e-8);;){if(++E,E>20)throw new Error("Numerical gradient fails");if(d[i]=r[i]+N,a=e(d),d[i]=r[i]-N,o=e(d),d[i]=r[i],isNaN(a)||isNaN(o))N/=16;else{if(v[i]=(a-o)/(2*N),s=r[i]-N,l=r[i],c=r[i]+N,f=(a-n)/N,h=(n-o)/N,p=m(y(v[i]),y(n),y(a),y(o),y(s),y(l),y(c),1e-8),u=b(m(y(f-v[i]),y(h-v[i]),y(f-h))/p,N/p),!(u>g))break;N/=16}}return v},numeric.uncmin=function(e,r,t,n,i,a,o){var u=numeric.gradient;"undefined"==typeof o&&(o={}),"undefined"==typeof t&&(t=1e-8),"undefined"==typeof n&&(n=function(r){return u(e,r)}),"undefined"==typeof i&&(i=1e3),r=numeric.clone(r);var s,l,c=r.length,f=e(r);if(isNaN(f))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,p=numeric.norm2;t=h(t,numeric.epsilon);var m,d,v,g,y,b,E,N,M,I,S=o.Hinv||numeric.identity(c),x=numeric.dot,A=(numeric.inv,numeric.sub),w=numeric.add,T=numeric.tensor,O=numeric.div,R=numeric.mul,_=numeric.all,C=numeric.isFinite,V=numeric.neg,$=0,k="";for(d=n(r);$<i;){if("function"==typeof a&&a($,r,f,d,S)){k="Callback returned true";break}if(!_(C(d))){k="Gradient has Infinity or NaN";break}if(m=V(x(S,d)),!_(C(m))){k="Search direction has Infinity or NaN";break}if(I=p(m),I<t){k="Newton step smaller than tol";break}for(M=1,l=x(d,m),y=r;$<i&&!(M*I<t)&&(g=R(m,M),y=w(r,g),s=e(y),s-f>=.1*M*l||isNaN(s));)M*=.5,++$;if(M*I<t){k="Line search step size smaller than tol";break}if($===i){k="maxit reached during line search";break}v=n(y),b=A(v,d),N=x(b,g),E=x(S,b),S=A(w(S,R((N+x(b,E))/(N*N),T(g,g))),O(w(T(E,g),T(g,E)),N)),r=y,f=s,d=v,++$}return{solution:r,f:f,gradient:d,invHessian:S,iterations:$,message:k}},numeric.Dopri=function(e,r,t,n,i,a,o){this.x=e,this.y=r,this.f=t,this.ymid=n,this.iterations=i,this.events=o,this.message=a},numeric.Dopri.prototype._at=function(e,r){function t(e){return e*e}var n,i,a,o,u,s,e,l,c,f,h,p=this,m=p.x,d=p.y,v=p.f,g=p.ymid,y=(m.length,Math.floor,.5),b=numeric.add,E=numeric.mul,N=numeric.sub;return n=m[r],i=m[r+1],o=d[r],u=d[r+1],l=i-n,a=n+y*l,s=g[r],c=N(v[r],E(o,1/(n-a)+2/(n-i))),f=N(v[r+1],E(u,1/(i-a)+2/(i-n))),h=[t(e-i)*(e-a)/t(n-i)/(n-a),t(e-n)*t(e-i)/t(n-a)/t(i-a),t(e-n)*(e-a)/t(i-n)/(i-a),(e-n)*t(e-i)*(e-a)/t(n-i)/(n-a),(e-i)*t(e-n)*(e-a)/t(n-i)/(i-a)],b(b(b(b(E(o,h[0]),E(s,h[1])),E(u,h[2])),E(c,h[3])),E(f,h[4]))},numeric.Dopri.prototype.at=function(e){var r,t,n,i=Math.floor;if("number"!=typeof e){var a=e.length,o=Array(a);for(r=a-1;r!==-1;--r)o[r]=this.at(e[r]);return o}var u=this.x;for(r=0,t=u.length-1;t-r>1;)n=i(.5*(r+t)),u[n]<=e?r=n:t=n;return this._at(e,r)},numeric.dopri=function(e,r,t,n,i,a,o){"undefined"==typeof i&&(i=1e-6),"undefined"==typeof a&&(a=1e3);var u,s,l,c,f,h,p,m,d,v,g,y,b,E=[e],N=[t],M=[n(e,t)],I=[],S=.2,x=[.075,.225],A=[44/45,-56/15,32/9],w=[19372/6561,-25360/2187,64448/6561,-212/729],T=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],O=[35/384,0,500/1113,125/192,-2187/6784,11/84],R=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],_=[.2,.3,.8,8/9,1,1],C=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],V=0,$=(r-e)/10,k=0,D=numeric.add,P=numeric.mul,L=(Math.max,Math.min),j=Math.abs,F=numeric.norminf,U=Math.pow,B=numeric.any,H=numeric.lt,q=numeric.and,G=(numeric.sub,new numeric.Dopri(E,N,M,I,(-1),""));for("function"==typeof o&&(g=o(e,t));e<r&&k<a;)if(++k,e+$>r&&($=r-e),u=n(e+_[0]*$,D(t,P(S*$,M[V]))),s=n(e+_[1]*$,D(D(t,P(x[0]*$,M[V])),P(x[1]*$,u))),l=n(e+_[2]*$,D(D(D(t,P(A[0]*$,M[V])),P(A[1]*$,u)),P(A[2]*$,s))),c=n(e+_[3]*$,D(D(D(D(t,P(w[0]*$,M[V])),P(w[1]*$,u)),P(w[2]*$,s)),P(w[3]*$,l))),f=n(e+_[4]*$,D(D(D(D(D(t,P(T[0]*$,M[V])),P(T[1]*$,u)),P(T[2]*$,s)),P(T[3]*$,l)),P(T[4]*$,c))),d=D(D(D(D(D(t,P(M[V],$*O[0])),P(s,$*O[2])),P(l,$*O[3])),P(c,$*O[4])),P(f,$*O[5])),h=n(e+$,d),p=D(D(D(D(D(P(M[V],$*C[0]),P(s,$*C[2])),P(l,$*C[3])),P(c,$*C[4])),P(f,$*C[5])),P(h,$*C[6])),v="number"==typeof p?j(p):F(p),v>i){if($=.2*$*U(i/v,.25),e+$===e){G.msg="Step size became too small";break}}else{if(I[V]=D(D(D(D(D(D(t,P(M[V],$*R[0])),P(s,$*R[2])),P(l,$*R[3])),P(c,$*R[4])),P(f,$*R[5])),P(h,$*R[6])),++V,E[V]=e+$,N[V]=d,M[V]=h,"function"==typeof o){var Y,X,W=e,Q=e+.5*$;if(y=o(Q,I[V-1]),b=q(H(g,0),H(0,y)),B(b)||(W=Q,Q=e+$,g=y,y=o(Q,d),b=q(H(g,0),H(0,y))),B(b)){for(var K,z,Z=0,J=1,ee=1;;){if("number"==typeof g)X=(ee*y*W-J*g*Q)/(ee*y-J*g);else for(X=Q,m=g.length-1;m!==-1;--m)g[m]<0&&y[m]>0&&(X=L(X,(ee*y[m]*W-J*g[m]*Q)/(ee*y[m]-J*g[m])));if(X<=W||X>=Q)break;Y=G._at(X,V-1),z=o(X,Y),K=q(H(g,0),H(0,z)),B(K)?(Q=X,y=z,b=K,ee=1,Z===-1?J*=.5:J=1,Z=-1):(W=X,g=z,J=1,1===Z?ee*=.5:ee=1,Z=1)}return d=G._at(.5*(e+X),V-1),G.f[V]=n(X,Y),G.x[V]=X,G.y[V]=Y,G.ymid[V-1]=d,G.events=b,G.iterations=k,G}}e+=$,t=d,g=y,$=L(.8*$*U(i/v,.25),4*$)}return G.iterations=k,G},numeric.LU=function(e,r){r=r||!1;var t,n,i,a,o,u,s,l,c,f=Math.abs,h=e.length,p=h-1,m=new Array(h);for(r||(e=numeric.clone(e)),i=0;i<h;++i){for(s=i,u=e[i],c=f(u[i]),n=i+1;n<h;++n)a=f(e[n][i]),c<a&&(c=a,s=n);for(m[i]=s,s!=i&&(e[i]=e[s],e[s]=u,u=e[i]),o=u[i],t=i+1;t<h;++t)e[t][i]/=o;for(t=i+1;t<h;++t){for(l=e[t],n=i+1;n<p;++n)l[n]-=l[i]*u[n],++n,l[n]-=l[i]*u[n];n===p&&(l[n]-=l[i]*u[n])}}return{LU:e,P:m}},numeric.LUsolve=function(e,r){var t,n,i,a,o,u=e.LU,s=u.length,l=numeric.clone(r),c=e.P;for(t=s-1;t!==-1;--t)l[t]=r[t];for(t=0;t<s;++t)for(i=c[t],c[t]!==t&&(o=l[t],l[t]=l[i],l[i]=o),a=u[t],n=0;n<t;++n)l[t]-=l[n]*a[n];for(t=s-1;t>=0;--t){for(a=u[t],n=t+1;n<s;++n)l[t]-=l[n]*a[n];l[t]/=a[t]}return l},numeric.solve=function(e,r,t){return numeric.LUsolve(numeric.LU(e,t),r)},numeric.echelonize=function(e){var r,t,n,i,a,o,u,s,l=numeric.dim(e),c=l[0],f=l[1],h=numeric.identity(c),p=Array(c),m=Math.abs,d=numeric.diveq;for(e=numeric.clone(e),r=0;r<c;++r){for(n=0,a=e[r],o=h[r],t=1;t<f;++t)m(a[n])<m(a[t])&&(n=t);for(p[r]=n,d(o,a[n]),d(a,a[n]),t=0;t<c;++t)if(t!==r){for(u=e[t],s=u[n],i=f-1;i!==-1;--i)u[i]-=a[i]*s;for(u=h[t],i=c-1;i!==-1;--i)u[i]-=o[i]*s}}return{I:h,A:e,P:p}},numeric.__solveLP=function(e,r,t,n,i,a,o){var u,s,l,c,f=numeric.sum,h=(numeric.log,numeric.mul),p=numeric.sub,m=numeric.dot,d=numeric.div,v=numeric.add,g=e.length,y=t.length,b=!1,E=0,N=1,M=(numeric.transpose(r),numeric.svd,numeric.transpose),I=(numeric.leq,Math.sqrt),S=Math.abs,x=(numeric.muleq,numeric.norminf,numeric.any,Math.min),A=numeric.all,w=numeric.gt,T=Array(g),O=Array(y),R=(numeric.rep([y],1),numeric.solve),_=p(t,m(r,a)),C=m(e,e);for(l=E;l<i;++l){var V,$;for(V=y-1;V!==-1;--V)O[V]=d(r[V],_[V]);var k=M(O);for(V=g-1;V!==-1;--V)T[V]=f(k[V]);N=.25*S(C/m(e,T));var D=100*I(C/m(T,T));for((!isFinite(N)||N>D)&&(N=D),c=v(e,h(N,T)),s=m(k,O),V=g-1;V!==-1;--V)s[V][V]+=1;$=R(s,d(c,N),!0);var P=d(_,m(r,$)),L=1;for(V=y-1;V!==-1;--V)P[V]<0&&(L=x(L,-.999*P[V]));if(u=p(a,h($,L)),_=p(t,m(r,u)),!A(w(_,0)))return{solution:a,message:"",iterations:l};if(a=u,N<n)return{solution:u,message:"",iterations:l};if(o){var j=m(e,c),F=m(r,c);for(b=!0,V=y-1;V!==-1;--V)if(j*F[V]<0){b=!1;break}}else b=!(a[g-1]>=0);if(b)return{solution:u,message:"Unbounded",iterations:l}}return{solution:a,message:"maximum iteration count exceeded",iterations:l}},numeric._solveLP=function(e,r,t,n,i){var a,o=e.length,u=t.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),l=numeric.dot,c=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),f=numeric.rep([u,1],-1),h=numeric.blockMatrix([[r,f]]),p=t,a=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(t)))+1),m=numeric.__solveLP(c,h,p,n,i,a,!1),d=numeric.clone(m.solution);d.length=o;var v=numeric.inf(s(t,l(r,d)));if(v<0)return{solution:NaN,message:"Infeasible",iterations:m.iterations};var g=numeric.__solveLP(e,r,t,n,i-m.iterations,d,!0);return g.iterations+=m.iterations,g},numeric.solveLP=function(e,r,t,n,i,a,o){if("undefined"==typeof o&&(o=1e3),"undefined"==typeof a&&(a=numeric.epsilon),"undefined"==typeof n)return numeric._solveLP(e,r,t,a,o);var u,s=n.length,l=n[0].length,c=r.length,f=numeric.echelonize(n),h=numeric.rep([l],0),p=f.P,m=[];for(u=p.length-1;u!==-1;--u)h[p[u]]=1;for(u=l-1;u!==-1;--u)0===h[u]&&m.push(u);var d=numeric.getRange,v=numeric.linspace(0,s-1),g=numeric.linspace(0,c-1),y=d(n,v,m),b=d(r,g,p),E=d(r,g,m),N=numeric.dot,M=numeric.sub,I=N(b,f.I),S=M(E,N(I,y)),x=M(t,N(I,i)),A=Array(p.length),w=Array(m.length);for(u=p.length-1;u!==-1;--u)A[u]=e[p[u]];for(u=m.length-1;u!==-1;--u)w[u]=e[m[u]];var T=M(w,N(A,N(f.I,y))),O=numeric._solveLP(T,S,x,a,o),R=O.solution;if(R!==R)return O;var _=N(f.I,M(i,N(y,R))),C=Array(e.length);for(u=p.length-1;u!==-1;--u)C[p[u]]=_[u];for(u=m.length-1;u!==-1;--u)C[m[u]]=R[u];return{solution:C,message:O.message,iterations:O.iterations}},numeric.MPStoLP=function(e){function r(r){throw new Error("MPStoLP: "+r+"\nLine "+t+": "+e[t]+"\nCurrent state: "+u[o]+"\n")}e instanceof String&&e.split("\n");var t,n,i,a,o=0,u=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=e.length,l=0,c={},f=[],h=0,p={},m=0,d=[],v=[],g=[];for(t=0;t<s;++t){i=e[t];var y=i.match(/\S*/g),b=[];for(n=0;n<y.length;++n)""!==y[n]&&b.push(y[n]);if(0!==b.length){for(n=0;n<u.length&&i.substr(0,u[n].length)!==u[n];++n);if(n<u.length){if(o=n,1===n&&(a=b[1]),6===n)return{name:a,c:d,A:numeric.transpose(v),b:g,rows:c,vars:p}}else switch(o){case 0:case 1:r("Unexpected line");case 2:switch(b[0]){case"N":0===l?l=b[1]:r("Two or more N rows");break;case"L":c[b[1]]=h,f[h]=1,g[h]=0,++h;break;case"G":c[b[1]]=h,f[h]=-1,g[h]=0,++h;break;case"E":c[b[1]]=h,f[h]=0,g[h]=0,++h;break;default:r("Parse error "+numeric.prettyPrint(b))}break;case 3:p.hasOwnProperty(b[0])||(p[b[0]]=m,d[m]=0,v[m]=numeric.rep([h],0),++m);var E=p[b[0]];for(n=1;n<b.length;n+=2)if(b[n]!==l){var N=c[b[n]];v[E][N]=(f[N]<0?-1:1)*parseFloat(b[n+1])}else d[E]=parseFloat(b[n+1]);break;case 4:for(n=1;n<b.length;n+=2)g[c[b[n]]]=(f[c[b[n]]]<0?-1:1)*parseFloat(b[n+1]);break;case 5:break;case 6:r("Internal error")}}}r("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(e,r,t,n,i,a,o){function u(e){var r,n,i=this,a=e.length,o=0,u=i.i=i.j=i.m=0;for(i.S=[],i.c=[],a||(e=[a++]);o<t;)i.S[o]=o++;for(o=0;o<t;o++)r=i.S[o],u=c(u+r+e[o%a]),n=i.S[u],i.S[o]=n,i.S[u]=r;i.g=function(e){var r=i.S,n=c(i.i+1),a=r[n],o=c(i.j+a),u=r[o];r[n]=u,r[o]=a;for(var s=r[c(a+u)];--e;)n=c(n+1),a=r[n],o=c(o+a),u=r[o],r[n]=u,r[o]=a,s=s*t+r[c(a+u)];return i.i=n,i.j=o,s},i.g(t)}function s(e,r,t,n,i){if(t=[],i=typeof e,r&&"object"==i)for(n in e)if(n.indexOf("S")<5)try{t.push(s(e[n],r-1))}catch(e){}return t.length?t:e+("string"!=i?"\0":"")}function l(e,r,t,n){for(e+="",t=0,n=0;n<e.length;n++)r[c(n)]=c((t^=19*r[c(n)])+e.charCodeAt(n));e="";for(n in r)e+=String.fromCharCode(r[n]);return e}function c(e){return e&t-1}r.seedrandom=function(c,f){var h,p=[];return c=l(s(f?[c,e]:arguments.length?c:[(new Date).getTime(),e,window],3),p),h=new u(p),l(h.S,e),r.random=function(){for(var e=h.g(n),r=o,u=0;e<i;)e=(e+u)*t,r*=t,u=h.g(1);for(;e>=a;)e/=2,r/=2,u>>>=1;return(e+u)/r},c},o=r.pow(t,n),i=r.pow(2,i),a=2*i,l(r.random(),e)}([],numeric.seedrandom,256,6,52),function(exports){function e(r){if("object"!=typeof r)return r;var t,n=[],i=r.length;for(t=0;t<i;t++)n[t+1]=e(r[t]);return n}function r(e){if("object"!=typeof e)return e;var t,n=[],i=e.length;for(t=1;t<i;t++)n[t-1]=r(e[t]);return n}function t(e,r,t){var n,i,a,o,u;for(a=1;a<=t;a+=1){for(e[a][a]=1/e[a][a],u=-e[a][a],n=1;n<a;n+=1)e[n][a]=u*e[n][a];if(o=a+1,t<o)break;for(i=o;i<=t;i+=1)for(u=e[a][i],e[a][i]=0,n=1;n<=a;n+=1)e[n][i]=e[n][i]+u*e[n][a]}}function n(e,r,t,n){var i,a,o,u;for(a=1;a<=t;a+=1){for(u=0,i=1;i<a;i+=1)u+=e[i][a]*n[i];n[a]=(n[a]-u)/e[a][a]}for(o=1;o<=t;o+=1)for(a=t+1-o,n[a]=n[a]/e[a][a],u=-n[a],i=1;i<a;i+=1)n[i]=n[i]+u*e[i][a]}function i(e,r,t,n){var i,a,o,u,s,l;for(a=1;a<=t;a+=1){if(n[1]=a,l=0,o=a-1,o<1){if(l=e[a][a]-l,l<=0)break;e[a][a]=Math.sqrt(l)}else{for(u=1;u<=o;u+=1){for(s=e[u][a],i=1;i<u;i+=1)s-=e[i][a]*e[i][u];s/=e[u][u],e[u][a]=s,l+=s*s}if(l=e[a][a]-l,l<=0)break;e[a][a]=Math.sqrt(l)}n[1]=0}}function a(e,r,a,o,u,s,l,c,f,h,p,m,d,v,g,y){function b(){for(v[1]=v[1]+1,A=V,S=1;S<=h;S+=1){for(A+=1,j=-c[S],x=1;x<=o;x+=1)j+=l[x][S]*u[x];if(Math.abs(j)<X&&(j=0),S>p)g[A]=j;else if(g[A]=-Math.abs(j),j>0){for(x=1;x<=o;x+=1)l[x][S]=-l[x][S];c[S]=-c[S]}}for(S=1;S<=d;S+=1)g[V+m[S]]=0;for(k=0,L=0,S=1;S<=h;S+=1)g[V+S]<L*g[P+S]&&(k=S,L=g[V+S]/g[P+S]);return 0===k?999:0}function E(){for(S=1;S<=o;S+=1){for(j=0,x=1;x<=o;x+=1)j+=e[x][S]*l[x][k];g[S]=j}for(w=R,S=1;S<=o;S+=1)g[w+S]=0;for(x=d+1;x<=o;x+=1)for(S=1;S<=o;S+=1)g[w+S]=g[w+S]+e[S][x]*g[x];for(G=!0,S=d;S>=1;S-=1){for(j=g[S],A=C+S*(S+3)/2,w=A-S,x=S+1;x<=d;x+=1)j-=g[A]*g[_+x],A+=x;if(j/=g[w],g[_+S]=j,m[S]<p)break;if(j<0)break;G=!1,O=S}if(!G)for(F=g[$+O]/g[_+O],S=1;S<=d&&!(m[S]<p)&&!(g[_+S]<0);S+=1)L=g[$+S]/g[_+S],L<F&&(F=L,O=S);for(j=0,S=R+1;S<=R+o;S+=1)j+=g[S]*g[S];if(Math.abs(j)<=X){if(G)return y[1]=1,999;for(S=1;S<=d;S+=1)g[$+S]=g[$+S]-F*g[_+S];return g[$+d+1]=g[$+d+1]+F,700}for(j=0,S=1;S<=o;S+=1)j+=g[R+S]*l[S][k];for(U=-g[V+k]/j,Y=!0,G||F<U&&(U=F,Y=!1),S=1;S<=o;S+=1)u[S]=u[S]+U*g[R+S],Math.abs(u[S])<X&&(u[S]=0);for(s[1]=s[1]+U*j*(U/2+g[$+d+1]),S=1;S<=d;S+=1)g[$+S]=g[$+S]-U*g[_+S];if(g[$+d+1]=g[$+d+1]+U,!Y){for(j=-c[k],x=1;x<=o;x+=1)j+=u[x]*l[x][k];if(k>p)g[V+k]=j;else if(g[V+k]=-Math.abs(j),j>0){for(x=1;x<=o;x+=1)l[x][k]=-l[x][k];c[k]=-c[k]}return 700}for(d+=1,m[d]=k,A=C+(d-1)*d/2+1,S=1;S<=d-1;S+=1)g[A]=g[S],A+=1;if(d===o)g[A]=g[o];else{for(S=o;S>=d+1&&0!==g[S]&&(B=Math.max(Math.abs(g[S-1]),Math.abs(g[S])),H=Math.min(Math.abs(g[S-1]),Math.abs(g[S])),L=g[S-1]>=0?Math.abs(B*Math.sqrt(1+H*H/(B*B))):-Math.abs(B*Math.sqrt(1+H*H/(B*B))),B=g[S-1]/L,H=g[S]/L,1!==B);S-=1)if(0===B)for(g[S-1]=H*L,x=1;x<=o;x+=1)L=e[x][S-1],e[x][S-1]=e[x][S],e[x][S]=L;else for(g[S-1]=L,q=H/(1+B),x=1;x<=o;x+=1)L=B*e[x][S-1]+H*e[x][S],e[x][S]=q*(e[x][S-1]+L)-e[x][S],e[x][S-1]=L;g[A]=g[d]}return 0}function N(){if(A=C+O*(O+1)/2+1,w=A+O,0===g[w])return 798;if(B=Math.max(Math.abs(g[w-1]),Math.abs(g[w])),H=Math.min(Math.abs(g[w-1]),Math.abs(g[w])),L=g[w-1]>=0?Math.abs(B*Math.sqrt(1+H*H/(B*B))):-Math.abs(B*Math.sqrt(1+H*H/(B*B))),B=g[w-1]/L,H=g[w]/L,1===B)return 798;if(0===B){for(S=O+1;S<=d;S+=1)L=g[w-1],g[w-1]=g[w],g[w]=L,w+=S;for(S=1;S<=o;S+=1)L=e[S][O],e[S][O]=e[S][O+1],e[S][O+1]=L}else{for(q=H/(1+B),S=O+1;S<=d;S+=1)L=B*g[w-1]+H*g[w],g[w]=q*(g[w-1]+L)-g[w],g[w-1]=L,w+=S;for(S=1;S<=o;S+=1)L=B*e[S][O]+H*e[S][O+1],e[S][O+1]=q*(e[S][O]+L)-e[S][O+1],e[S][O]=L}return 0}function M(){for(w=A-O,S=1;S<=O;S+=1)g[w]=g[A],A+=1,w+=1;return g[$+O]=g[$+O+1],m[O]=m[O+1],O+=1,O<d?797:0}function I(){return g[$+d]=g[$+d+1],g[$+d+1]=0,m[d]=0,d-=1,v[2]=v[2]+1,0}var S,x,A,w,T,O,R,_,C,V,$,k,D,P,L,j,F,U,B,H,q,G,Y,X,W,Q,K;D=Math.min(o,h),A=2*o+D*(D+5)/2+2*h+1,X=1e-60;do X+=X,W=1+.1*X,Q=1+.2*X;while(W<=1||Q<=1);for(S=1;S<=o;S+=1)g[S]=r[S];for(S=o+1;S<=A;S+=1)g[S]=0;for(S=1;S<=h;S+=1)m[S]=0;if(T=[],0===y[1]){if(i(e,a,o,T),0!==T[1])return void(y[1]=2);n(e,a,o,r),t(e,a,o)}else{for(x=1;x<=o;x+=1)for(u[x]=0,S=1;S<=x;S+=1)u[x]=u[x]+e[S][x]*r[S];for(x=1;x<=o;x+=1)for(r[x]=0,S=x;S<=o;S+=1)r[x]=r[x]+e[x][S]*u[S]}for(s[1]=0,x=1;x<=o;x+=1)for(u[x]=r[x],s[1]=s[1]+g[x]*u[x],g[x]=0,S=x+1;S<=o;S+=1)e[S][x]=0;for(s[1]=-s[1]/2,y[1]=0,R=o,_=R+o,$=_+D,C=$+D+1,V=C+D*(D+1)/2,P=V+h,S=1;S<=h;S+=1){for(j=0,x=1;x<=o;x+=1)j+=l[x][S]*l[x][S];g[P+S]=Math.sqrt(j)}for(d=0,v[1]=0,v[2]=0,K=0;;){if(K=b(),999===K)return;for(;;){if(K=E(),0===K)break;if(999===K)return;if(700===K)if(O===d)I();else{for(;;)if(N(),K=M(),797!==K)break;I()}}}}function o(t,n,i,o,u,s){t=e(t),n=e(n),i=e(i);var l,c,f,h,p,m,d=[],v=[],g=[],y=[],b=[];if(u=u||0,s=s?e(s):[void 0,0],o=o?e(o):[],c=t.length-1,f=i[1].length-1,!o)for(l=1;l<=f;l+=1)o[l]=0;for(l=1;l<=f;l+=1)v[l]=0;for(h=0,p=Math.min(c,f),l=1;l<=c;l+=1)g[l]=0;for(d[1]=0,l=1;l<=2*c+p*(p+5)/2+2*f+1;l+=1)y[l]=0;for(l=1;l<=2;l+=1)b[l]=0;return a(t,n,c,c,g,d,i,o,c,f,u,v,h,b,y,s),m="",1===s[1]&&(m="constraints are inconsistent, no solution!"),2===s[1]&&(m="matrix D in quadratic function is not positive definite!"),{solution:r(g),value:r(d),unconstrained_solution:r(n),iterations:r(b),iact:r(v),message:m}}exports.solveQP=o}(numeric),numeric.svd=function(e){function r(e,r){return e=Math.abs(e),r=Math.abs(r),e>r?e*Math.sqrt(1+r*r/e/e):0==r?e:r*Math.sqrt(1+e*e/r/r)}var t,n=numeric.epsilon,i=1e-64/n,a=50,o=0,u=0,s=0,l=0,c=0,f=numeric.clone(e),h=f.length,p=f[0].length;if(h<p)throw"Need more rows than columns";var m=new Array(p),d=new Array(p);for(u=0;u<p;u++)m[u]=d[u]=0;var v=numeric.rep([p,p],0),g=0,y=0,b=0,E=0,N=0,M=0,I=0;for(u=0;u<p;u++){for(m[u]=y,I=0,c=u+1,s=u;s<h;s++)I+=f[s][u]*f[s][u];if(I<=i)y=0;else for(g=f[u][u],y=Math.sqrt(I),g>=0&&(y=-y),b=g*y-I,f[u][u]=g-y,s=c;s<p;s++){for(I=0,l=u;l<h;l++)I+=f[l][u]*f[l][s];for(g=I/b,l=u;l<h;l++)f[l][s]+=g*f[l][u]}for(d[u]=y,I=0,s=c;s<p;s++)I+=f[u][s]*f[u][s];if(I<=i)y=0;else{for(g=f[u][u+1],y=Math.sqrt(I),g>=0&&(y=-y),b=g*y-I,f[u][u+1]=g-y,s=c;s<p;s++)m[s]=f[u][s]/b;for(s=c;s<h;s++){for(I=0,l=c;l<p;l++)I+=f[s][l]*f[u][l];for(l=c;l<p;l++)f[s][l]+=I*m[l]}}N=Math.abs(d[u])+Math.abs(m[u]),N>E&&(E=N)}for(u=p-1;u!=-1;u+=-1){if(0!=y){for(b=y*f[u][u+1],s=c;s<p;s++)v[s][u]=f[u][s]/b;for(s=c;s<p;s++){for(I=0,l=c;l<p;l++)I+=f[u][l]*v[l][s];for(l=c;l<p;l++)v[l][s]+=I*v[l][u]}}for(s=c;s<p;s++)v[u][s]=0,v[s][u]=0;v[u][u]=1,y=m[u],c=u}for(u=p-1;u!=-1;u+=-1){for(c=u+1,y=d[u],s=c;s<p;s++)f[u][s]=0;if(0!=y){for(b=f[u][u]*y,s=c;s<p;s++){for(I=0,l=c;l<h;l++)I+=f[l][u]*f[l][s];for(g=I/b,l=u;l<h;l++)f[l][s]+=g*f[l][u]}for(s=u;s<h;s++)f[s][u]=f[s][u]/y}else for(s=u;s<h;s++)f[s][u]=0;f[u][u]+=1}for(n*=E,l=p-1;l!=-1;l+=-1)for(var S=0;S<a;S++){var x=!1;for(c=l;c!=-1;c+=-1){if(Math.abs(m[c])<=n){x=!0;break}if(Math.abs(d[c-1])<=n)break}if(!x){o=0,I=1;var A=c-1;for(u=c;u<l+1&&(g=I*m[u],m[u]=o*m[u],!(Math.abs(g)<=n));u++)for(y=d[u],b=r(g,y),d[u]=b,o=y/b,I=-g/b,s=0;s<h;s++)N=f[s][A],M=f[s][u],f[s][A]=N*o+M*I,f[s][u]=-N*I+M*o}if(M=d[l],c==l){if(M<0)for(d[l]=-M,s=0;s<p;s++)v[s][l]=-v[s][l];break}if(S>=a-1)throw"Error: no convergence.";for(E=d[c],N=d[l-1],y=m[l-1],b=m[l],g=((N-M)*(N+M)+(y-b)*(y+b))/(2*b*N),y=r(g,1),g=g<0?((E-M)*(E+M)+b*(N/(g-y)-b))/E:((E-M)*(E+M)+b*(N/(g+y)-b))/E,o=1,I=1,u=c+1;u<l+1;u++){for(y=m[u],N=d[u],b=I*y,y=o*y,M=r(g,b),m[u-1]=M,o=g/M,I=b/M,g=E*o+y*I,y=-E*I+y*o,b=N*I,N*=o,s=0;s<p;s++)E=v[s][u-1],M=v[s][u],v[s][u-1]=E*o+M*I,v[s][u]=-E*I+M*o;for(M=r(g,b),d[u-1]=M,o=g/M,I=b/M,g=o*y+I*N,E=-I*y+o*N,s=0;s<h;s++)N=f[s][u-1],M=f[s][u],f[s][u-1]=N*o+M*I,f[s][u]=-N*I+M*o}m[c]=0,m[l]=g,d[l]=E}for(u=0;u<d.length;u++)d[u]<n&&(d[u]=0);for(u=0;u<p;u++)for(s=u-1;s>=0;s--)if(d[s]<d[u]){for(o=d[s],d[s]=d[u],d[u]=o,l=0;l<f.length;l++)t=f[l][u],f[l][u]=f[l][s],f[l][s]=t;for(l=0;l<v.length;l++)t=v[l][u],v[l][u]=v[l][s],v[l][s]=t;u=s}return{U:f,S:d,V:v}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(require,module,exports){"use strict";function e(){this.name="SpreadSheetError",this.message=""}Object.defineProperty(exports,"__esModule",{value:!0}),e.prototype=new Error,e.prototype.constructor=e,e.prototype.toString=function(){return this.name+" => "+this.message},exports.SpreadSheetError=e},{}],6:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var r=require("./settings"),t=require("./core"),n=e(t),i=require("./polyfill"),a=e(i),o=(require("./plugins/xformulas/XFormulas"),require("./plugins/Plugin")),u=require("./plugins/persistent/Persistent"),s=e(u);n.default.globalSettings=r.globalSettings,n.default.defaultSettings=r.defaultSettings,n.default.version="0.3.0",n.default.plugins={Plugin:o.Plugin,registerPlugin:o.registerPlugin},(0,o.registerPlugin)("persistent",s.default),window.BrickSpreadSheet=n.default,(0,a.default)(window)},{"./core":7,"./plugins/Plugin":20,"./plugins/persistent/Persistent":22,"./plugins/xformulas/XFormulas":32,"./polyfill":54,"./settings":55}],7:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function t(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function n(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),a=require("./designer/Frame"),o=e(a),u=require("./designer/Workbook"),s=e(u),l=require("./utils/common"),c=require("./plugins/Plugin"),f=require("./utils/Emitter"),h=e(f),p=1,m=function(e){function a(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,a);var u=t(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return u.rootElement=e,u.getUserSettings(n),u.settings={},(0,l.extend)(u.settings,a.defaultSettings),(0,l.extend)(u.settings,u.userSettings),u.id=u.settings.id||u.getId(),u.displayMode=i,u._initPlugin(),u.frame=new o.default(u,u.settings.frame),u.workbook=new s.default(u,u.settings.workbook),u._enablePlugin(),u}return n(a,e),i(a,[{key:"getId",value:function(){return this.id||a.globalSettings.idPrefix+p++ +"-"+(0,l.randomString)()}},{key:"getRootElement",value:function(){return this.rootElement}},{key:"getDisplayMode",value:function(){return this.displayMode}},{key:"getUserSettings",value:function(e){return this.userSettings?this.userSettings:(e&&"string"==typeof e?this.userSettings=JSON.parse(e):this.userSettings=e,this.userSettings)}},{key:"getSettings",value:function(){return this.settings}},{key:"getExchangeData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.workbook._getExchange(),t=this.frame._getExchange(),n={workbook:r,frame:t,id:this.getId()};return e?n:JSON.stringify(n)}},{key:"getWorkbookInstance",value:function(){return this.workbook}},{key:"getFrameInstance",value:function(){return this.frame}},{key:"_initPlugin",value:function(){var e=this;this.plugins=new Map,(0,c.getAllPlugins)().forEach(function(r){var t=new r(e);(0,c.validatePlugin)(t),e.plugins.set(t.__name__,t)})}},{key:"_enablePlugin",value:function(){this.plugins.forEach(function(e){e.isEnable()&&e.enable()})}}]),a}(h.default);exports.default=m},{"./designer/Frame":9,"./designer/Workbook":13,"./plugins/Plugin":20,"./utils/Emitter":56,"./utils/common":57}],8:[function(require,module,exports){"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),t=(require("../utils/common"),function(){function t(r,n){e(this,t),this.initialConfig=r,this.sheet=n}return r(t,[{key:"translate",value:function(){for(var e={},r=Object.getPrototypeOf(this),t=Object.getOwnPropertyNames(r),n=0;n<t.length;++n)t[n].startsWith("_trans")&&this[t[n]].call(this,e);return e}},{key:"initSheetState",value:function(){for(var e=Object.getPrototypeOf(this),r=Object.getOwnPropertyNames(e),t=0;t<r.length;++t)r[t].startsWith("_init")&&this[r[t]].call(this)}},{key:"_transCell",value:function(e){var r=this.initialConfig.cellMetas;if(r){e.cell=[];for(var t=0;t<r.length;++t)for(var n=r[t],i=0;i<n.length;++i){var a=n[i];if(a){var o={};if(o.row=a.row,o.col=a.col,a.dataType){for(var u in a.dataType)a.dataType.hasOwnProperty(u)&&(o[u]=a.dataType[u]);o.type=a.dataType.typeName,delete o.typeName}if(a.styles){if(a.styles.alignments){var s=a.styles.alignments.join(" ht");o.className=o.className?o.className+=" ht"+s:"ht"+s}a.styles.fontFamily&&(o._style_fontFamily=a.styles.fontFamily),a.styles.fontSize&&(o._style_fontSize=a.styles.fontSize),a.styles.color&&(o._style_color=a.styles.color),a.styles.backgroundColor&&(o._style_backgroundColor=a.styles.backgroundColor),a.styles.fontStyle&&(o.className=o.className?o.className+=" ssd-font-"+a.styles.fontStyle:"ssd-font-"+a.styles.fontStyle),a.styles.fontWeight&&(o.className=o.className?o.className+=" ssd-font-bold":"ssd-font-bold"),a.styles.textDecoration&&(o.className=o.className?o.className+=" ssd-font-underline":"ssd-font-underline")}e.cell.push(o)}}}}},{key:"_transData",value:function(e){var r=this.initialConfig.data;r&&(e.minRows=this.sheet.initRows,e.minCols=this.sheet.initCols,e.data=r)}},{key:"_transColWidths",value:function(e){var r=this.initialConfig.colWidths;r&&(e.colWidths=r)}},{key:"_transRowHeights",value:function(e){var r=this.initialConfig.rowHeights;r&&(e.rowHeights=r)}},{key:"_transBorders",value:function(e){var r=this.initialConfig.borders;r&&(e.customBorders=r)}},{key:"_transMergeCells",value:function(e){var r=this.initialConfig.mergeCells;r&&(e.mergeCells=r)}},{key:"_initSelection",value:function(){var e=this.initialConfig.selection;e?this.sheet.select(e.row,e.col,e.endRow,e.endCol):this.sheet.select(0,0)}}]),t}());exports.default=t},{"../utils/common":57}],9:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),n=require("./frame/ContextMenu"),i=e(n),a=function(){function e(t,n){r(this,e),this.spreadSheet=t,this.contextMenu=new i.default(t)}return t(e,[{key:"_getExchange",value:function(){}}]),e}();exports.default=a},{"./frame/ContextMenu":16}],10:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function t(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function n(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),a=function e(r,t,n){null===r&&(r=Function.prototype);var i=Object.getOwnPropertyDescriptor(r,t);if(void 0===i){var a=Object.getPrototypeOf(r);return null===a?void 0:e(a,t,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},o=require("../utils/common.js"),u=require("./ConfigTranslator.js"),s=e(u),l=function(e){function u(e,n,i,a){r(this,u);var l={},c=new s.default(n,a),f=c.translate(),h=a.workbook.spreadSheet.getFrameInstance(),p=h.contextMenu.menuItems,m={};m.items=h.contextMenu.getMenuItems4HotTable(),m.callback=function(e){return function(r,t){if(p.has(r)){var n=p.get(r);n.handler&&n.handler.call(this,e,t.start,t.end,t)}}}(a),u._preference.contextMenu=m,(0,o.extend)(l,u._preference),(0,o.extend)(l,f),(0,o.extend)(l,i);var d=t(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e,l));return d._translator=c,Handsontable.hooks.add("beforeRenderer",function(e,r,t,n,i,a){e.style.color=a._style_color||"",e.style.fontFamily=a._style_fontFamily||"",e.style.fontSize=a._style_fontSize||"",e.style.backgroundColor=a._style_backgroundColor||""},d),["afterSelectionEnd"].forEach(function(e){Handsontable.hooks.add(e,function(){var r=[];r.push(e),r.push(a),r.push.apply(r,[].slice.call(arguments));var t=a.workbook.spreadSheet;t.emit.apply(t,r)},d)}),d}return n(u,e),i(u,[{key:"destroy",value:function(){a(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"destroy",this).call(this),delete this._translator}}]),u}(Handsontable);l._preference={outsideClickDeselects:!1,contextMenu:!0,
rowHeaders:!0,colHeaders:!0,manualColumnResize:!0,manualRowResize:!0,tableClassName:"ssd-handsontable",xFormulas:!0},exports.default=l},{"../utils/common.js":57,"./ConfigTranslator.js":8}],11:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function t(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function n(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),a=require("./views/Tabs"),o=(e(a),require("./HotTableAdaptor")),u=e(o),s=require("./SheetError"),l=require("./ext/Sheet_exchange"),c=require("./ext/Sheet_helper"),f=require("../utils/common"),h=require("../utils/Emitter"),p=e(h),m=150,d=50,v=(0,c.SheetHelper)((0,l.Exchange)(p.default)),g=function(e){function a(e,n){r(this,a);var i=t(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return i.workbook=e,i.$$view=e.$$view,i.settings=n,i.sheetName=n.name,i.initRows=m,i.initCols=d,i.fx={},i._render(),i}return n(a,e),i(a,[{key:"_render",value:function(){this.$$view.appendTab(this.sheetName);var e=this.$$view._hotTables.get(this.sheetName),r=e.container,t=e.width,n=e.height;this.handsontable=new u.default(r,this.settings,{width:t,height:n,readOnly:this.workbook.spreadSheet.getDisplayMode(),startRows:this.initRows,startCols:this.initCols,_isHotTableAdaptor:!0,_sheet:this},this),this.handsontable._translator.initSheetState(),this.$$view.hideContent(this.getName())}},{key:"getName",value:function(){return this.sheetName}},{key:"active",value:function(){this.workbook.activeSheet=this.getName(),this.$$view.activeTab(this.getName()),this.handsontable.render()}},{key:"isActive",value:function(){return this.workbook.activeSheet===this.getName()}},{key:"close",value:function(){this.workbook.closeSheet(this.getName())}},{key:"destroy",value:function(){this.handsontable.destroy(),this.workbook.sheets.delete(this.getName()),delete this.workbook,delete this.$$view}},{key:"rename",value:function(e){this.workbook.renameSheet(this.getName(),e)}},{key:"select",value:function(e,r,t,n){t=t||e,n=n||r,this.handsontable.selectCell(e,r,t,n,!1)}},{key:"getSelection",value:function(){var e=this.handsontable.getSelected();return{row:e[0],col:e[1],endRow:e[2],endCol:e[3]}}},{key:"mergeCells",value:function e(r,t,n,i){for(var a=0,o=[],e=this.handsontable.getSettings().mergeCells,u=[r,t,r+n-1,t+i-1],l=e.length;l;--l){var c=e[l-1],h=[c.row,c.col,c.row+c.rowspan-1,c.col+c.colspan-1];if(f.Coordinate.isEqual(u,h)){a=1;break}if(f.Coordinate.isSubset(u,h)){a=2;break}f.Coordinate.isSuperset(u,h)?(o.push(l-1),a=3):f.Coordinate.intersection(u,h)&&(a=4)}if(0===a||3===a){if(3===a)for(var p=0;p<o.length;++p)e.splice(o[p],1);e=e||[],e.push({row:r,col:t,rowspan:n,colspan:i}),this.handsontable.updateSettings({mergeCells:e})}else if(2===a||4===a)throw new s.SheetError(": ["+r+", "+t+", "+n+", "+i+"]")}},{key:"unMergeCells",value:function(e,r,t,n){var i=this.handsontable.getSettings().mergeCells,a=[];if(i&&i.length)for(var o=0;o<i.length;++o)f.Coordinate.isSubset([i[o].row,i[o].col,i[o].row+i[o].rowspan-1,i[o].col+i[o].colspan-1],[e,r,e+t-1,r+n-1])||a.push(i[o]);this.handsontable.updateSettings({mergeCells:0!==a.length&&a})}},{key:"spliceClass",value:function(e,r){for(var t=arguments.length,n=Array(t>2?t-2:0),i=2;i<t;i++)n[i-2]=arguments[i];var a=this;this._walkonCellMetas(e,function(e,t,i){return{className:(a._removeFormerClass(i.className,n)+" "+r).trim()}},{className:r})}},{key:"setFontBold",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getSelection();e?this.spliceClass(r,"ssd-font-bold","ssd-font-bold"):this.spliceClass(r,"","ssd-font-bold"),this.handsontable.render()}},{key:"setFontItalic",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getSelection();e?this.spliceClass(r,"ssd-font-italic","ssd-font-italic"):this.spliceClass(r,"","ssd-font-italic"),this.handsontable.render()}},{key:"setFontUnderline",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getSelection();e?this.spliceClass(r,"ssd-font-underline","ssd-font-underline"):this.spliceClass(r,"","ssd-font-underline"),this.handsontable.render()}},{key:"setFontColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getSelection();this._walkonCellMetas(r,function(){return{_style_color:e}},{_style_color:e}),this.handsontable.render()}},{key:"setFontFamily",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getSelection();this._walkonCellMetas(r,function(){return{_style_fontFamily:e}},{_style_fontFamily:e}),this.handsontable.render()}},{key:"setFontSize",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getSelection();this._walkonCellMetas(r,function(){return{_style_fontSize:e}},{_style_fontSize:e}),this.handsontable.render()}},{key:"setBackgroundColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getSelection();this._walkonCellMetas(r,function(){return{_style_backgroundColor:e}},{_style_backgroundColor:e}),this.handsontable.render()}},{key:"setBorder",value:function(e,r,t,n,i){var a={range:e,top:r};a.right=t||r,a.bottom=n||r,a.left=i||a.right;var o=this.handsontable.getSettings().customBorders||[];o.push(a),this.handsontable.updateSettings({customBorders:o})}}]),a}(v);exports.default=g},{"../utils/Emitter":56,"../utils/common":57,"./HotTableAdaptor":10,"./SheetError":12,"./ext/Sheet_exchange":14,"./ext/Sheet_helper":15,"./views/Tabs":18}],12:[function(require,module,exports){"use strict";function e(e){this.name="SheetError",this.message=e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SheetError=e;var r=require("../SpreadSheetError");e.prototype=new r.SpreadSheetError,e.prototype.constructor=e},{"../SpreadSheetError":5}],13:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function e(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),i=require("./views/Tabs"),a=e(i),o=require("./Sheet"),u=e(o),s=require("./SheetError"),l=require("../utils/dataStructure"),c=require("../utils/common"),f=require("../settings"),h=f.globalSettings.sheet.sheetName,p=function(){function e(t,n){var i=this;r(this,e),this.spreadSheet=t,this.sheets=new l.CaseInsensitiveMap,this.settings=n,this._initSettings(n),this.$$view=new a.default(this),n.sheets.forEach(function(e){return i.createSheet(e)});var o=this.getSheet(this.activeSheet);if(!o)throw new s.SheetError(" activeSheet : "+this.activeSheet);o.active()}return n(e,[{key:"_initSettings",value:function(e){for(var r=Object.keys(e),t=0,n=r.length;t<n;++t)"sheets"!==r[t]&&(this[r[t]]=e[r[t]])}},{key:"getSettings",value:function(){return this.spreadSheet.getSettings()}},{key:"getId",value:function(){return this.id||(this.id=this.spreadSheet.getId()+f.globalSettings.idSuffix4Workbook)}},{key:"getSheet",value:function(e){return this.sheets.get(e)}},{key:"getSheets",value:function(){return this.sheets}},{key:"getSheetNames",value:function(){return this.sheets.keys()}},{key:"isSheetExist",value:function(e,r){return r?this.sheets.hasExact(e):this.sheets.has(e)}},{key:"_getAutoSheetIndex",value:function(){return this.$$autoSheetIndex||(this.$$autoSheetIndex=0),++this.$$autoSheetIndex}},{key:"_getAutoSheetName",value:function(){var e=f.globalSettings.sheet.autoPrefix+"",r=e+this._getAutoSheetIndex();return this.isSheetExist(r)?this._getAutoSheetName():r}},{key:"getActiveSheet",value:function(){return this.sheets.get(this.activeSheet)}},{key:"createSheet",value:function(e){e?this._validateSheetName(e.name):(e={},e.name=this._getAutoSheetName());var r=new u.default(this,e);return this.sheets.set(e.name,r),r}},{key:"destroySheet",value:function(e){"string"==typeof e&&(e=this.getSheet(e)),e.destroy()}},{key:"renameSheet",value:function(e,r){var t=this.getSheet(e);if(!t)throw new s.SheetError(' "'+e+'" ');e!==r?(this._validateSheetName(r,(0,c.upperCase)(e)===(0,c.upperCase)(r)),t.sheetName=r,this.activeSheet===e&&(this.activeSheet=r),this.getSheets().delete(e),this.getSheets().set(r,t),this.$$view.tabRename(e,r)):this.$$view.tabRenameCancel(e,r)}},{key:"closeSheet",value:function(e){var r=this.getSheet(e);if(!r)throw new s.SheetError(' "'+e+'" ');if(1===this.sheets.size())throw new s.SheetError(' "'+e+'" ');if(r.isActive()){var t=!0,n=!1,i=void 0;try{for(var a,o=this.sheets.keys()[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var u=a.value;if(u&&u!==e){this.activeSheet=u,this.getSheet(u).active();break}}}catch(e){n=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}}this.sheets.delete(e),this.$$view.removeTab(e),this.destroySheet(r)}},{key:"active",value:function(){this.getActiveSheet().active()}},{key:"activeSheet",value:function(e){var r=this.getSheet(e);r&&r.active()}},{key:"_validateSheetName",value:function(e,r){if(!e)throw new s.SheetError("");if(h.test(e))throw new s.SheetError(' "'+e+'" ');if(this.isSheetExist(e,r))throw new s.SheetError(' "'+e+'" ')}},{key:"_getExchange",value:function(){var e=[],r=!0,n=!1,i=void 0;try{for(var a,o=this.getSheets().toMap()[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var u=t(a.value,2),s=u[1];s&&e.push(s._getExchange())}}catch(e){n=!0,i=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw i}}return{activeSheet:this.activeSheet,sheets:e}}}]),e}();exports.default=p},{"../settings":55,"../utils/common":57,"../utils/dataStructure":58,"./Sheet":11,"./SheetError":12,"./views/Tabs":18}],14:[function(require,module,exports){"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function r(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function t(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();exports.Exchange=function(i){return function(i){function a(){return e(this,a),r(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return t(a,i),n(a,[{key:"_getExchange",value:function(){var e=this._getDataMeta(),r=e.data,t=e.cells,n=this._getSizeEx(),i=n.heights,a=n.widths,o=this.handsontable.getSettings().mergeCells;return o===!1&&(o=null),{name:this.getName(),selection:this.getSelection(),data:r.length?r:[]._,rowHeights:i,colWidths:a,mergeCells:o,cellMetas:t}}},{key:"_getStylesEx",value:function(e){var r={},t=this._getAlignmentEx(e.className);return t&&(r.alignments=t),this._getFontEx(e,r),this._getBgColorEx(e,r),r}},{key:"_getBgColorEx",value:function(e,r){e._style_backgroundColor&&(r.backgroundColor=e._style_backgroundColor)}},{key:"_getFontEx",value:function(e,r){e._style_fontFamily&&(r.fontFamily=e._style_fontFamily),e.className&&e.className.contains("ssd-font-italic")&&(r.fontStyle="italic"),e.className&&e.className.contains("ssd-font-bold")&&(r.fontWeight="bold"),e.className&&e.className.contains("ssd-font-underline")&&(r.textDecoration="underline"),e._style_color&&(r.color=e._style_color)}},{key:"_getAlignmentEx",value:function(e){var r=[];return e&&(e.contains("htLeft")&&r.push("Left"),e.contains("htCenter")&&r.push("Center"),e.contains("htRight")&&r.push("Right"),e.contains("htJustify")&&r.push("Justify"),e.contains("htTop")&&r.push("Top"),e.contains("htMiddle")&&r.push("Middle"),e.contains("htBottom")&&r.push("Bottom")),!!r.length&&r}},{key:"_getSizeEx",value:function(){for(var e=this.handsontable,r=Math.max(e.countCols()-e.countEmptyCols(!0),20),t=Math.max(e.countRows()-e.countEmptyRows(!0),50),n=[],i=[],a=0;a<t;++a){var o=e.getRowHeight(a);0!==a||o||(o=24),n.push(o)}for(var u=0;u<r;++u)i.push(e.getColWidth(u));return{heights:n,widths:i}}},{key:"_getDataMeta",value:function(){for(var e=this.handsontable,r=e.countCols()-e.countEmptyCols(!0),t=e.countRows()-e.countEmptyRows(!0),n=[],i=[],a=0;a<t;++a){for(var o=[],u=[],s=0;s<r;++s){var l=e.getSourceDataAtCell(a,s),c=e.getCellMeta(a,s),f=e.getDataAtCell(a,s),h={};h.row=a,h.col=s,h.isFormula=!(!l||"="!==(l+"").charAt(0)),h.sourceValue=l,h.value=f,function(e,r){for(var t in e)return void(r.styles=e)}(this._getStylesEx(c),h),o.push(l),u.push(h)}n.push(o),i.push(u)}return{data:n,cells:i}}},{key:"_getBordersEx",value:function(){}}]),a}(i)}},{}],15:[function(require,module,exports){"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function r(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function t(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();exports.SheetHelper=function(i){return function(i){function a(){return e(this,a),r(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return t(a,i),n(a,[{key:"_defaultSelection",value:function(e){return{startRow:e.row,endRow:e.endRow||e.row,startCol:e.col,endCol:e.endCol||e.col}}},{key:"_removeFormerClass",value:function(e){if(!e)return"";for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];var i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;e=e.split(l).join("")}}catch(e){a=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(a)throw o}}return e.trim()}},{key:"_walkonCellMetas",value:function(e,r,t){for(var n=this._defaultSelection(e),i=n.startRow,a=n.endRow,o=n.startCol,u=n.endCol,s=i;s<=a;++s)for(var l=o;l<=u;++l){var c=this.handsontable.getCellMeta(s,l);if(c){var f=r.call(this,s,l,c);f&&this.handsontable.setCellMetaObject(s,l,f)}else t&&this.handsontable.setCellMetaObject(s,l,t)}}},{key:"_walkonCells",value:function(e,r){for(var t=this._defaultSelection(e),n=t.startRow,i=t.endRow,a=t.startCol,o=t.endCol,u=n;u<=i;++u)for(var s=a;s<=o;++s){var l=this.handsontable.getCell(u,s,!0);l&&r.call(this,u,s,l)}}}]),a}(i)}},{}],16:[function(require,module,exports){"use strict";function e(e){this.spreadSheet=e,this.menuItems=new Map,this._init()}function r(e){var r=this.getSettings().mergeCells;if(r&&r.length)for(var t=0;t<r.length;++t){var i=r[t],a=i.row,o=i.col,u=i.rowspan,s=i.colspan;if(n.Coordinate[e]([a,o,a+u-1,o+s-1],this.getSelected()))return!1}return!0}Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function e(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=require("../../utils/common"),i=require("./ContextMenu_alignment");exports.default=e,e.prototype.register=function(e,r,t){this.menuItems.set(e,{config:r,handler:t})},e.prototype.getMenuItems4HotTable=function(){var e=this;return this._hotTableItems||(this._hotTableItems={},this.menuItems.forEach(function(r,t){var n=r.config;return e._hotTableItems[t]=n})),this._hotTableItems},e.prototype._init=function(){var e="---------";this.register("row_above",{name:"",disabled:function(){return!1}}),this.register("row_below",{name:""}),this.register("hsep1",e),this.register("col_left",{name:""}),this.register("col_right",{name:""}),this.register("hsep2",e),this.register("remove_row",{name:"",disabled:function(){return!1}}),this.register("remove_col",{name:""}),this.register("hsep3",e),this.register("alignment",(0,i.alignmentItem)()),this.register("hsep4",e),this.register("q_merge_cells",{name:"",disabled:function(){var e=this.getSelected(),n=t(e,4),i=n[0],a=n[1],o=n[2],u=n[3];return i===o&&a===u||!r.call(this,"isEqual")}},function(e,r,t){e.mergeCells(r.row,r.col,t.row-r.row+1,t.col-r.col+1)}),this.register("q_cancel_merge_cells",{name:"",disabled:function(){return r.call(this,"isSubset")}},function(e,r,t){e.unMergeCells(r.row,r.col,t.row-r.row+1,t.col-r.col+1)})}},{"../../utils/common":57,"./ContextMenu_alignment":17}],17:[function(require,module,exports){"use strict";function e(){return{name:"",disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)},submenu:{items:[{key:"alignment:left",name:function(){var e=this,n=r(this.getSelectedRange(),function(r,t){var n=e.getCellMeta(r,t).className;if(n&&n.indexOf("htLeft")!==-1)return!0});return n?t(""):""},callback:function(){var e=this,r=this.getSelectedRange(),t=n(r,function(r,t){return e.getCellMeta(r,t).className}),a="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",t,r,a,o),i(r,a,o,function(r,t){return e.getCellMeta(r,t)}),this.render()},disabled:!1},{key:"alignment:center",name:function(){var e=this,n=r(this.getSelectedRange(),function(r,t){var n=e.getCellMeta(r,t).className;if(n&&n.indexOf("htCenter")!==-1)return!0});return n?t(""):""},callback:function(){var e=this,r=this.getSelectedRange(),t=n(r,function(r,t){return e.getCellMeta(r,t).className}),a="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",t,r,a,o),i(r,a,o,function(r,t){return e.getCellMeta(r,t)}),this.render()},disabled:!1},{key:"alignment:right",name:function(){var e=this,n="",i=r(this.getSelectedRange(),function(r,t){var n=e.getCellMeta(r,t).className;if(n&&n.indexOf("htRight")!==-1)return!0});return i&&(n=t(n)),n},callback:function(){var e=this,r=this.getSelectedRange(),t=n(r,function(r,t){return e.getCellMeta(r,t).className}),a="horizontal",o="htRight";this.runHooks("beforeCellAlignment",t,r,a,o),i(r,a,o,function(r,t){return e.getCellMeta(r,t)}),this.render()},disabled:!1},{key:"alignment:justify",name:function(){var e=this,n="",i=r(this.getSelectedRange(),function(r,t){var n=e.getCellMeta(r,t).className;if(n&&n.indexOf("htJustify")!==-1)return!0});return i&&(n=t(n)),n},callback:function(){var e=this,r=this.getSelectedRange(),t=n(r,function(r,t){return e.getCellMeta(r,t).className}),a="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",t,r,a,o),i(r,a,o,function(r,t){return e.getCellMeta(r,t)}),this.render()},disabled:!1},{name:"---------"},{key:"alignment:top",name:function(){var e=this,n="",i=r(this.getSelectedRange(),function(r,t){var n=e.getCellMeta(r,t).className;if(n&&n.indexOf("htTop")!==-1)return!0});return i&&(n=t(n)),n},callback:function(){var e=this,r=this.getSelectedRange(),t=n(r,function(r,t){return e.getCellMeta(r,t).className}),a="vertical",o="htTop";this.runHooks("beforeCellAlignment",t,r,a,o),i(r,a,o,function(r,t){return e.getCellMeta(r,t)}),this.render()},disabled:!1},{key:"alignment:middle",name:function(){var e=this,n="",i=r(this.getSelectedRange(),function(r,t){var n=e.getCellMeta(r,t).className;if(n&&n.indexOf("htMiddle")!==-1)return!0});return i&&(n=t(n)),n},callback:function(){var e=this,r=this.getSelectedRange(),t=n(r,function(r,t){return e.getCellMeta(r,t).className}),a="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",t,r,a,o),i(r,a,o,function(r,t){return e.getCellMeta(r,t)}),this.render()},disabled:!1},{key:"alignment:bottom",name:function(){var e=this,n="",i=r(this.getSelectedRange(),function(r,t){var n=e.getCellMeta(r,t).className;if(n&&n.indexOf("htBottom")!==-1)return!0});return i&&(n=t(n)),n},callback:function(){var e=this,r=this.getSelectedRange(),t=n(r,function(r,t){return e.getCellMeta(r,t).className}),a="vertical",o="htBottom";this.runHooks("beforeCellAlignment",t,r,a,o),i(r,a,o,function(r,t){return e.getCellMeta(r,t)}),this.render()},disabled:!1}]}}}function r(e,r){var t=!1;return e&&e.forAll(function(e,n){if(r(e,n))return t=!0,!1}),t}function t(e){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+e}function n(e,r){for(var t={},n=e.from.row;n<=e.to.row;n++)for(var i=e.from.col;i<=e.to.col;i++)t[n]||(t[n]=[]),t[n][i]=r(n,i);return t}function i(e,r,t,n){if(e.from.row==e.to.row&&e.from.col==e.to.col)a(e.from.row,e.from.col,r,t,n);else for(var i=e.from.row;i<=e.to.row;i++)for(var o=e.from.col;o<=e.to.col;o++)a(i,o,r,t,n)}function a(e,r,t,n,i){var a=i(e,r),s=n;a.className&&(s="vertical"===t?o(a.className,n):u(a.className,n)),a.className=s}function o(e,r){return e.indexOf(r)!=-1?e:(e=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),e+=" "+r)}function u(e,r){return e.indexOf(r)!=-1?e:(e=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),e+=" "+r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.alignmentItem=e},{}],18:[function(require,module,exports){"use strict";function e(e){this.workbook=e,this.liItems=new n.CaseInsensitiveMap,this.sectionItems=new n.CaseInsensitiveMap,this._hotTables=new Map,this.rootElement=e.spreadSheet.getRootElement(),this.displayMode=e.spreadSheet.getDisplayMode(),this.initDOM(),this.initBox(),this.render()}Object.defineProperty(exports,"__esModule",{value:!0});var r=require("../../utils/domHelper.js"),t=require("../../utils/common.js"),n=require("../../utils/dataStructure.js"),i=require("../../utils/eventHelper.js"),a=require("../../settings.js"),o=require("../../i18n"),u=require(".././SheetError"),s="current",l="ssd-tabs",c="ssd-tabs-content",f="ssd-tabs-section",h="ssd-tabs-nav",p="ssd-tabs-ul",m="ssd-tabs-li",d="ssd-tabs-fx",v=a.globalSettings.sheet.animated,g=a.globalSettings.sheet.sheetName;e.prototype.render=function(){this.rootElement.appendChild(this.TABS)},e.prototype.initDOM=function(){this.TABS=document.createElement("div"),this.CONTENT=document.createElement("div"),this.NAV=document.createElement("nav"),this.UL=document.createElement("ul"),this.TABS.classList.add(l),this.TABS.id=this.workbook.getId(),this.CONTENT.classList.add(c),this.NAV.classList.add(h),this.UL.classList.add(p),this.TABS.appendChild(this.CONTENT),this.TABS.appendChild(this.NAV),this.NAV.appendChild(this.UL),this.appendAddButton()},e.prototype.initBox=function(){var e=this.workbook.spreadSheet.getRootElement();this.width=this.workbook.width||(0,r.outerWidth)(e,!1),this.height=this.workbook.height||(0,r.outerHeight)(e,!1),this.TABS.style.width=this.width+"px",this.TABS.style.height=this.height+"px"},e.prototype.appendTab=function(e){var t=this,n=document.createElement("li"),a=this.displayMode?"":"close hairline";n.innerHTML='\n        <a href="javascript:;">\n            <span>'+e+'</span>\n            <span class="'+a+'"></span>\n        </a>\n    ',n.classList.add(m),n.setAttribute("data-sheet",e);var o=this.TABS.querySelector("."+s+"."+m);o?(0,r.insertAfter)(o,n):this.UL.appendChild(n),this.liItems.set(e,n),n.addEventListener("click",function(e){var r=this.dataset.sheet,n=t.workbook.getSheet(r);n.active(),(0,i.stopImmediatePropagation)(e)}),this.displayMode||(n.addEventListener("dblclick",function(e){t._onTabDblclick.call(t,this),(0,i.stopImmediatePropagation)(e)}),n.querySelector(".close").addEventListener("click",function(e){var r=n.dataset.sheet;try{t.workbook.closeSheet(r)}catch(e){if(!(e instanceof u.SheetError))throw e;alert(e.message)}(0,i.stopImmediatePropagation)(e)})),this.appendContent(e)},e.prototype.removeTab=function(e){var r=this.liItems.get(e);this.UL.removeChild(r),this.liItems.delete(e),this.removeContent(e)},e.prototype.appendAddButton=function(){var e=this,r=document.createElement("li"),t=this.displayMode?"&nbsp;":"+";r.innerHTML='<a href="javascript:;"><span>'+t+"</span></a>",r.classList.add(m),this.displayMode||r.classList.add("add-tab"),this.UL.appendChild(r),this.displayMode||r.addEventListener("click",function(){try{var r=e.workbook.createSheet();r.active()}catch(e){if(!(e instanceof u.SheetError))throw e;alert(e.message)}})},e.prototype._onTabDblclick=function(e){var t=this,n=e.dataset.sheet,i=e.getElementsByTagName("span")[0],a=document.createElement("input");a.setAttribute("type","text"),a.value=n,a.classList.add("editorial"),a.style.width=(0,r.outerWidth)(i)+20+"px",a.addEventListener("blur",function(){var e=t._checkTabName(n,this.value);e===!0?t.workbook.renameSheet(n,this.value):(alert(e),t.tabRenameCancel(n,this.value))}),a.addEventListener("keypress",function(e){13===e.keyCode&&this.blur()}),(0,r.empty)(i),i.appendChild(a),a.select()},e.prototype._checkTabName=function(e,r){return(0,t.isEmptyValue)(r)?o.WARNS.S1:g.test(r)?o.WARNS.S2:(0,t.upperCase)(e)===(0,t.upperCase)(r)||!this.workbook.isSheetExist(r)||o.WARNS.S3},e.prototype.tabRename=function(e,t){var n=this.liItems.get(e),i=n.getElementsByTagName("span")[0];(0,r.innerHTML)(i,t),n.dataset.sheet=t,this.liItems.set(t,n);var a=this.sectionItems.get(e);a.dataset.sheet=t,this.sectionItems.delete(e),this.sectionItems.set(t,a);var o=this.workbook.getSheet(t);o.emit("afterRename",o,e,t)},e.prototype.tabRenameCancel=function(e,t){var n=this.liItems.get(e),i=n.getElementsByTagName("span")[0];(0,r.innerHTML)(i,e);var a=this.workbook.getSheet(e);a.emit("afterRenameCancel",a,e,t)},e.prototype.appendContent=function(e){var r=document.createElement("section"),t=document.createElement("div"),n=document.createElement("div");r.setAttribute("data-sheet",e),r.appendChild(t),r.appendChild(n),r.classList.add(f),v&&r.classList.add("ssd-animated-fast"),this.CONTENT.appendChild(r),this.sectionItems.set(e,r),this.appendFx(t,e),this.appendTable(n,e)},e.prototype.removeContent=function(e){var r=this.sectionItems.get(e);this.CONTENT.removeChild(r),this.sectionItems.delete(e)},e.prototype.hideContent=function(e){var r=this.sectionItems.get(e);r.style.display="none"},e.prototype.appendFx=function(e,r){e.classList.add(d),e.classList.add(d+"-"+r)},e.prototype.appendTable=function(e,t){var n=this;this._hotTables.set(t,{container:e,width:this.width,height:function(){return n.height-(0,r.outerHeight)(n.NAV)}})},e.prototype.activeTab=function(e){var r=this.TABS.querySelector("."+s+"."+m);r&&r.classList.remove(s);var t=this.liItems.get(e);t.classList.add(s),this.activeContent(e)},e.prototype.activeContent=function(e){var r=this.sectionItems.get(e),t=this._formerActiveContent;t&&(v&&t.classList.remove("fadeIn"),t.style.display="none"),r.style.display="block",v&&r.classList.add("fadeIn"),this._formerActiveContent=r},exports.default=e},{"../../i18n":19,"../../settings.js":55,"../../utils/common.js":57,"../../utils/dataStructure.js":58,"../../utils/domHelper.js":59,"../../utils/eventHelper.js":60,".././SheetError":12}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.WARNS={S1:"",S2:": :  / ? * [ ]",S3:""}},{}],20:[function(require,module,exports){"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function r(e){if(!e.enable)throw new o.PluginError("enable");if(!e.destroy)throw new o.PluginError("destroy")}function t(e,r){u.set(e,r),r.prototype.__name__=e}function n(e){var r=u.get(e);if(!r)throw new o.PluginError(""+e);return r}function i(){return u}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Plugin=void 0;var a=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();exports.validatePlugin=r,exports.registerPlugin=t,exports.getPlugin=n,exports.getAllPlugins=i;var o=require("./PluginError"),u=new Map,s=function(){function r(t){e(this,r),this.spreadsheet=t,this.enabled=!1}return a(r,[{key:"_registerMethod",value:function(e){var r=this,t=this.spreadsheet.constructor.prototype;t[e]=function(){return r[e]()}}},{key:"isEnable",value:function(){return!1}},{key:"enable",value:function(){}},{key:"destroy",value:function(){}}]),r}();exports.Plugin=s},{"./PluginError":21}],21:[function(require,module,exports){"use strict";function e(e){this.name="PluginError",this.message=e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.PluginError=e;var r=require("../SpreadSheetError");e.prototype=new r.SpreadSheetError,e.prototype.constructor=e},{"../SpreadSheetError":5}],22:[function(require,module,exports){"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function r(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function t(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),i=function e(r,t,n){null===r&&(r=Function.prototype);
var i=Object.getOwnPropertyDescriptor(r,t);if(void 0===i){var a=Object.getPrototypeOf(r);return null===a?void 0:e(a,t,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},a=require("../Plugin"),o=require("./Storage"),u=function(a){function u(t){e(this,u);var n=r(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,t)),i=n.spreadsheet.settings;return i.persistent===!0?n.persistentKey=t.getId():n.persistentKey=i.persistent.key,n.spreadsheet.settings=o.Storage.load(n.persistentKey)||i,n._registerMethod("saveState"),n}return t(u,a),n(u,[{key:"isEnable",value:function(){return!!this.spreadsheet.getSettings().persistent}},{key:"enable",value:function(){i(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"enable",this).call(this)}},{key:"destroy",value:function(){i(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"destroy",this).call(this)}},{key:"saveState",value:function(){var e=this.spreadsheet.getExchangeData();o.Storage.save(this.persistentKey,e)}}]),u}(a.Plugin);exports.default=u},{"../Plugin":20,"./Storage":23}],23:[function(require,module,exports){"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),t=function(){function t(){e(this,t)}return r(t,null,[{key:"save",value:function(e,r){"string"!=typeof r&&(r=JSON.stringify(r)),window.localStorage.setItem(t.PREFIX+e,r)}},{key:"load",value:function(e){var r=window.localStorage.getItem(t.PREFIX+e);try{return JSON.parse(r)}catch(e){return r}}},{key:"remove",value:function(e){window.localStorage[t.PREFIX+e]&&window.localStorage.removeItem(t.PREFIX+e)}},{key:"clear",value:function(){window.localStorage.clear()}}]),t}();t.PREFIX="$$brick!storage-",exports.Storage=t},{}],24:[function(require,module,exports){"use strict";function e(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.AlterManager=void 0;var t=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),n=require("./CellValue"),i=require("./utils"),a=require("./expressionModifier"),o=Handsontable.helper.arrayEach,u=Handsontable.helper.mixin,s=Handsontable.utils.localHooks,l=function(){function u(e){r(this,u),this.sheet=e,this.dataProvider=e.dataProvider,this.matrix=e.matrix}return t(u,[{key:"insertRow",value:function(e,r,t){this._alter("insert","row",e,r,t)}},{key:"removeRow",value:function(e,r,t){this._alter("remove","row",e,-r,t)}},{key:"insertColumn",value:function(e,r,t){this._alter("insert","column",e,r,t)}},{key:"removeColumn",value:function(e,r,t){this._alter("remove","column",e,-r,t)}},{key:"_alter",value:function(r,t,u,s){var l=this,c=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],f=function(e){return{row:"row"===t?u:e.row,column:"column"===t?u:e.column}},h=function(e,r){o(l.matrix.cellReferences,function(n){n[t]>=u&&n.translateTo(e,r)})},p=[],m=Math.abs(s)-1;"row"===t?p.push(s,0):"column"===t&&p.push(0,s),"remove"===r&&!function(){var r=l.matrix.removeCellRefsAtRange(e({},t,u),e({},t,u+m)),i=[];o(l.matrix.data,function(e){o(r,function(r){e.hasPrecedent(r)&&(e.removePrecedent(r),e.setState(n.CellValue.STATE_OUT_OFF_DATE),o(l.sheet.getCellDependencies(e.row,e.column),function(e){e.setState(n.CellValue.STATE_OUT_OFF_DATE)}))}),e[t]>=u&&e[t]<=u+m&&i.push(e)}),l.matrix.remove(i)}(),h.apply(void 0,p),o(this.matrix.data,function(r){var o=r.row,h=r.column;if(r[t]>=u&&(r.translateTo.apply(r,p),r.setState(n.CellValue.STATE_OUT_OFF_DATE)),c){var m=r.row,d=r.column,v=l.dataProvider.getSourceDataAtCell(m,d);if((0,i.isFormulaExpression)(v)){var g=new a.ExpressionModifier(v);g.translate(f({row:o,column:h}),e({},t,s)),l.dataProvider.updateSourceData(m,d,g.toString())}}}),this.runLocalHooks("afterAlter",r,t,u,s)}},{key:"destroy",value:function(){this.sheet=null,this.dataProvider=null,this.matrix=null}}]),u}();u(l,s),exports.AlterManager=l},{"./CellValue":27,"./expressionModifier":33,"./utils":53}],25:[function(require,module,exports){"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),t=require("./parser/utils"),n=Handsontable.helper.isObject,i=function(){function i(r,t){e(this,i);var a=n(r),o=n(t);this._row=a?r.index:r,this.rowAbsolute=!!a&&r.isAbsolute,this._column=o?t.index:t,this.columnAbsolute=!!o&&t.isAbsolute,this.rowOffset=0,this.columnOffset=0,Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(e){this._row=e},enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(e){this._column=e},enumerable:!0,configurable:!0})}return r(i,[{key:"translateTo",value:function(e,r){this.row=this.row+e,this.column=this.column+r}},{key:"isEqual",value:function(e){return e.row===this.row&&e.column===this.column}},{key:"toString",value:function(){return(0,t.toLabel)({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}}]),i}();exports.default=i},{"./parser/utils":52}],26:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function t(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function n(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CellReference=void 0;var i=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),a=require("./BaseCell"),o=e(a),u=require("./parser/utils"),s=function(e){function a(e,n){return r(this,a),t(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,n))}return n(a,e),i(a,[{key:"toString",value:function(){return(0,u.toLabel)({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}}]),a}(o.default);exports.CellReference=s},{"./BaseCell":25,"./parser/utils":52}],27:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function t(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function n(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CellValue=void 0;var i=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),a=require("./BaseCell"),o=e(a),u=require("./parser/error"),s=1,l=2,c=3,f=[s,l,c],h=Handsontable.helper.arrayFilter,p=function(e){function a(e,n){r(this,a);var i=t(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,n));return i.precedents=[],i.value=null,i.error=null,i.state=a.STATE_UP_TO_DATE,i}return n(a,e),i(a,null,[{key:"STATE_OUT_OFF_DATE",get:function(){return 1}},{key:"STATE_COMPUTING",get:function(){return 2}},{key:"STATE_UP_TO_DATE",get:function(){return 3}}]),i(a,[{key:"setValue",value:function(e){this.value=e}},{key:"getValue",value:function(){return this.value}},{key:"setError",value:function(e){this.error=e}},{key:"getError",value:function(){return this.error}},{key:"hasError",value:function(){return null!==this.error}},{key:"setState",value:function(e){if(f.indexOf(e)===-1)throw": "+e;this.state=e}},{key:"isState",value:function(e){return this.state===e}},{key:"addPrecedent",value:function(e){if(this.isEqual(e))throw Error(u.ERROR_REF);this.hasPrecedent(e)||this.precedents.push(e)}},{key:"removePrecedent",value:function(e){if(this.isEqual(e))throw Error(u.ERROR_REF);this.precedents=h(this.precedents,function(r){return!r.isEqual(e)})}},{key:"getPrecedents",value:function(){return this.precedents}},{key:"hasPrecedents",value:function(){return this.precedents.length>0}},{key:"hasPrecedent",value:function(e){return!!h(this.precedents,function(r){return r.isEqual(e)}).length}}]),a}(o.default);exports.CellValue=p},{"./BaseCell":25,"./parser/error":34}],28:[function(require,module,exports){"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.DataProvider=void 0;var r=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),t=require("./utils"),n=Handsontable.helper.arrayEach,i=(Handsontable.helper.rangeEach,function(){function i(r){e(this,i),this.hot=r,this.changes={}}return r(i,[{key:"collectChanges",value:function(e,r,n){(0,t.isFormulaExpression)(n)||(this.changes[i._coordId(e,r)]=n)}},{key:"clearChanges",value:function(){this.changes={}}},{key:"isInDataRange",value:function(e,r){return e>=0&&e<this.hot.countRows()&&r>=0&&r<this.hot.countCols()}},{key:"getDataAtCell",value:function(e,r){var t=i._coordId(e,r),n=void 0;return n=this.changes.hasOwnProperty(t)?this.changes[t]:this.hot.getDataAtCell(e,r)}},{key:"getDataAtCellInSheet",value:function(e,r,t){var n=this.workbook.getSheet(e),i=n.handsontable.getPlugin("XFormulas");return i.sheet.dataProvider.getDataAtCell(r,t)}},{key:"getDataByRange",value:function(e,r,t,a){var o=this,u=this.hot.getData(e,r,t,a);return n(u,function(t,a){n(t,function(t,n){var s=i._coordId(a+e,n+r);o.changes.hasOwnProperty(s)&&(u[a][n]=o.changes[s])})}),u}},{key:"getSourceDataAtCell",value:function(e,r){return this.hot.getSourceDataAtCell(e,r)}},{key:"getSourceDataByRange",value:function(e,r,t,n){return this.hot.getSourceDataArray(e,r,t,n)}},{key:"updateSourceData",value:function(e,r,t){this.hot.getSourceData()[e][this.hot.colToProp(r)]=t}},{key:"destroy",value:function(){this.hot=null,this.changes=null}}],[{key:"_coordId",value:function(e,r){return e+":"+r}}]),i}());exports.DataProvider=i},{"./utils":53}],29:[function(require,module,exports){"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Matrix=void 0;var r=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),t=require("./CellValue"),n=Handsontable.helper.arrayEach,i=Handsontable.helper.arrayFilter,a=Handsontable.helper.arrayReduce,o=function(){function o(){e(this,o),this.data=[],this.cellReferences=[]}return r(o,[{key:"getCellAt",value:function(e,r){var t=null;return n(this.data,function(n){if(n.row===e&&n.column===r)return t=n,!1}),t}},{key:"getOutOfDateCells",value:function(){return i(this.data,function(e){return e.isState(t.CellValue.STATE_OUT_OFF_DATE)})}},{key:"add",value:function(e){i(this.data,function(r){return r.isEqual(e)}).length||this.data.push(e)}},{key:"remove",value:function(e){var r=Array.isArray(e),t=function(e,t){var i=!1;return r?n(t,function(r){if(e.isEqual(r))return i=!0,!1}):i=e.isEqual(t),i};this.data=i(this.data,function(r){return!t(r,e)})}},{key:"getDependencies",value:function e(r){var t=this,e=function(e){return a(t.data,function(r,t){return t.hasPrecedent(e)&&r.indexOf(t)===-1&&r.push(t),r},[])},i=function r(t){var i=e(t);return i.length&&n(i,function(e){e.hasPrecedents()&&(i=i.concat(r(e)))}),i};return i(r)}},{key:"registerCellRef",value:function(e){i(this.cellReferences,function(r){return r.isEqual(e)}).length||this.cellReferences.push(e)}},{key:"removeCellRefsAtRange",value:function(e,r){var t=e.row,n=e.column,a=r.row,o=r.column,u=[],s=function(e){return void 0===t||e.row>=t&&e.row<=a},l=function(e){return void 0===n||e.column>=n&&e.column<=o};return this.cellReferences=i(this.cellReferences,function(e){return!s(e)||!l(e)||(u.push(e),!1)}),u}},{key:"reset",value:function(){this.data.length=0,this.cellReferences.length=0}}]),o}();exports.Matrix=o},{"./CellValue":27}],30:[function(require,module,exports){"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sheet=void 0;var r=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),t=require("./CellValue"),n=require("./CellReference"),i=require("./utils"),a=require("./Matrix"),o=require("./AlterManager"),u=require("./parser/parser"),s=require("./parser/error"),l=1,c=2,f=3,h=Handsontable.helper.arrayEach,p=(Handsontable.helper.arrayMap,Handsontable.helper.rangeEach),m=(Handsontable.helper.objectEach,Handsontable.helper.mixin),d=Handsontable.utils.localHooks,v=function(){function m(r){var t=this;e(this,m),this.dataProvider=r,this.parser=new u.Parser,this.matrix=new a.Matrix,this.alterManager=new o.AlterManager(this),this._processingCell=null,this._state=f,this.parser.on("callCellValue",function(){return t._onCallCellValue.apply(t,arguments)}),this.parser.on("callRangeValue",function(){return t._onCallRangeValue.apply(t,arguments)}),this.parser.on("callCellValueInSheet",function(){return t._onCallCellValueInSheet.apply(t,arguments)}),this.parser.on("callRangeValueInSheet",function(){return t._onCallRangeValueInSheet.apply(t,arguments)}),this.alterManager.addLocalHook("afterAlter",function(){return t._onAfterAlter.apply(t,arguments)})}return r(m,[{key:"recalculate",value:function(){switch(this._state){case f:this.recalculateFull();break;case c:this.recalculateOptimized()}}},{key:"recalculateOptimized",value:function(){var e=this,r=this.matrix.getOutOfDateCells();h(r,function(r){var t=e.dataProvider.getSourceDataAtCell(r.row,r.column);(0,i.isFormulaExpression)(t)&&e.parseExpression(r,t.substr(1))}),this._state=l,this.runLocalHooks("afterRecalculate",r,"optimized")}},{key:"recalculateFull",value:function(){var e=this,r=this.dataProvider.getSourceDataByRange();this.matrix.reset(),h(r,function(r,n){h(r,function(r,a){(0,i.isFormulaExpression)(r)&&e.parseExpression(new t.CellValue(n,a),r.substr(1))})}),this._state=l,this.runLocalHooks("afterRecalculate",r,"full")}},{key:"setVariable",value:function(e,r){this.parser.setVariable(e,r)}},{key:"getVariable",value:function(e){return this.parser.getVariable(e)}},{key:"applyChanges",value:function(e,r,n){this.matrix.remove({row:e,column:r}),(0,i.isFormulaExpression)(n)&&this.parseExpression(new t.CellValue(e,r),n.substr(1));var a=this.getCellDependencies(e,r);h(a,function(e){e.setState(t.CellValue.STATE_OUT_OFF_DATE)}),this._state=c}},{key:"parseExpression",value:function(e,r){e.setState(t.CellValue.STATE_COMPUTING),this._processingCell=e;var n=this.parser.parse((0,i.toUpperCaseFormula)(r)),a=n.error,o=n.result;e.setValue(o),e.setError(a),e.setState(t.CellValue.STATE_UP_TO_DATE),this.matrix.add(e),this._processingCell=null}},{key:"getCellAt",value:function(e,r){return this.matrix.getCellAt(e,r)}},{key:"getCellDependencies",value:function(e,r){return this.matrix.getDependencies({row:e,column:r})}},{key:"_onCallCellValue",value:function(e,r){var t=e.row,i=e.column,a=new n.CellReference(t,i);if(!this.dataProvider.isInDataRange(a.row,a.column))throw Error(s.ERROR_REF);this.matrix.registerCellRef(a),this._processingCell.addPrecedent(a),r(this.dataProvider.getDataAtCell(a.row,a.column))}},{key:"_onCallCellValueInSheet",value:function(e,r){var t=e.sheetName,i=e.row,a=e.column,o=new n.CellReference(i,a);r(this.dataProvider.getDataAtCellInSheet(t,o.row,o.column))}},{key:"_onCallRangeValue",value:function(e,r,t){var i=e.row,a=e.column,o=this,u=r.row,s=r.column;p(i.index,u.index,function(e){p(a.index,s.index,function(r){var t=new n.CellReference(e,r);o.matrix.registerCellRef(t),o._processingCell.addPrecedent(t)})}),t(this.dataProvider.getDataByRange(i.index,a.index,u.index,s.index))}},{key:"_onCallRangeValueInSheet",value:function(e,r,t,n){r.row,r.column,t.row,t.column;n("_onCallRangeValueInSheet")}},{key:"_onAfterAlter",value:function(){this.recalculateOptimized()}},{key:"destroy",value:function(){this.dataProvider.destroy(),this.dataProvider=null,this.alterManager.destroy(),this.alterManager=null,this.parser=null,this.matrix.reset(),this.matrix=null}}]),m}();m(v,d),exports.Sheet=v},{"./AlterManager":24,"./CellReference":26,"./CellValue":27,"./Matrix":29,"./parser/error":34,"./parser/parser":50,"./utils":53}],31:[function(require,module,exports){"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.UndoRedoSnapshot=void 0;var r=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),t=require("./CellValue"),n=require("../../utils/dataStructure"),i=Handsontable.helper.arrayEach,a=(Handsontable.helper.rangeEach,function(){function a(r){e(this,a),this.sheet=r,this.stack=new n.Stack}return r(a,[{key:"save",value:function(e,r,t){var n=this.sheet,a=n.matrix,o=n.dataProvider,u=[];i(a.data,function(n){var i=n.row,a=n.column;if(n[e]<r||n[e]>r+(t-1)){var s=o.getSourceDataAtCell(i,a);u.push({row:i,column:a,value:s})}}),this.stack.push({axis:e,index:r,amount:t,changes:u})}},{key:"restore",value:function(){var e=this.sheet,r=e.matrix,n=e.dataProvider,a=this.stack.pop(),o=a.axis,u=a.index,s=a.amount,l=a.changes;l&&i(l,function(e){e[o]>u+(s-1)&&(e[o]-=s);var i=e.row,a=e.column,l=e.value,c=n.getSourceDataAtCell(i,a);c!==l&&(n.updateSourceData(i,a,l),r.getCellAt(i,a).setState(t.CellValue.STATE_OUT_OFF_DATE))})}},{key:"destroy",value:function(){this.sheet=null,this.stack=null}}]),a}());exports.UndoRedoSnapshot=a},{"../../utils/dataStructure":58,"./CellValue":27}],32:[function(require,module,exports){"use strict";function e(e){Handsontable.plugins.BasePlugin.call(this,e),this._superClass=Handsontable.plugins.BasePlugin,this.eventManager=Handsontable.eventManager(),this.dataProvider=new i.DataProvider(this.hot),this.sheet=new n.Sheet(this.dataProvider),this.undoRedoSnapshot=new a.UndoRedoSnapshot(this.sheet),this._skipRendering=!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.XFormulas=void 0;var r=function(){function e(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),t=require("./utils"),n=require("./Sheet"),i=require("./DataProvider"),a=require("./UndoRedoSnapshot"),o=Handsontable.helper.arrayEach,u=Handsontable.helper.isObject,s=Handsontable.helper.objectEach;e.prototype=Object.create(Handsontable.plugins.BasePlugin.prototype,{constructor:{writable:!0,configurable:!0,value:e}}),e.prototype.isEnabled=function(){return!!this.hot.getSettings().xFormulas},e.prototype.enablePlugin=function(){var e=this;if(!this.enabled){var r=this.hot.getSettings();if(!r._isHotTableAdaptor)throw"XFormulas ";var t=r.formulas;u(t)&&u(t.variables)&&s(t.variables,function(r,t){return e.setVariable(t,r)});var n=this.dataProvider.worksheet=this.hot.getSettings()._sheet;this.dataProvider.workbook=n.workbook,this.addHook("afterCreateCol",function(){return e.onAfterCreateCol.apply(e,arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow.apply(e,arguments)}),this.addHook("afterLoadData",function(){return e.onAfterLoadData()}),this.addHook("afterRemoveCol",function(){return e.onAfterRemoveCol.apply(e,arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow.apply(e,arguments)}),this.addHook("afterSetDataAtCell",function(){return e.onAfterSetDataAtCell.apply(e,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return e.onAfterSetDataAtCell.apply(e,arguments)}),this.addHook("beforeCreateCol",function(){return e.onBeforeCreateCol.apply(e,arguments)}),this.addHook("beforeCreateRow",function(){return e.onBeforeCreateRow.apply(e,arguments)}),this.addHook("beforeRemoveCol",function(){return e.onBeforeRemoveCol.apply(e,arguments)}),this.addHook("beforeRemoveRow",function(){return e.onBeforeRemoveRow.apply(e,arguments)}),this.addHook("beforeValidate",function(){return e.onBeforeValidate.apply(e,arguments)}),this.addHook("beforeValueRender",function(){return e.onBeforeValueRender.apply(e,arguments)}),this.addHook("modifyData",function(){return e.onModifyData.apply(e,arguments)}),this.sheet.addLocalHook("afterRecalculate",function(){return e.onSheetAfterRecalculate.apply(e,arguments)}),this._superClass.prototype.enablePlugin.call(this)}},e.prototype.disablePlugin=function(){this._superClass.prototype.disablePlugin.call(this)},e.prototype.updatePlugin=function(){this.disablePlugin(),this.enablePlugin(),this._superClass.prototype.updatePlugin.call(this)},e.prototype.destroy=function(){this.dataProvider.destroy(),this.dataProvider=null,this.sheet.destroy(),this.sheet=null,this._superClass.prototype.destroy.call(this)},e.prototype.onSheetRename=function(e,r,t){},e.prototype.onSheetAfterRecalculate=function(e){if(this._skipRendering)return void(this._skipRendering=!1);var r=this.hot;o(e,function(e){var t=e.row,n=e.column;r.validateCell(r.getDataAtCell(t,n),r.getCellMeta(t,n),function(){})}),r.render()},e.prototype.onModifyData=function(e,r,n,i){"get"===i&&this.hasComputedCellValue(e,r)?n.value=this.getCellValue(e,r):"set"===i&&(0,t.isFormulaExpression)(n.value)&&(n.value=(0,t.toUpperCaseFormula)(n.value))},e.prototype.onBeforeValueRender=function(e){return(0,t.isFormulaExpressionEscaped)(e)&&(e=(0,t.unescapeFormulaExpression)(e)),e},e.prototype.onBeforeValidate=function(e,r,t){var n=this.hot.propToCol(t);return this.hasComputedCellValue(r,n)&&(e=this.getCellValue(r,n)),e},e.prototype.onAfterSetDataAtCell=function(e,n){var i=this;"loadData"!==n&&(this.dataProvider.clearChanges(),o(e,function(e){var n=r(e,4),a=n[0],o=n[1],u=n[2],s=n[3];o=i.hot.propToCol(o),(0,t.isFormulaExpression)(s)&&(s=(0,t.toUpperCaseFormula)(s)),i.dataProvider.collectChanges(a,o,s),u!==s&&i.sheet.applyChanges(a,o,s)}),this.recalculate())},e.prototype.onBeforeCreateRow=function(e,r,t){"undo"===t&&this.undoRedoSnapshot.restore()},e.prototype.onAfterCreateRow=function(e,r,t){this.sheet.alterManager.insertRow(e,r,"undo"!==t)},e.prototype.onBeforeRemoveRow=function(e,r){Storage.save("row",e,r)},e.prototype.onAfterRemoveRow=function(e,r){this.sheet.alterManager.removeRow(e,r)},e.prototype.onBeforeCreateCol=function(e,r,t){"undo"===t&&this.undoRedoSnapshot.restore()},e.prototype.onAfterCreateCol=function(e,r,t){this.sheet.alterManager.insertColumn(e,r,"undo"!==t)},e.prototype.onBeforeRemoveCol=function(e,r){Storage.save("column",e,r)},e.prototype.onAfterRemoveCol=function(e,r){this.sheet.alterManager.removeColumn(e,r)},e.prototype.onAfterLoadData=function(){this._skipRendering=!0,this.recalculateFull()},e.prototype.getCellValue=function(e,r){var t=this.sheet.getCellAt(e,r);return t?t.getError()||t.getValue():void 0},e.prototype.hasComputedCellValue=function(e,r){return!!this.sheet.getCellAt(e,r)},e.prototype.recalculate=function(){this.sheet.recalculate()},e.prototype.recalculateFull=function(){this.sheet.recalculateFull()},e.prototype.recalculateOptimized=function(){this.sheet.recalculateOptimized()},e.prototype.setVariable=function(e,r){this.sheet.setVariable(e,r)},e.prototype.getVariable=function(e){return this.sheet.getVariable(e)},Handsontable.plugins.registerPlugin("xFormulas",e),exports.XFormulas=e},{"./DataProvider":28,"./Sheet":30,"./UndoRedoSnapshot":31,"./utils":53}],33:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExpressionModifier=void 0;var t=function(){function e(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),i=require("./utils"),a=require("./parser/utils"),o=require("./parser/error"),u=e(o),s=Handsontable.helper.arrayEach,l=Handsontable.helper.arrayFilter,c=Handsontable.helper.startsWith,f=Handsontable.helper.mixin,h=Handsontable.utils.localHooks,p=/^\$?[A-Z]+\$?\d+$/,m=/\$?[A-Z]+\$?\d+/,d=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,v=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,g=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,y=function(){function e(t){r(this,e),this.expression="",this.cells=[],"string"==typeof t&&this.setExpression(t)}return n(e,[{key:"setExpression",value:function(e){return this.cells.length=0,this.expression=(0,i.toUpperCaseFormula)(e),this._extractCells(),this._extractCellsRange(),this}},{key:"translate",value:function(r,t){var n=r.row,i=r.column,a=t.row,o=t.column;return s(this.cells,function(r){null!=a&&e._translateCell(r,"row",n,a),null!=o&&e._translateCell(r,"column",i,o)}),this}},{key:"toString",value:function(){var e=this,r=this.expression.replace(g,function(r,t,n){var i=r.indexOf(":")===-1,a=r,s=r,l=null;i&&(s=p.test(t)?t:n);var c=e._searchCell(s);return c&&(l=c.refError?(0,u.default)(o.ERROR_REF):c.toLabel(),a=i?r.replace(s,l):l),a});return c(r,"=")||(r="="+r),r}},{key:"_extractCells",value:function(){var e=this,r=this.expression.match(d);r&&s(r,function(r){if(r=r.match(m)){var n=(0,a.extractLabel)(r[0]),i=t(n,2),o=i[0],u=i[1];e.cells.push(e._createCell({row:o,column:u},{row:o,column:u},r[0]))}})}},{key:"_extractCellsRange",value:function(){var e=this,r=this.expression.match(v);r&&s(r,function(r){var n=r.split(":"),i=t(n,2),o=i[0],u=i[1],s=(0,a.extractLabel)(o),l=t(s,2),c=l[0],f=l[1],h=(0,a.extractLabel)(u),p=t(h,2),m=p[0],d=p[1],v={row:c,column:f},g={row:m,column:d};e.cells.push(e._createCell(v,g,r))})}},{key:"_searchCell",value:function(e){var r=l(this.cells,function(r){return r.origLabel===e}),n=t(r,1),i=n[0];return i||null}},{key:"_createCell",value:function(e,r,t){return{start:e,end:r,origLabel:t,type:t.indexOf(":")===-1?"cell":"range",refError:!1,toLabel:function(){var e=(0,a.toLabel)(this.start.row,this.start.column);return"range"===this.type&&(e+=":"+(0,a.toLabel)(this.end.row,this.end.column)),e}}}}],[{key:"_translateCell",value:function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e.type,a=e.start,o=e.end,u=a[r].index,s=o[r].index,l=n,c=n,f=!1,h=Math.abs(n)-1;n>0?(t>u&&(l=0),t>s&&(c=0)):(u>=t&&s<=t+h&&(f=!0),f||"cell"!==i||t>=u&&(l=0,c=0),f||"range"!==i||(t>=u&&(l=0),t>s?c=0:s<=t+h&&(c-=Math.min(s-(t+h),0)))),l&&!f&&(a[r].index=Math.max(u+l,0)),c&&!f&&(o[r].index=Math.max(s+c,0)),f&&(e.refError=!0)}}]),e}();f(y,h),exports.ExpressionModifier=y},{"./parser/error":34,"./parser/utils":52,"./utils":53}],34:[function(require,module,exports){"use strict";function e(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function r(e){var r=void 0;return e=(e+"").replace(/#|!|\?/g,""),h[e]&&(r=h[e]),r?r:null}Object.defineProperty(exports,"__esModule",{value:!0});var t;exports.default=r;var n=exports.ERROR="ERROR",i=exports.ERROR_DIV_ZERO="DIV/0",a=exports.ERROR_NAME="NAME",o=exports.ERROR_NEED_UPDATE="NEED_UPDATE",u=exports.ERROR_NOT_AVAILABLE="N/A",s=exports.ERROR_NULL="NULL",l=exports.ERROR_NUM="NUM",c=exports.ERROR_REF="REF",f=exports.ERROR_VALUE="VALUE",h=(t={},e(t,n,"#ERROR!"),e(t,i,"#DIV/0!"),e(t,a,"#NAME?"),e(t,o,"#NEED_UPDATE!"),e(t,u,"#N/A"),e(t,s,"#NULL!"),e(t,l,"#NUM!"),e(t,c,"#REF!"),e(t,f,"#VALUE!"),t)},{}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var grammar=function(){function Parser(){this.yy={}}var o=function(e,r,t,n){for(t=t||{},n=e.length;n--;t[e[n]]=r);return t},$V0=[1,5],$V1=[1,8],$V2=[1,6],$V3=[1,7],$V4=[1,9],$V5=[1,15],$V6=[1,16],$V7=[1,17],$V8=[1,18],$V9=[1,13],$Va=[1,14],$Vb=[1,19],$Vc=[1,21],$Vd=[1,22],$Ve=[1,23],$Vf=[1,24],$Vg=[1,25],$Vh=[1,26],$Vi=[1,27],$Vj=[1,28],$Vk=[1,29],$Vl=[1,30],$Vm=[5,9,10,11,13,14,15,16,17,18,19,20,32,33],$Vn=[5,9,10,11,13,14,15,16,17,18,19,20,32,33,35],$Vo=[1,39],$Vp=[5,9,10,11,13,14,15,16,17,18,19,20,32,33,37],$Vq=[5,10,11,13,14,15,16,17,32,33],$Vr=[5,10,13,14,15,16,32,33],$Vs=[5,10,11,13,14,15,16,17,18,19,32,33],$Vt=[13,32,33],$Vu=[5,9,10,11,13,14,15,16,17,18,19,20,32,33,34,38],parser={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,sheet:23,cell:24,SHEET_NAME:25,"!":26,ABSOLUTE_CELL:27,RELATIVE_CELL:28,MIXED_CELL:29,":":30,ARRAY:31,";":32,",":33,VARIABLE:34,DECIMAL:35,NUMBER:36,"%":37,"#":38,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",25:"SHEET_NAME",26:"!",27:"ABSOLUTE_CELL",28:"RELATIVE_CELL",29:"MIXED_CELL",30:":",31:"ARRAY",32:";",33:",",34:"VARIABLE",35:"DECIMAL",36:"NUMBER",37:"%",38:"#"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,1],[4,2],[23,3],[23,3],[23,3],[23,5],[23,5],[23,5],[23,5],[23,5],[23,5],[23,5],[23,5],[23,5],[24,1],[24,1],[24,1],[24,3],[24,3],[24,3],[24,3],[24,3],[24,3],[24,3],[24,3],[24,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,3],[2,4]],
performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];case 2:this.$=yy.callVariable($$[$0][0]);break;case 3:this.$=yy.toNumber($$[$0]);break;case 4:this.$=yy.trimEdges($$[$0]);break;case 5:this.$=yy.evaluateByOperator("&",[$$[$0-2],$$[$0]]);break;case 6:this.$=yy.evaluateByOperator("=",[$$[$0-2],$$[$0]]);break;case 7:this.$=yy.evaluateByOperator("+",[$$[$0-2],$$[$0]]);break;case 8:this.$=yy.toNumber($$[$0-1]);break;case 9:this.$=yy.evaluateByOperator("<=",[$$[$0-3],$$[$0]]);break;case 10:this.$=yy.evaluateByOperator(">=",[$$[$0-3],$$[$0]]);break;case 11:this.$=yy.evaluateByOperator("<>",[$$[$0-3],$$[$0]]);break;case 12:this.$=yy.evaluateByOperator("NOT",[$$[$0-2],$$[$0]]);break;case 13:this.$=yy.evaluateByOperator(">",[$$[$0-2],$$[$0]]);break;case 14:this.$=yy.evaluateByOperator("<",[$$[$0-2],$$[$0]]);break;case 15:this.$=yy.evaluateByOperator("-",[$$[$0-2],$$[$0]]);break;case 16:this.$=yy.evaluateByOperator("*",[$$[$0-2],$$[$0]]);break;case 17:this.$=yy.evaluateByOperator("/",[$$[$0-2],$$[$0]]);break;case 18:this.$=yy.evaluateByOperator("^",[$$[$0-2],$$[$0]]);break;case 19:var n1=yy.invertNumber($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 20:var n1=yy.toNumber($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 21:this.$=yy.callFunction($$[$0-2]);break;case 22:this.$=yy.callFunction($$[$0-3],$$[$0-1]);break;case 27:case 28:case 29:this.$=yy.cellValueInSheet($$[$0-2],$$[$0]);break;case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:this.$=yy.rangeValueInSheet($$[$0-4],$$[$0-2],$$[$0]);break;case 39:case 40:case 41:this.$=yy.cellValue($$[$0]);break;case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:this.$=yy.rangeValue($$[$0-2],$$[$0]);break;case 51:case 55:this.$=[$$[$0]];break;case 52:var result=[],arr=eval("["+yytext+"]");arr.forEach(function(e){result.push(e)}),this.$=result;break;case 53:case 54:$$[$0-2].push($$[$0]),this.$=$$[$0-2];break;case 56:this.$=Array.isArray($$[$0-2])?$$[$0-2]:[$$[$0-2]],this.$.push($$[$0]);break;case 57:this.$=$$[$0];break;case 58:this.$=1*($$[$0-2]+"."+$$[$0]);break;case 59:this.$=.01*$$[$0-1];break;case 60:case 61:this.$=yy.throwError($$[$0-2]+$$[$0-1]+$$[$0])}},table:[{2:12,3:1,4:2,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{1:[3]},{5:[1,20],9:$Vc,10:$Vd,11:$Ve,14:$Vf,15:$Vg,16:$Vh,17:$Vi,18:$Vj,19:$Vk,20:$Vl},o($Vm,[2,2],{35:[1,31]}),o($Vm,[2,3],{37:[1,32]}),o($Vm,[2,4]),{2:12,4:33,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:34,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:35,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{12:[1,36]},o($Vm,[2,23]),o($Vm,[2,24]),o($Vm,[2,25],{2:37,34:[1,38],38:$Vb}),o($Vn,[2,55],{38:$Vo}),o($Vp,[2,57],{35:[1,40]}),{26:[1,41]},o($Vm,[2,39],{30:[1,42]}),o($Vm,[2,40],{30:[1,43]}),o($Vm,[2,41],{30:[1,44]}),{34:[1,45]},{1:[2,1]},{2:12,4:46,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:47,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:48,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:51,6:3,7:4,8:$V0,10:[1,49],11:$V1,12:$V2,15:[1,50],17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:53,6:3,7:4,8:$V0,10:[1,52],11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:54,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:55,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:56,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:57,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:58,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{34:[1,59]},o($Vp,[2,59]),{9:$Vc,10:$Vd,11:$Ve,13:[1,60],14:$Vf,15:$Vg,16:$Vh,17:$Vi,18:$Vj,19:$Vk,20:$Vl},o($Vq,[2,19],{9:$Vc,18:$Vj,19:$Vk,20:$Vl}),o($Vq,[2,20],{9:$Vc,18:$Vj,19:$Vk,20:$Vl}),{2:12,4:63,6:3,7:4,8:$V0,11:$V1,12:$V2,13:[1,61],17:$V3,21:$V4,22:62,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,31:[1,64],34:$V9,36:$Va,38:$Vb},o($Vm,[2,26]),{38:$Vo},{34:[1,65]},{36:[1,66]},{27:[1,67],28:[1,68],29:[1,69]},{27:[1,70],28:[1,71],29:[1,72]},{27:[1,73],28:[1,74],29:[1,75]},{27:[1,76],28:[1,77],29:[1,78]},{26:[1,79]},o($Vm,[2,5]),o([5,10,13,32,33],[2,6],{9:$Vc,11:$Ve,14:$Vf,15:$Vg,16:$Vh,17:$Vi,18:$Vj,19:$Vk,20:$Vl}),o($Vq,[2,7],{9:$Vc,18:$Vj,19:$Vk,20:$Vl}),{2:12,4:80,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:81,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},o($Vr,[2,14],{9:$Vc,11:$Ve,17:$Vi,18:$Vj,19:$Vk,20:$Vl}),{2:12,4:82,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},o($Vr,[2,13],{9:$Vc,11:$Ve,17:$Vi,18:$Vj,19:$Vk,20:$Vl}),o([5,10,13,16,32,33],[2,12],{9:$Vc,11:$Ve,14:$Vf,15:$Vg,17:$Vi,18:$Vj,19:$Vk,20:$Vl}),o($Vq,[2,15],{9:$Vc,18:$Vj,19:$Vk,20:$Vl}),o($Vs,[2,16],{9:$Vc,20:$Vl}),o($Vs,[2,17],{9:$Vc,20:$Vl}),o([5,10,11,13,14,15,16,17,18,19,20,32,33],[2,18],{9:$Vc}),o($Vn,[2,56]),o($Vm,[2,8]),o($Vm,[2,21]),{13:[1,83],32:[1,84],33:[1,85]},o($Vt,[2,51],{9:$Vc,10:$Vd,11:$Ve,14:$Vf,15:$Vg,16:$Vh,17:$Vi,18:$Vj,19:$Vk,20:$Vl}),o($Vt,[2,52]),{26:[1,86]},o($Vp,[2,58]),o($Vm,[2,27],{30:[1,87]}),o($Vm,[2,28],{30:[1,88]}),o($Vm,[2,29],{30:[1,89]}),o($Vm,[2,42]),o($Vm,[2,43]),o($Vm,[2,44]),o($Vm,[2,45]),o($Vm,[2,46]),o($Vm,[2,47]),o($Vm,[2,48]),o($Vm,[2,49]),o($Vm,[2,50]),o($Vu,[2,60]),o($Vr,[2,9],{9:$Vc,11:$Ve,17:$Vi,18:$Vj,19:$Vk,20:$Vl}),o($Vr,[2,11],{9:$Vc,11:$Ve,17:$Vi,18:$Vj,19:$Vk,20:$Vl}),o($Vr,[2,10],{9:$Vc,11:$Ve,17:$Vi,18:$Vj,19:$Vk,20:$Vl}),o($Vm,[2,22]),{2:12,4:90,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},{2:12,4:91,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:11,25:$V5,27:$V6,28:$V7,29:$V8,34:$V9,36:$Va,38:$Vb},o($Vu,[2,61]),{27:[1,92],28:[1,93],29:[1,94]},{27:[1,95],28:[1,96],29:[1,97]},{27:[1,98],28:[1,99],29:[1,100]},o($Vt,[2,53],{9:$Vc,10:$Vd,11:$Ve,14:$Vf,15:$Vg,16:$Vh,17:$Vi,18:$Vj,19:$Vk,20:$Vl}),o($Vt,[2,54],{9:$Vc,10:$Vd,11:$Ve,14:$Vf,15:$Vg,16:$Vh,17:$Vi,18:$Vj,19:$Vk,20:$Vl}),o($Vm,[2,30]),o($Vm,[2,31]),o($Vm,[2,32]),o($Vm,[2,33]),o($Vm,[2,34]),o($Vm,[2,35]),o($Vm,[2,36]),o($Vm,[2,37]),o($Vm,[2,38])],defaultActions:{20:[2,1]},parseError:function(e,r){if(!r.recoverable){var t=function(e,r){this.message=e,this.hash=r};throw t.prototype=Error,new t(e,r)}this.trace(e)},parse:function(e){function r(e){n.length=n.length-2*e,i.length=i.length-e,a.length=a.length-e}var t=this,n=[0],i=[null],a=[],o=this.table,u="",s=0,l=0,c=0,f=2,h=1,p=a.slice.call(arguments,1),m=Object.create(this.lexer),d={yy:{}};for(var v in this.yy)Object.prototype.hasOwnProperty.call(this.yy,v)&&(d.yy[v]=this.yy[v]);m.setInput(e,d.yy),d.yy.lexer=m,d.yy.parser=this,"undefined"==typeof m.yylloc&&(m.yylloc={});var g=m.yylloc;a.push(g);var y=m.options&&m.options.ranges;"function"==typeof d.yy.parseError?this.parseError=d.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var b,E,N,M,I,S,x,A,w,T=function(){var e;return e=m.lex()||h,"number"!=typeof e&&(e=t.symbols_[e]||e),e},O={};;){if(N=n[n.length-1],this.defaultActions[N]?M=this.defaultActions[N]:(null!==b&&"undefined"!=typeof b||(b=T()),M=o[N]&&o[N][b]),"undefined"==typeof M||!M.length||!M[0]){var R,_=function(e){for(var r=n.length-1,t=0;;){if(f.toString()in o[e])return t;if(0===e||r<2)return!1;r-=2,e=n[r],++t}},C="";if(c)E!==h&&(R=_(N));else{R=_(N),w=[];for(S in o[N])this.terminals_[S]&&S>f&&w.push("'"+this.terminals_[S]+"'");C=m.showPosition?"Parse error on line "+(s+1)+":\n"+m.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[b]||b)+"'":"Parse error on line "+(s+1)+": Unexpected "+(b==h?"end of input":"'"+(this.terminals_[b]||b)+"'"),this.parseError(C,{text:m.match,token:this.terminals_[b]||b,line:m.yylineno,loc:g,expected:w,recoverable:R!==!1})}if(3==c){if(b===h||E===h)throw new Error(C||"Parsing halted while starting to recover from another error.");l=m.yyleng,u=m.yytext,s=m.yylineno,g=m.yylloc,b=T()}if(R===!1)throw new Error(C||"Parsing halted. No suitable error recovery rule available.");r(R),E=b==f?null:b,b=f,N=n[n.length-1],M=o[N]&&o[N][f],c=3}if(M[0]instanceof Array&&M.length>1)throw new Error("Parse Error: multiple actions possible at state: "+N+", token: "+b);switch(M[0]){case 1:n.push(b),i.push(m.yytext),a.push(m.yylloc),n.push(M[1]),b=null,E?(b=E,E=null):(l=m.yyleng,u=m.yytext,s=m.yylineno,g=m.yylloc,c>0&&c--);break;case 2:if(x=this.productions_[M[1]][1],O.$=i[i.length-x],O._$={first_line:a[a.length-(x||1)].first_line,last_line:a[a.length-1].last_line,first_column:a[a.length-(x||1)].first_column,last_column:a[a.length-1].last_column},y&&(O._$.range=[a[a.length-(x||1)].range[0],a[a.length-1].range[1]]),I=this.performAction.apply(O,[u,l,s,d.yy,M[1],i,a].concat(p)),"undefined"!=typeof I)return I;x&&(n=n.slice(0,-1*x*2),i=i.slice(0,-1*x),a=a.slice(0,-1*x)),n.push(this.productions_[M[1]][0]),i.push(O.$),a.push(O._$),A=o[n[n.length-2]][n[n.length-1]],n.push(A);break;case 3:return!0}}return!0}},lexer=function(){var e={EOF:1,parseError:function(e,r){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,r)},setInput:function(e,r){return this.yy=r||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var r=e.match(/(?:\r\n?|\n).*/g);return r?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var r=e.length,t=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-r),this.offset-=r;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),t.length-1&&(this.yylineno-=t.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:t?(t.length===n.length?this.yylloc.first_column:0)+n[n.length-t.length].length-t[0].length:this.yylloc.first_column-r},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-r]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),r=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+r+"^"},test_match:function(e,r){var t,n,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),n=e[0].match(/(?:\r\n?|\n).*/g),n&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,r,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t)return t;if(this._backtrack){for(var a in i)this[a]=i[a];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,r,t,n;this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),a=0;a<i.length;a++)if(t=this._input.match(this.rules[i[a]]),t&&(!r||t[0].length>r[0].length)){if(r=t,n=a,this.options.backtrack_lexer){if(e=this.test_match(t,i[a]),e!==!1)return e;if(this._backtrack){r=!1;continue}return!1}if(!this.options.flex)break}return r?(e=this.test_match(r,i[n]),e!==!1&&e):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){var e=this.conditionStack.length-1;return e>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,r,t,n){switch(t){case 0:break;case 1:return 25;case 2:return 8;case 3:return 8;case 4:return 21;case 5:return 25;case 6:return 27;case 7:return 29;case 8:return 29;case 9:return 28;case 10:return 21;case 11:return 34;case 12:return 34;case 13:return 36;case 14:return 31;case 15:break;case 16:return 9;case 17:return" ";case 18:return 35;case 19:return 30;case 20:return 32;case 21:return 33;case 22:return 18;case 23:return 19;case 24:return 17;case 25:return 11;case 26:return 20;case 27:return 12;case 28:return 13;case 29:return 15;case 30:return 14;case 31:return 16;case 32:return'"';case 33:return"'";case 34:return"!";case 35:return 10;case 36:return 37;case 37:return 38;case 38:return 5}},rules:[/^(?:\s+)/,/^(?:'([^\\/\?\*\[\]\!'"]+)'(?=[!]))/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:[^\\/\?\*\[\]'"\!,\)]+(?=[!]))/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:\$)/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],inclusive:!0}}};return e}();return parser.lexer=lexer,Parser.prototype=parser,parser.Parser=Parser,new Parser}(),Parser=exports.Parser=grammar.Parser},{}],36:[function(require,module,exports){"use strict";function e(e){for(var n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];var o=i.reduce(function(e,t){return e+(0,r.toNumber)(t)},(0,r.toNumber)(e));if(Number.isNaN(o))throw Error(t.ERROR_VALUE);return o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SYMBOL=void 0,exports.default=e;var r=require("./../utils"),t=require("./../error"),n=exports.SYMBOL="+";e.SYMBOL=n},{"./../error":34,"./../utils":52}],37:[function(require,module,exports){"use strict";function e(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.reduce(function(e,r){return e+r.toString()},"")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;var r=exports.SYMBOL="&";e.SYMBOL=r},{}],38:[function(require,module,exports){"use strict";function e(e){for(var n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];var o=i.reduce(function(e,t){return e/(0,r.toNumber)(t)},(0,r.toNumber)(e));if(o===1/0)throw Error(t.ERROR_DIV_ZERO);if(Number.isNaN(o))throw Error(t.ERROR_VALUE);return o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SYMBOL=void 0,exports.default=e;var r=require("./../utils"),t=require("./../error"),n=exports.SYMBOL="/";e.SYMBOL=n},{"./../error":34,"./../utils":52}],39:[function(require,module,exports){"use strict";function e(e,r){return e===r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;var r=exports.SYMBOL="=";e.SYMBOL=r},{}],40:[function(require,module,exports){"use strict";function e(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function r(e){return e&&e.__esModule?e:{default:e}}function t(e){return function(){e=e.toUpperCase();var r=e.split("."),t=!1,n=void 0;if(1===r.length)u[r[0]]&&(t=!0,n=u[r[0]].apply(u,arguments));else{for(var i=r.length,o=0,s=u;o<i;)if(s=s[r[o]],o++,!s){s=null;break}s&&(t=!0,n=s.apply(void 0,arguments))}if(!t)throw Error(a.ERROR_NAME);return n}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SYMBOL=void 0,exports.default=t;var n=require("./../supported-formulas"),i=r(n),a=require("./../error"),o=require("formulajs"),u=e(o),s=exports.SYMBOL=i.default;t.isFactory=!0,t.SYMBOL=s},{"./../error":34,"./../supported-formulas":51,formulajs:1}],41:[function(require,module,exports){"use strict";function e(e,r){return e>=r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;var r=exports.SYMBOL=">=";e.SYMBOL=r},{}],42:[function(require,module,exports){"use strict";function e(e,r){return e>r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;var r=exports.SYMBOL=">";e.SYMBOL=r},{}],43:[function(require,module,exports){"use strict";function e(e,r){return e<=r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;var r=exports.SYMBOL="<=";e.SYMBOL=r},{}],44:[function(require,module,exports){"use strict";function e(e,r){return e<r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;var r=exports.SYMBOL="<";e.SYMBOL=r},{}],45:[function(require,module,exports){"use strict";function e(e){for(var n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];var o=i.reduce(function(e,t){return e-(0,r.toNumber)(t)},(0,r.toNumber)(e));if(isNaN(o))throw Error(t.ERROR_VALUE);return o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SYMBOL=void 0,exports.default=e;var r=require("./../utils"),t=require("./../error"),n=exports.SYMBOL="-";e.SYMBOL=n},{"./../error":34,"./../utils":52}],46:[function(require,module,exports){"use strict";function e(e){for(var n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];var o=i.reduce(function(e,t){return e*(0,r.toNumber)(t)},(0,r.toNumber)(e));if(isNaN(o))throw Error(t.ERROR_VALUE);return o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SYMBOL=void 0,exports.default=e;var r=require("./../utils"),t=require("./../error"),n=exports.SYMBOL="*";e.SYMBOL=n},{"./../error":34,"./../utils":52}],47:[function(require,module,exports){"use strict";function e(e,r){return e!==r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;var r=exports.SYMBOL="<>";e.SYMBOL=r},{}],48:[function(require,module,exports){"use strict";function e(e,n){var i=Math.pow((0,r.toNumber)(e),(0,r.toNumber)(n));if(Number.isNaN(i))throw Error(t.ERROR_VALUE);return i}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SYMBOL=void 0,exports.default=e;var r=require("./../utils"),t=require("./../error"),n=exports.SYMBOL="^";e.SYMBOL=n},{"./../error":34,"./../utils":52}],49:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}function t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e=e.toUpperCase(),!_[e])throw Error(R.ERROR_NAME);return _[e].apply(_,r(t))}function n(e,r){Array.isArray(e)||(e=[e.toUpperCase()]),e.forEach(function(e){r.isFactory?_[e]=r(e):_[e]=r})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t,exports.registerOperation=n;var i=require("./operator/add"),a=e(i),o=require("./operator/ampersand"),u=e(o),s=require("./operator/divide"),l=e(s),c=require("./operator/equal"),f=e(c),h=require("./operator/formula-function"),p=e(h),m=require("./operator/greater-than"),d=e(m),v=require("./operator/greater-than-or-equal"),g=e(v),y=require("./operator/less-than"),b=e(y),E=require("./operator/less-than-or-equal"),N=e(E),M=require("./operator/minus"),I=e(M),S=require("./operator/multiply"),x=e(S),A=require("./operator/not-equal"),w=e(A),T=require("./operator/power"),O=e(T),R=require("./error"),_=Object.create(null);n(a.default.SYMBOL,a.default),n(u.default.SYMBOL,u.default),n(l.default.SYMBOL,l.default),n(f.default.SYMBOL,f.default),n(O.default.SYMBOL,O.default),n(p.default.SYMBOL,p.default),n(d.default.SYMBOL,d.default),n(g.default.SYMBOL,g.default),n(b.default.SYMBOL,b.default),n(N.default.SYMBOL,N.default),n(x.default.SYMBOL,x.default),n(w.default.SYMBOL,w.default),n(I.default.SYMBOL,I.default)},{"./error":34,"./operator/add":36,"./operator/ampersand":37,"./operator/divide":38,"./operator/equal":39,"./operator/formula-function":40,"./operator/greater-than":42,"./operator/greater-than-or-equal":41,"./operator/less-than":44,"./operator/less-than-or-equal":43,"./operator/minus":45,"./operator/multiply":46,"./operator/not-equal":47,"./operator/power":48}],50:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function t(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function n(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Parser=exports.SUPPORTED_FORMULAS=void 0;var i=function(){function e(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),o=require("./supported-formulas");Object.defineProperty(exports,"SUPPORTED_FORMULAS",{enumerable:!0,get:function(){return e(o).default}});var u=require("../../../utils/Emitter"),s=e(u),l=require("./operators"),c=e(l),f=require("./grammar"),h=require("./utils"),p=require("./error"),m=e(p),d=function(e){function o(){r(this,o);var e=t(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.parser=new f.Parser,e.parser.yy={toNumber:h.toNumber,trimEdges:h.trimEdges,invertNumber:h.invertNumber,throwError:function(r){return e._throwError(r)},callVariable:function(r){return e._callVariable(r)},evaluateByOperator:c.default,callFunction:c.default,cellValue:function(r){return e._callCellValue(r)},rangeValue:function(r,t){return e._callRangeValue(r,t)},cellValueInSheet:function(r,t){return e._callCellValueInSheet(r,t)},rangeValueInSheet:function(r,t,n){return e._callRangeValueInSheet(r,t,n)},parseError:function(){return e._parseError.apply(e,arguments)}},e.variables=Object.create(null),e.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null),e}return n(o,e),a(o,[{key:"parse",value:function(e){var r=null,t=null;try{r=this.parser.parse(e)}catch(e){var n=(0,m.default)(e.message);t=n?n:(0,m.default)(p.ERROR)}return r instanceof Error&&(t=(0,m.default)(r.message)||(0,m.default)(p.ERROR),r=null),{error:t,result:r}}},{key:"setVariable",value:function(e,r){return this.variables[e]=r,this}},{key:"getVariable",value:function(e){return this.variables[e]}},{key:"_callVariable",value:function(e){var r=this.getVariable(e);if(this.emit("callVariable",e,function(e){void 0!==e&&(r=e)}),void 0===r)throw Error(p.ERROR_NAME);return r}},{key:"_callCellValue",value:function(e){var r=(0,h.extractLabel)(e),t=i(r,2),n=t[0],a=t[1],o=void 0;return this.emit("callCellValue",{label:e,row:n,column:a},function(e){o=e}),o}},{key:"_callCellValueInSheet",value:function(e,r){var t=(0,h.extractLabel)(r),n=i(t,2),a=n[0],o=n[1],u=void 0;return this.emit("callCellValueInSheet",{sheetName:e,label:r,row:a,column:o},function(e){u=e}),u}},{key:"_callRangeValue",value:function(e,r){var t=o._explainCell(e,r),n=t.startCell,i=t.endCell,a=[];return this.emit("callRangeValue",n,i,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];a=e}),a}},{key:"_callRangeValueInSheet",value:function(e,r,t){var n=o._explainCell(r,t),i=n.startCell,a=n.endCell,u=[];return this.emit("callRangeValueInSheet",e,i,a,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];u=e}),u}},{key:"_throwError",value:function(e){var r=(0,m.default)(e);if(r)throw Error(r);return e}},{key:"_parseError",value:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];console.log(r)}}],[{key:"_explainCell",value:function(e,r){var t=(0,h.extractLabel)(e),n=i(t,2),a=n[0],o=n[1],u=(0,h.extractLabel)(r),s=i(u,2),l=s[0],c=s[1],f={},p={};return a.index<=l.index?(f.row=a,p.row=l):(f.row=l,p.row=a),o.index<=c.index?(f.column=o,p.column=c):(f.column=c,p.column=o),f.label=(0,h.toLabel)(f.row,f.column),p.label=(0,h.toLabel)(p.row,p.column),{startCell:f,endCell:p}}}]),o}(s.default);exports.Parser=d},{"../../../utils/Emitter":56,"./error":34,"./grammar":35,"./operators":49,"./supported-formulas":51,"./utils":52}],51:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLAR","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FIXED","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","NUMERAL","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TEXT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VALUE","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"];exports.default=e},{}],52:[function(require,module,exports){"use strict";function e(e){if(!c.test(e))return[];var r=e.match(c),n=l(r,5),a=n[1],o=n[2],u=n[3],s=n[4];return[{index:i(s),label:s,isAbsolute:"$"===u},{index:t(o),label:o,isAbsolute:"$"===a}]}function r(e,r){var t=(e.isAbsolute?"$":"")+a(e.index),i=(r.isAbsolute?"$":"")+n(r.index);return i+t}function t(e){var r=0;if(e)for(var t=0,n=e.length-1;t<e.length;t+=1,n-=1)r+=Math.pow(h,n)*(f.indexOf(e[t])+1);return--r,r}function n(e){for(var r="";e>=0;)r=String.fromCharCode(e%h+97)+r,e=Math.floor(e/h)-1;return r.toUpperCase()}function i(e){var r=parseInt(e,10);
return r=Number.isNaN(r)?-1:Math.max(r-1,-1)}function a(e){return e>=0?""+(e+1):""}function o(e){var r=void 0;return"number"==typeof e?r=e:"string"==typeof e&&(r=e.indexOf(".")>-1?parseFloat(e):parseInt(e,10)),r}function u(e){return-1*o(e)}function s(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e=e.substring(r,e.length-r)}Object.defineProperty(exports,"__esModule",{value:!0});var l=function(){function e(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();exports.extractLabel=e,exports.toLabel=r,exports.columnLabelToIndex=t,exports.columnIndexToLabel=n,exports.rowLabelToIndex=i,exports.rowIndexToLabel=a,exports.toNumber=o,exports.invertNumber=u,exports.trimEdges=s;var c=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/,f="ABCDEFGHIJKLMNOPQRSTUVWXYZ",h=f.length},{}],53:[function(require,module,exports){"use strict";function e(e){return!(!e||"="!==(e+"").charAt(0))}function r(e){return!(!e||"'"!==(e+"").charAt(0)||"="!==(e+"").charAt(1))}function t(e){return r(e)?e.substr(1):e}function n(e){var r=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,t=e.match(r)||[],n=-1;return e.toUpperCase().replace(r,function(){return++n,t[n]})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isFormulaExpression=e,exports.isFormulaExpressionEscaped=r,exports.unescapeFormulaExpression=t,exports.toUpperCaseFormula=n},{}],54:[function(require,module,exports){"use strict";function e(e){e.Number.isNaN||(e.Number.isNaN=function(e){return e!==e}),"undefined"==typeof e.String.prototype.contains&&(e.String.prototype.contains=function(e){return!!~this.indexOf(e)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e},{}],55:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={idPrefix:"brick-ssd-",idSuffix4Workbook:"-workbook",sheet:{autoPrefix:"",sheetName:/[\\/\?\*:\[\]'"]/,animated:!1}},r={workbook:{activeSheet:"1",sheets:[{name:"1"}]},persistent:!0};exports.globalSettings=e,exports.defaultSettings=r},{}],56:[function(require,module,exports){"use strict";function e(){}Object.defineProperty(exports,"__esModule",{value:!0}),e.prototype={on:function(e,r,t){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:r,ctx:t}),this},once:function(e,r,t){function n(){i.off(e,n),r.apply(t,arguments)}var i=this;return n._=r,this.on(e,n,t)},emit:function(e){var r=[].slice.call(arguments,1),t=((this.e||(this.e={}))[e]||[]).slice(),n=0,i=t.length;for(n;n<i;n++)t[n].fn.apply(t[n].ctx,r);return this},off:function(e,r){var t=this.e||(this.e={}),n=t[e],i=[];if(n&&r)for(var a=0,o=n.length;a<o;a++)n[a].fn!==r&&n[a].fn._!==r&&i.push(n[a]);return i.length?t[e]=i:delete t[e],this},getGlobalEmitter:function(){var r=new e;return function(){return r}}()},exports.default=e;exports.GlobalEmitter=e.prototype.getGlobalEmitter()},{}],57:[function(require,module,exports){"use strict";function e(e,t){return r(t,function(r,t){e[t]=r}),e}function r(e,r){for(var t in e)if((!e.hasOwnProperty||e.hasOwnProperty&&e.hasOwnProperty(t))&&r(e[t],t,e)===!1)break;return e}function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?function(){}:u}function n(e){return e.toUpperCase()}function i(e){return e.replace(/^\S/g,function(e){return n(e)})}function a(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function o(e){return!(""!==e&&null!==e&&"undefined"!=typeof e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.extend=e,exports.objectEach=r,exports.emptyFunction=t,exports.upperCase=n,exports.upperCaseFirst=i,exports.randomString=a,exports.isEmptyValue=o;var u=function(){},s=function(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]},l=function(e,r){var t=Math.max(e[0],r[0]),n=Math.max(e[1],r[1]),i=Math.min(e[2],r[2]),a=Math.min(e[3],r[3]);return t<=i&&n<=a&&[t,n,i,a]},c=function(e){return function(r,t){var n=l(r,t);return!!n&&s(n,"sub"===e?r:t)}};exports.Coordinate={isEqual:s,intersection:l,isSubset:c("sub"),isSuperset:c("sup")}},{}],58:[function(require,module,exports){"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Stack=exports.CaseInsensitiveMap=void 0;var r=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),t=require("./common.js"),n=function(){function n(r){e(this,n),this._map=new Map(r),this._keys={}}return r(n,[{key:"get",value:function(e){var r=this._keys[(0,t.upperCase)(e)];return this._map.get(r)}},{key:"set",value:function(e,r){return this._keys[(0,t.upperCase)(e)]=e,this._map.set(e,r)}},{key:"has",value:function(e){return this._keys[(0,t.upperCase)(e)]}},{key:"hasExact",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){return this._keys={},this._map.clear()}},{key:"delete",value:function(e){var r=this._keys[(0,t.upperCase)(e)];return delete this._keys[(0,t.upperCase)(e)],this._map.delete(r)}},{key:"entries",value:function(){return this._map.entries()}},{key:"forEach",value:function(e,r){return this._map.forEach(e,r)}},{key:"keys",value:function(){return this._map.keys()}},{key:"values",value:function(){return this._map.values()}},{key:"toMap",value:function(){return this._map}},{key:"size",value:function(){return this._map.size}}]),n}(),i=function(){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e(this,t),this.items=r}return r(t,[{key:"push",value:function(){var e;(e=this.items).push.apply(e,arguments)}},{key:"pop",value:function(){return this.items.pop()}},{key:"peek",value:function(){return this.isEmpty()?void 0:this.items[this.items.length-1]}},{key:"isEmpty",value:function(){return!this.size()}},{key:"size",value:function(){return this.items.length}}]),t}();exports.CaseInsensitiveMap=n,exports.Stack=i},{"./common.js":57}],59:[function(require,module,exports){"use strict";function e(e,r){if(u.test(r))e.innerHTML=r;else{var t=e.firstChild;t&&3===t.nodeType&&null===t.nextSibling?o?t.textContent=r:t.data=r:(n(e),e.appendChild(document.createTextNode(r)))}}function r(e,r){u.test(r)?e.insertAdjacentHTML("afterend",r):1===r.nodeType&&(e.nextSibling?e.parentNode.insertBefore(r,e.nextSibling):e.parentNode.appendChild(r))}function t(e,r){var t;do if(e=e.parentNode,!e||!e.ownerDocument||(t=e.querySelector(r)))break;while(e);return t}function n(e){for(var r;r=e.lastChild;)try{e.removeChild(r)}catch(e){}}function i(e){var r,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.offsetHeight;return t===!1?n:(r=getComputedStyle(e),n+=parseInt(r.marginTop)+parseInt(r.marginBottom))}function a(e){var r,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.offsetWidth;return t===!1?n:(r=getComputedStyle(e),n+=parseInt(r.marginLeft)+parseInt(r.marginRight))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.innerHTML=e,exports.insertAfter=r,exports.closest=t,exports.empty=n,exports.outerHeight=i,exports.outerWidth=a;var o=!!document.createTextNode("test").textContent,u=(!!document.documentElement.classList,/(<(.*)>|&(.*);)/)},{}],60:[function(require,module,exports){"use strict";function e(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function r(e){"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.stopImmediatePropagation=e,exports.stopPropagation=r},{}]},{},[6]);